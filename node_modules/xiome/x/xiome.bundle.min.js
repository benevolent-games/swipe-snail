!function(){"use strict";var e,t;function i(e){const t=function(e){return{read(t){let i;const o=e.getItem(t);if(o)try{i=JSON.parse(o)}catch(i){e.removeItem(t)}return i},write(t,i){const o=JSON.stringify(i);e.setItem(t,o)},delete(t){e.removeItem(t)}}}(e);return{read:async e=>t.read(e),write:async(e,i)=>t.write(e,i),delete:async e=>t.delete(e)}}!function(e){var t;(t=e.Type||(e.Type={}))[t.Create=0]="Create",t[t.Update=1]="Update",t[t.Delete=2]="Delete"}(e||(e={})),"undefined"!=typeof process&&(null===(t=null===process||void 0===process?void 0:process.release)||void 0===t||t.name);class o extends Error{constructor(){super(...arguments),this.name=this.constructor.name}}class n extends o{constructor(e,t){super(t),this.code=e}}class r extends o{}const a=Symbol("is_service");function s(e){return null==e}function l(e){return async function(t){const i=t.method.slice(1).split("."),o=i.pop(),r=function(e,t){let i=e;for(const e of t)if(i=i[e],s(i))break;return i}(e,i);if(!r)throw new n(400,`renraku service not found "${i.join(".")}"`);const a=await r.policy(t.meta,t.headers),l=r.expose(a)[o];if(!l)throw new n(400,`renraku method "${o}" not found on service "${i}"`);return l(...t.params)}}function c(e,t,i={}){return function t(o,n=[]){return function(e,t){const i={};for(const[o,n]of Object.entries(e))i[o]=t(n,o);return i}(o,((o,r)=>{const a=[...n,r];if("function"==typeof o){const t=o,n={};return new Proxy({},{set:(e,t,i)=>(n[t]=i,!0),get:(o,s)=>{var l;return null!==(l=n[r])&&void 0!==l?l:async(...o)=>{const n=[...a,s].join("."),r="."+n,l=await t();return i.spike?i.spike(n,(async(...t)=>e({meta:l,method:r,params:t})),...o):e({meta:l,method:r,params:o})}}})}return t(o,a)}))}(t)}async function d({logger:e,exposeErrors:t,headers:i,request:o,servelet:r,respond:a}){var s;const{id:l,meta:c,method:d,params:p}=o;try{const t=function(){const e=Date.now();return()=>Date.now()-e}(),o=await r({meta:c,method:d,params:p,headers:i}),n=t();a({jsonrpc:"2.0",id:l,result:o}),e.log(`ðŸ”» ${d}() - ${n}ms`)}catch(i){i instanceof n||(i=new n(500,t?i.message:"hidden error")),a({jsonrpc:"2.0",id:l,error:{code:i.code,message:i.message}}),e.error(`ðŸš¨ ${null!==(s=i.code)&&void 0!==s?s:500}`,i.stack)}}function p({logger:e,timeout:t,exposeErrors:i}){const o=function({timeout:e}){let t=0;const i=new Map;return{startWaitingForResponse(){const o=t++;return{id:o,response:new Promise(((t,n)=>{i.set(o,{resolve:t,reject:n,timeoutId:setTimeout((()=>n(new r(`request (id ${o}) timed out`))),e)})}))}},resolvePendingResponse(e,t){const o=i.get(e);o&&(clearTimeout(o.timeoutId),o.resolve(t),i.delete(e))},rejectPendingResponse(e,t){const o=i.get(e);o&&(clearTimeout(o.timeoutId),o.reject(t),i.delete(e))}}}({timeout:t});return{startWaitingForResponse:o.startWaitingForResponse,async acceptIncoming({servelet:t,headers:r,incoming:a,respond:s}){!function(e){return!!e.method}(a)?async function({logger:e,response:t,waiter:i}){if(t.error){const{id:o,error:{code:r,message:a}}=t;-1===o?e.error(`ðŸš¨ ${null!=r?r:500} ${a}`):i.rejectPendingResponse(o,new n(r,a))}else{const{id:e,result:o}=t;i.resolvePendingResponse(e,o)}}({logger:e,waiter:o,response:a}):d({logger:e,headers:r,exposeErrors:i,request:a,respond:s,servelet:t})}}}async function u({link:e,timeout:t,metaMap:i,clientApi:o,handleConnectionClosed:n}){const r=l(o),a=await async function(e){return new Promise(((t,i)=>{const o=new WebSocket(e);o.onopen=()=>t(o),o.onerror=e=>i(e)}))}(e),{startWaitingForResponse:s,acceptIncoming:d}=p({timeout:t,exposeErrors:!0,logger:{log(){},warn(){},error(){}}});return a.onclose=()=>n(),a.onerror=e=>{console.error("socket error",e),a.close(),n()},a.onmessage=async e=>d({servelet:r,headers:void 0,incoming:JSON.parse(e.data.toString()),respond:e=>a.send(JSON.stringify(e))}),{remote:c((async({meta:e,method:t,params:i})=>{const{id:o,response:n}=s();return a.send(JSON.stringify({jsonrpc:"2.0",id:o,meta:e,method:t,params:i})),n}),i),close:()=>a.close()}}function h(){let e=[];return{publish:async(...t)=>{const i=e.map((e=>e(...t)));await Promise.all(i)},subscribe:t=>(e.push(t),()=>{e=e.filter((e=>e!==t))}),dispose:()=>{e=[]}}}const f="function"==typeof atob;const m=Object.freeze({encode:e=>{const t=function(e){return f?btoa(e):Buffer.from(e).toString("base64")}(e);return function(e){return e+Array((4-e.length%4)%4+1).join("=")}(t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},decode:e=>function(e){return f?atob(e):Buffer.from(e,"base64").toString("binary")}(e.replace(/-/g,"+").replace(/_/g,"/"))});const b=function(e){const[t,i]=e.split(".");return{header:v(t),data:v(i)}};function v(e){return JSON.parse(decodeURIComponent(m.decode(e).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")))}function g(e){return!!e&&!function({exp:e,iat:t}){const i=1e3*e,o=1e3*(e-t)/10,n=o>6e4?6e4:o;return Date.now()>i-n}(b(e).data)}const w=e=>b(e).data.payload;function y({appId:e,storage:t}){let i;async function o(){return{accessToken:await i.getValidAccessToken()}}return{metaMap:{auth:{apps:{appService:o,appEditService:o},permissions:{permissionsService:o},users:{greenService:async()=>{},loginService:o,personalService:o,userService:o}},example:{exampleService:o},administrative:{roleAssignmentService:o},questions:{questionsModerationService:o,questionsPostingService:o,questionsReadingService:o,questionsAnsweringService:o},videos:{dacastService:o,contentService:o},notes:{notesService:o},store:{billing:o,connect:o,subscriptions:{listing:o,planning:o,shopping:o}}},installAuthMediator:function({greenService:o}){return i=function({appId:e,storage:t,greenService:i}){const o=h(),n=h(),r=`auth-tokens-${e}`,a=async()=>{var e;return null!==(e=await t.read(r))&&void 0!==e?e:{accessToken:void 0,refreshToken:void 0}},s=async e=>t.write(r,e);async function l(e){const t=w(e.accessToken);return await s(e),await o.publish(),await n.publish(t),t}async function c(t){const o=await i.authorize({appId:e,refreshToken:t,scope:{core:!0}});return{access:await l({accessToken:o,refreshToken:t}),accessToken:o}}const d=async()=>{const{accessToken:e,refreshToken:t}=await a();return g(e)?{accessToken:e,access:w(e)}:g(t)?c(t):c(void 0)};return{subscribeToAccessChange:n.subscribe,subscribeToTokenChange:o.subscribe,async initialize(){const{access:e}=await d();return await n.publish(e),e},getValidAccess:async()=>(await d()).access,getValidAccessToken:async()=>(await d()).accessToken,login:async e=>l(e),logout:async()=>(await s({accessToken:void 0,refreshToken:void 0}),(await d()).access),async reauthorize(){const e=await a();return await s({...e,accessToken:void 0}),(await d()).access}}}({appId:e,storage:t,greenService:o}),i}}}function x({appId:e,apiLink:t,storage:i}){const{metaMap:o,installAuthMediator:r}=y({appId:e,storage:i}),a=function({url:e,metaMap:t}){let i=0;return c((async function({meta:t,method:o,params:r}){const a=await fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer",headers:{"Content-Type":"text/plain; charset=utf-8"},body:JSON.stringify({jsonrpc:"2.0",method:o,params:r,id:i++,meta:t})}).then((e=>e.json())),{error:s}=a,{result:l}=a;if(s)throw new n(s.code,`remote call error: ${s.code} ${s.message} (from "${e}")`);return l}),t)}({metaMap:o,url:t});return{remote:a,authMediator:r({greenService:a.auth.users.greenService})}}const $=["https://xiome.io","https://stage.xiome.io","http://localhost:8080","http://localhost:5000"];async function k({url:e,width:t=480,height:i=640,popupId:o,handleSecretMockCommand:n=(async()=>{})}){const r=window.open(e,"_blank",function(e,t){const{outerWidth:i,outerHeight:o,screenY:n,screenX:r}=window.top;return`\n\t\tpopup,\n\t\twidth=${e},\n\t\theight=${t},\n\t\ttop=${(o/2+n-t/2)/2},\n\t\tleft=${i/2+r-e/2},\n\t\ttoolbar=no,\n\t\tlocation=no,\n\t\tstatus=no,\n\t\tmenubar=no,\n\t\tscrollbars=yes,\n\t\tresizable=yes\n\t`}(t,i));return new Promise((e=>{function t(t){clearInterval(a),window.removeEventListener("message",i),e(t)}function i(e){var i;const a=function(e){return $.includes(e)}(e.origin),s=(null===(i=e.data)||void 0===i?void 0:i.popupId)===o,l=!0===e.data.secretMockCommand;if(a)if(l)n(e.data).then((()=>{r.postMessage({secretMockCommand:!0,commandId:e.data.commandId},"*")}));else if(s){const{popupId:i,...o}=e.data;t({popupId:i,details:o})}else console.warn(`ignoring message for other popup "${e.data.popupId}":`,e.data);else console.warn(`ignoring message from origin "${e.origin}":`,e.data)}window.addEventListener("message",i);const a=setInterval((()=>{r.closed&&t({popupId:o})}),100)}))}function O(){return function({mockStripeOperations:e}){return{connect:async({popupId:t,stripeAccountId:i,stripeAccountSetupLink:o})=>k({popupId:t,url:o,handleSecretMockCommand:e?async t=>{"complete"===t.type?await e.linkStripeAccount(i):"incomplete"===t.type&&await e.linkStripeAccountThatIsIncomplete(i)}:async()=>{}}),login:async({popupId:t,stripeAccountId:i,stripeLoginLink:o})=>k({popupId:t,url:o,handleSecretMockCommand:e?async t=>{"complete"===t.type?await e.linkStripeAccount(i):"incomplete"===t.type&&await e.linkStripeAccountThatIsIncomplete(i)}:async()=>{}}),checkoutSubscription:async({popupId:t,stripeSessionUrl:i,stripeSessionId:o,stripeAccountId:n})=>k({popupId:t,url:i,handleSecretMockCommand:e?async t=>{"success"===t.type&&await e.checkoutSubscriptionTier(n,o)}:async()=>{}}),openStoreCustomerPortal:async({popupId:t,customer:i,stripeAccountId:o,stripeSessionUrl:n})=>k({popupId:t,url:n,handleSecretMockCommand:e?async t=>{if("success"===t.type){const t=!1;await e.createNewDefaultPaymentMethod({customer:i,isFailing:t,stripeAccountId:o})}else if("failure"===t.type){const t=!0;await e.createNewDefaultPaymentMethod({customer:i,isFailing:t,stripeAccountId:o})}else"detach"===t.type&&await e.removeAllPaymentMethods(i)}:async()=>{}})}}({mockStripeOperations:void 0})}function S(e){return new URL(e)}async function A({appId:e,platformOrigin:t="https://xiome.io",apiServer:o=`${S(t).protocol}//api.${S(t).host}/`,chatServer:n=`${"https:"===S(t).protocol?"wss:":"ws:"}//chat.${S(t).host}/`}){const r=i(window.localStorage),{remote:a,authMediator:s}=x({appId:e,storage:r,apiLink:o});!function({appId:e,authMediator:t}){const i=new BroadcastChannel("tokenChangeEvent");t.subscribeToTokenChange((()=>i.postMessage({appId:e}))),i.onmessage=i=>{i.data.appId===e&&t.initialize()}}({appId:e,authMediator:s});const l=O(),c=(d=n,async function({clientsideApi:e,handleDisconnect:t}){const{remote:i,close:o}=await u({link:d,timeout:6e4,clientApi:e,metaMap:{chatServer:async()=>{}},handleConnectionClosed:t});return{serverside:i,disconnect:o}});var d;return{appId:e,remote:a,storage:r,authMediator:s,stripePopups:l,chatConnect:c}}function P(){const e=new Map;return{subscribe(...t){if(t.length){const i=Symbol();return e.set(i,t),()=>{e.delete(i)}}},async publish(...t){await Promise.all(Array.from(e.values()).flat().map((e=>e(...t))))},clear(){e.clear()}}}function C(e){let t;return async function(...i){if(t)return t;{t=e(...i);const o=await t;return t=void 0,o}}}var I;!function(e){var t=[];function i(i){var o=this,n="$BroadcastChannel$"+(i=String(i))+"$";t[n]=t[n]||[],t[n].push(this),this._name=i,this._id=n,this._closed=!1,this._mc=new MessageChannel,this._mc.port1.start(),this._mc.port2.start(),e.addEventListener("storage",(function(t){if(t.storageArea===e.localStorage&&null!=t.newValue&&""!==t.newValue&&t.key.substring(0,n.length)===n){var i=JSON.parse(t.newValue);o._mc.port2.postMessage(i)}}))}i.prototype={get name(){return this._name},postMessage:function(i){var o=this;if(this._closed){var n=new Error;throw n.name="InvalidStateError",n}var r=JSON.stringify(i),a=this._id+String(Date.now())+"$"+String(Math.random());e.localStorage.setItem(a,r),setTimeout((function(){e.localStorage.removeItem(a)}),500),t[this._id].forEach((function(e){e!==o&&e._mc.port2.postMessage(JSON.parse(r))}))},close:function(){if(!this._closed){this._closed=!0,this._mc.port1.close(),this._mc.port2.close();var e=t[this._id].indexOf(this);t[this._id].splice(e,1)}},get onmessage(){return this._mc.port1.onmessage},set onmessage(e){this._mc.port1.onmessage=e},addEventListener:function(){return this._mc.port1.addEventListener.apply(this._mc.port1,arguments)},removeEventListener:function(){return this._mc.port1.removeEventListener.apply(this._mc.port1,arguments)},dispatchEvent:function(){return this._mc.port1.dispatchEvent.apply(this._mc.port1,arguments)}},e.BroadcastChannel=e.BroadcastChannel||i}(self),function(e){var t;(t=e.Mode||(e.Mode={}))[t.None=0]="None",t[t.Loading=1]="Loading",t[t.Error=2]="Error",t[t.Ready=3]="Ready"}(I||(I={}));const M={none:()=>({mode:I.Mode.None}),loading:()=>({mode:I.Mode.Loading}),error:e=>({mode:I.Mode.Error,reason:e}),ready:e=>({mode:I.Mode.Ready,value:e}),replaceValue:(e,t)=>e.mode===I.Mode.Ready?{...e,value:t}:e,isNone:e=>e.mode===I.Mode.None,isLoading:e=>e.mode===I.Mode.Loading,isError:e=>e.mode===I.Mode.Error,isReady:e=>e.mode===I.Mode.Ready,value:e=>e.mode===I.Mode.Ready?e.value:void 0,select(e,t){switch(e.mode){case I.Mode.None:return t.none();case I.Mode.Loading:return t.loading();case I.Mode.Error:return t.error(e.reason);case I.Mode.Ready:return t.ready(e.value)}},async operation({promise:e,errorReason:t="an error occurred",setOp:i}){await i(M.loading());try{const t=await e;return await i(M.ready(t)),t}catch(e){throw await i(M.error(t)),e}},mode:e=>M.select(e,{none:()=>"none",loading:()=>"loading",error:()=>"error",ready:()=>"ready"}),combine(...e){const t=!!e.find((e=>e.mode===I.Mode.Error)),i=!!e.find((e=>e.mode===I.Mode.Loading)),o=!!e.find((e=>e.mode!==I.Mode.Ready));return t?{mode:I.Mode.Error,reason:"error"}:i?{mode:I.Mode.Loading}:o?{mode:I.Mode.None}:{mode:I.Mode.Ready,value:void 0}},debug:e=>M.select(e,{none:()=>["<op {mode: None}>"],loading:()=>["<op {mode: Loading}>"],error:e=>[`<op {mode: Error, reason: "${e}"}>`],ready:e=>["<op {mode: Ready, value: ",e,"}>"]})};function E(e){return null==e}function R(e,t){let i=e;for(const e of t)if(i=i[e],E(i))break;return i}function T(e,t){const i={};for(const[o,n]of Object.entries(e))i[o]=t(n,o);return i}function _(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}const j=Symbol("symbolToAllowProxyIntoState");function D(e,t=j){return _(e)&&!e[t]?T(e,(e=>D(e,t))):e}function q(e,t){let i,o,n=[];function r(){i=void 0,o&&clearTimeout(o),o=void 0,n=[]}return r(),(...a)=>{i=a,o&&clearTimeout(o);const s=new Promise(((e,t)=>{n.push({resolve:e,reject:t})}));return o=setTimeout((()=>{Promise.resolve().then((()=>t(...i))).then((e=>{for(const{resolve:t}of n)t(e);r()})).catch((e=>{for(const{reject:t}of n)t(e);r()}))}),e),s}}class U extends Error{constructor(){super(...arguments),this.name=this.constructor.name}}class N extends U{}class z extends U{}function L(e,t){for(const i of e){let e=!1;if(t.length===i.length){for(let o=0;o<t.length;o++)if(t[o]!==i[o]){e=!0;break}if(!e)return!0}}return!1}function B(e,t){for(const i of e){let e=!1;if(t.length<=i.length){for(let o=0;o<t.length;o++)if(t[o]!==i[o]){e=!0;break}if(!e)return!0}}return!1}function V(e,t){for(const i of e){let e=!1;if(t.length>=i.length){for(let o=0;o<i.length;o++)if(i[o]!==t[o]){e=!0;break}if(!e)return!0}}return!1}function W(e){const t=D(e,j);let i,o=!1;const n=new Map,r=new Set;function a(e){const t=[];for(const[,i]of n)i.flip?V(i.paths,e)&&t.push(i):B(i.paths,e)&&t.push(i);return t}const s=u(t,!0,[]),l=u(t,!1,[]);let c=[];const d=q(1,(()=>{for(const e of c){o=!0;try{for(const e of r)e(l);for(const{observer:t,reaction:i}of a(e))i?i(t(l)):t(l)}finally{o=!1}}c=[]}));let p=Promise.resolve();function u(e,n,r){return new Proxy(e,{get(e,o){var a;const s=[...r,o];i&&(L(i.paths,s)||i.paths.push(s));const l=null!==(a=R(t,s))&&void 0!==a?a:R(e,[o]);return _(l)?u(l,n,s):l},set(e,a,s){const l=[...r,a];if(n){if(i||o)throw new z("forbidden state circularity");return s!==R(t,l)&&(function(e,t,i){const o=[...t],n=o.pop();let r=e;for(const e of o){if("object"!=typeof r[e])throw new Error("unable to write property to object tree containing undefined");r=r[e]}r[n]=i}(t,l,D(s,j)),function(e){L(c,e)||c.push(e),p=d()}(l)),!0}throw new N(`state is read-only here, cannot set ${l.join(".")}`)}})}const h=new Set,f=new Set;return{state:s,writable:s,readable:l,readonly:l,subscribe(e){r.add(e);const t=()=>r.delete(e);return f.add(t),t},track(e,t,{flip:o=!1}={}){const r=Symbol();i={paths:[],flip:o,observer:e,reaction:t},n.set(r,i),e(l),i=void 0;const a=()=>n.delete(r);return h.add(a),a},unsubscribeAll(){for(const e of f)e();f.clear()},untrackAll(){for(const e of h)e();h.clear()},async wait(){await p}}}const H={"view all chats":"985dc13378d1129e4dd6303fe9e52dff97d53568ce10814805f481159c788710","participate in all chats":"bd0c8dfdf3eef893a5d9f8b5d0a6cad19ad80e949ebd70428f0d7525099cdd10"},F={"moderate all chats":"693d969777a3998de6f9a4a5583917f4e672bb96ed08c571fc7486593ca98993"},X={...H,...F};function Q(e,t){const i={};for(const o of Object.keys(e))i[o]=t;return i}function J(e,t){return Q(t,{active:e,immutable:!0})}const K={"control stripe account":"f236bd2175fbecf7925483884b8c2a2ffe0dd2f0a864cbd638046f6fc58944b5","manage store":"bea0ef0db58a0d8c9ab96bb9b14f889a19893064361b0877626b510b798c6fb8","give away freebies":"c2712efd490c67b44946bc6e1bbe82aee5b8ede384cff614ba7435d429993ec6"},Y={...K},Z={"view all videos":"22f380eb0c5c7463b8a16fcdfc2f5e58257d38f94972924e70d27a08fabb5506","moderate videos":"1b19013344a59cb49bfd9bddc8dd817a9e4cfa29003437021df24bdc832ec246"},G={...Z},ee={"read questions":"5b19b929648cbbe26c052a5016892b370f048eead1e6a303a50b7f5234ec5161","post questions":"aeaae6139d05f77193ca7c272a65977c70cb188f3070359866237a5ade84ba15","like questions":"5490898c541d733956b28664e7536673842e73b289fc45ab9caf143138c14a3e","report questions":"f2f89d433f398b267e320e0e3b9929eb3934af5c02f7e3fb2e032fd19399ad21",...H},te={"edit any profile":"4240ca0331e8679a444c6c4c6a803d8a12893f1554460af426064b980164c8ee","customize permissions":"f380d9b4d1001da8dc86a6e0b6a0721b92ed8060c52cd4ba433e76cbd9efe6b5","answer questions":"afaa00f7bc9ab09d3bbc61a26f6d9bc666cd9bb7ac270ebbdeba3cf4dd3ab9a9","moderate questions":"f6a3152a13f313a60f84d82ba8f7765afb19f70c04ef14688d802237a5d2ab5e","view stats":"092866ae6378833e43ec7001188aa1829d4cf2858e42da0ad3f44a2fedbcb07b","administrate user roles":"a072e9dd003a762e7d693658d8ac724be352b18da240843f691595c89020e350",...Z,...K,...F},ie={"edit any app":"e5fadb4b03badd6699b355ec43e1d150d6f4df81ecc291b5b742f06ebe62a0f8","view platform stats":"eec7d2ddc20df6080c4166a3dea0b2643b483ce61326cbefad95e45824810692"},oe={},ne=!0,re=!1,ae={privileges:{...ee,...te,universal:"c1cb5ac1000af6081ff47e80804de7542b57a1425c3faac8153e708aaf79271a",banned:"ffff9ebcbe8f69f3520ec574f5a1489a70bf04521d7a85fcbd25c54cc22802f1"},roles:{everybody:{roleId:"aaaa777dc7d7e9b5e9e0386abf0cf2f059cda4f71779cc910b85e8f504452b23",public:!0,assignable:!1,hasPrivileges:{...J(re,ee),...J(re,te),universal:{active:!0,immutable:!0},banned:{active:!1,immutable:!0},"read questions":{active:!0,immutable:!1},"view all chats":{active:!0,immutable:!1}}},authenticated:{roleId:"bbbb642d549d06113953a01fb52a8e010150edc502b929395bfb32d250d44b1c",public:!1,assignable:!1,hasPrivileges:{...function(e,t){return Q(t,{active:e,immutable:!1})}(ne,ee),...J(re,te),universal:{active:!1,immutable:!0},banned:{active:!1,immutable:!0}}},banned:{roleId:"dead633608412f8eefbb40f4678ef2bafaeb7883d09a6094dafe5f69dd6a8684",public:!0,assignable:!0,hasPrivileges:{...J(re,ee),...J(re,te),universal:{active:!1,immutable:!0},banned:{active:!0,immutable:!0}}},technician:{roleId:"9999d97119a83ea3853273a93e24ae0a1f2a994eccb21dacacab6ff860d8d869",public:!0,assignable:!1,hasPrivileges:{...J(ne,ee),...J(ne,te),universal:{active:!1,immutable:!0},banned:{active:!1,immutable:!0}}}}};ae.roles.everybody,ae.roles.everybody.hasPrivileges,J(re,ie),ae.roles.authenticated,ae.roles.authenticated.hasPrivileges,J(re,ie),ae.roles.banned,ae.roles.banned.hasPrivileges,J(re,ie),ae.roles.technician,ae.roles.technician.hasPrivileges,J(ne,ee),J(ne,ie);const se={privileges:{...ae.privileges,...oe},roles:{...ae.roles,everybody:{...ae.roles.everybody,hasPrivileges:{...ae.roles.everybody.hasPrivileges,...J(re,oe)}},authenticated:{...ae.roles.authenticated,hasPrivileges:{...ae.roles.authenticated.hasPrivileges,...J(re,oe)}},banned:{...ae.roles.banned,hasPrivileges:{...ae.roles.banned.hasPrivileges,...J(re,oe)}},admin:{roleId:"d21e66058b95b3b2e80c1a00c82abd56b8ec7a4b20f0424c2a00cc6ba352efeb",public:!0,assignable:!1,hasPrivileges:{...J(ne,oe),...J(ne,ee),...J(ne,te),universal:{active:!1,immutable:!0},banned:{active:!1,immutable:!0}}},technician:{...ae.roles.technician,hasPrivileges:{...ae.roles.technician.hasPrivileges,...J(ne,oe)}}}};var le;function ce({state:e,reconnect:t,disconnect:i}){async function o(){return M.isReady(e.readable.connectionOp)?M.value(e.readable.connectionOp):t()}const n=new Map,r=new Map;function a(t){let i=r.get(t);return i||(i=o().then((e=>e.serverside.chatServer.roomSubscribe(t).then((()=>e)))).then((i=>function({label:e,serverside:t,state:i}){const o=()=>i.readable.cache.rooms[e],n=()=>M.value(i.readable.accessOp);return{get posts(){var e,t;return null!==(t=null===(e=o())||void 0===e?void 0:e.posts)&&void 0!==t?t:[]},get status(){var e,t;return null!==(t=null===(e=o())||void 0===e?void 0:e.status)&&void 0!==t?t:le.Offline},get muted(){return i.readable.cache.mutedUserIds},get weAreMuted(){const{user:{userId:e}}=n();return i.readable.cache.mutedUserIds.includes(e)},get weAreBanned(){const{permit:{privileges:e}}=n();return e.includes(se.privileges.banned)},setRoomStatus(i){t.chatServer.setRoomStatus(e,i)},post(i){t.chatServer.post(e,i)},remove(i){t.chatServer.remove(e,i)},clear(){t.chatServer.clear(e)},mute(e){t.chatServer.mute([e])},unmute(e){t.chatServer.unmute([e])},unmuteAll(){t.chatServer.unmuteAll()}}}({label:t,state:e,serverside:i.serverside}))),r.set(t,i)),i}return{getRoomSession:async function(e){const t=function(e){let t=n.get(e);return t||(t=new Set,n.set(e,t)),t}(e),s=Symbol();return t.add(s),{dispose:function(){t.delete(s),0===t.size&&function(e){const t=r.get(e);o().then((i=>t.then((t=>{i.serverside.chatServer.roomUnsubscribe(e)})))).then((()=>{if(r.delete(e),0===r.size)return i()}))}(e)},room:await a(e)}},updateAuthSituation:async function(e){e?r.size>0&&await o():0===r.size&&await i()}}}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online"}(le||(le={}));function de({chatConnect:e,getChatMeta:t}){const i=P(),o=W({accessOp:M.none(),connectionOp:M.none(),cache:{mutedUserIds:[],roomStats:{},rooms:{}}}),n=(({state:e,onChange:t})=>({chatClient:(e=>({expose:t=>({[a]:a,expose:t,policy:e})}))((async()=>{})).expose((()=>{async function i(){await e.wait(),t()}return{async roomStatusChanged(t,o){e.writable.cache={...e.writable.cache,rooms:{...e.writable.cache.rooms,[t]:{...e.writable.cache.rooms[t],status:o}}},await i()},async postsAdded(t,o){var n,r;e.writable.cache={...e.writable.cache,rooms:{...e.writable.cache.rooms,[t]:{...e.writable.cache.rooms[t],posts:[...null!==(r=null===(n=e.writable.cache.rooms[t])||void 0===n?void 0:n.posts)&&void 0!==r?r:[],...o].slice(0,50)}}},await i()},async postsRemoved(t,o){var n,r;e.writable.cache={...e.writable.cache,rooms:{...e.writable.cache.rooms,[t]:{...e.writable.cache.rooms[t],posts:(null!==(r=null===(n=e.writable.cache.rooms[t])||void 0===n?void 0:n.posts)&&void 0!==r?r:[]).filter((e=>!o.includes(e.postId)))}}},await i()},async roomCleared(t){e.writable.cache={...e.writable.cache,rooms:{...e.writable.cache.rooms,[t]:{...e.writable.cache.rooms[t],posts:[]}}},await i()},async usersMuted(t){e.writable.cache={...e.writable.cache,mutedUserIds:[...e.writable.cache.mutedUserIds,...t]},await i()},async usersUnmuted(t){e.writable.cache={...e.writable.cache,mutedUserIds:e.writable.cache.mutedUserIds.filter((e=>!t.includes(e)))},await i()},async unmuteAll(){e.writable.cache={...e.writable.cache,mutedUserIds:[]},await i()}}}))}))({state:o,onChange:i.publish}),r=function({state:e,intervalDuration:t}){let i;function o(){clearInterval(i),i=void 0}return{startInterval(n){o(),i=setInterval((async()=>{const t=await n.serverside.chatServer.getStats();e.writable.cache.roomStats=t}),t)},stopInterval:o}}({state:o,intervalDuration:2e3}),s=C((async function(){var i;const a=null!==(i=M.value(o.readable.connectionOp))&&void 0!==i?i:await M.operation({setOp:e=>o.writable.connectionOp=e,promise:e({clientsideApi:n,handleDisconnect:()=>o.writable.connectionOp=M.none()})}),s=await t();return await a.serverside.chatServer.updateUserMeta(s),r.startInterval(a),a}));async function l(){r.stopInterval();const e=M.value(o.readable.connectionOp);e&&(e.disconnect(),o.writable.connectionOp=M.none())}const c=ce({state:o,reconnect:s,disconnect:l});return{state:o.readable,subscribe:o.subscribe,subscribeToChange:i.subscribe,get allowance(){var e;const t=M.value(o.readable.accessOp);return function(e){return{moderateAllChats:e.includes(X["moderate all chats"]),participateInAllChats:e.includes(X["moderate all chats"])||e.includes(X["participate in all chats"]),viewAllChats:e.includes(X["moderate all chats"])||e.includes(X["participate in all chats"])||e.includes(X["view all chats"]),banned:e.includes(se.privileges.banned)}}(null!==(e=null==t?void 0:t.permit.privileges)&&void 0!==e?e:[])},async updateAccessOp(e){o.writable.accessOp=e;const i=M.value(e);await c.updateAuthSituation(!!i);const n=M.value(o.readable.connectionOp);if(n){const e=await t();await n.serverside.chatServer.updateUserMeta(e)}},session:c.getRoomSession,disconnect:l,reconnect:s}}function pe(){const e=new Map;return{subscribe(t){const i=Symbol();return e.set(i,t),()=>{e.delete(i)}},publish:t=>{for(const[,i]of e)i(t)},clear(){e.clear()}}}function ue({notesService:e}){const t=W({accessOp:M.none(),statsOp:M.none()}),i=pe(),o=pe();function n(){var e;return!!(null===(e=M.value(t.readable.accessOp))||void 0===e?void 0:e.user)}function r(){var e;return null!==(e=M.value(t.readable.statsOp))&&void 0!==e?e:{newCount:0,oldCount:0}}const a=C((async function(){return M.operation({promise:e.getNotesStats(),setOp:e=>t.writable.statsOp=e})}));let s=!1;return{initialize:async function(){if(!s&&(s=!0,n()))return a()},state:t.readable,stateSubscribe:t.subscribe,async updateAccessOp(e){t.writable.accessOp=e,n()&&await async function(){if(s)return a()}(),i.publish(M.value(e))},get isLoggedIn(){return n()},get stats(){return r()},propagateChangeToOtherTabs:o,loadStats:a,overwriteStatsOp(e){t.writable.statsOp=e},createNotesCacheDetails:(()=>{const t=function({propagateChangeToOtherTabs:e,notesService:t,getStats:i,loadStats:o,getIsLoggedIn:n}){async function r(e){return t.getNewNotes(e)}async function a(e){return t.getOldNotes(e)}async function s(i,n){await t.markNotesNewOrOld({old:i,noteIds:n}),await o(),e.publish(void 0)}return function(){const l=W({old:!1,pageNumber:1,pageSize:10,notesOp:M.none()});function c(){l.writable.pageNumber=1,l.writable.pageSize=10}async function d(){if(!n())return l.writable.notesOp=M.ready([]),[];const{old:e,pageNumber:t,pageSize:i}=l.readable,o={offset:(t-1)*i,limit:i};await M.operation({setOp:e=>l.writable.notesOp=e,promise:e?a(o):r(o)})}function p(){const{old:e,pageSize:t}=l.readable,{oldCount:o,newCount:n}=i(),r=e?o:n;return Math.ceil(r/t)}const u=()=>l.writable.pageNumber<p(),h=()=>l.writable.pageNumber>1;return{subscribe:l.subscribe,cacheState:l.readable,async loginStatusChanged(){c(),await d()},get notes(){return M.value(l.readable.notesOp)},fetchAppropriateNotes:d,async switchTabNew(){l.writable.old=!1,c(),await d()},async switchTabOld(){l.writable.old=!0,c(),await d()},get isNextPageAvailable(){return u()},get isPreviousPageAvailable(){return h()},async nextPage(){if(!u())throw new Error("no next page");l.writable.pageNumber+=1,await d()},async previousPage(){if(!h())throw new Error("no previous page");l.writable.pageNumber-=1,await d()},async markAllNotesOld(){await t.markAllNotesOld(),await o(),e.publish(void 0),await d()},async markSpecificNoteOld(e){await s(!0,[e]),l.readable.pageNumber>p()&&l.readable.pageNumber>1&&(l.writable.pageNumber-=1),await d()},async markSpecificNoteNew(e){await s(!1,[e]),l.readable.pageNumber>p()&&l.readable.pageNumber>1&&(l.writable.pageNumber-=1),await d()},get totalPages(){return p()}}}}({notesService:e,propagateChangeToOtherTabs:o,getStats:r,loadStats:a,getIsLoggedIn:n});return()=>{const e=t();return{cache:e,setup:()=>i.subscribe((()=>e.loginStatusChanged()))}}})()}}function he({dacastService:e}){const t=pe(),i=W({accessOp:M.none(),linkedAccountOp:M.none()});let o=!1;async function n(){o&&(()=>{const e=M.value(i.readable.accessOp);return e&&e.permit.privileges.includes(G["moderate videos"])})()&&await async function(){return M.operation({promise:e.getLink(),setOp:e=>i.writable.linkedAccountOp=e})}()}return{state:i.readable,subscribe:i.subscribe,onLinkChange:t.subscribe,async updateAccessOp(e){i.writable.accessOp=e,i.writable.linkedAccountOp=M.none(),await n()},async initialize(){o||(o=!0,await n())},get linkedAccount(){return M.value(i.readable.linkedAccountOp)},linkAccount:async({apiKey:o})=>M.operation({setOp:e=>i.writable.linkedAccountOp=e,promise:e.setLink({apiKey:o}).then((e=>(t.publish(e),e)))}),unlinkAccount:async()=>M.operation({setOp:e=>i.writable.linkedAccountOp=e,promise:e.clearLink().then((()=>t.publish(void 0)))})}}function fe(e){const t=he(e),i=function({contentService:e}){const t=W({accessOp:M.none(),catalogOp:M.none(),viewsOp:M.none(),privilegesOp:M.none(),showsOp:M.none()}),i=new Set,o=new Set;function n(){return M.value(t.readable.accessOp)}let r=!1;async function a(){r=!0;const i=n();i&&i.permit.privileges.includes(G["moderate videos"])&&await M.operation({promise:e.fetchModerationData(),setOp:e=>{var i,o,n;const r=M.value(e);t.writable.catalogOp=M.replaceValue(e,null!==(i=null==r?void 0:r.catalog)&&void 0!==i?i:[]),t.writable.viewsOp=M.replaceValue(e,null!==(o=null==r?void 0:r.views)&&void 0!==o?o:[]),t.writable.privilegesOp=M.replaceValue(e,null!==(n=null==r?void 0:r.privileges)&&void 0!==n?n:[])}})}async function s(a){var s;if(r=!0,i.add(a),!n()||o.has(a))return;o.add(a);const l=null!==(s=M.value(t.readable.showsOp))&&void 0!==s?s:[];let c;return await M.operation({setOp:e=>t.writable.showsOp=e,promise:e.getShows({labels:[a]}).then((e=>e[0])).then((e=>c=e)).then((e=>[...l.filter((e=>e.label!==a)),...e?[e]:[{label:a,details:void 0}]]))}),o.delete(a),c}async function l(){if(r=!0,!n())return;const a=Array.from(i).filter((e=>!o.has(e)));if(a.length){for(const e of a)o.add(e);await M.operation({setOp:e=>t.writable.showsOp=e,promise:e.getShows({labels:a}).then((e=>e.filter((e=>!!e))))});for(const e of a)o.delete(e)}}return{state:t.readable,subscribe:t.subscribe,async updateAccessOp(e){t.writable.accessOp=e,t.writable.catalogOp=M.none(),t.writable.viewsOp=M.none(),r&&(await a(),await l())},async onVideoHostingUpdate(){r&&(await a(),await l())},async initializeForModerationData(){r||await a()},async initializeForVideo(e){r||await a(),await s(e)},get allowance(){const e=M.value(t.readable.accessOp),i=t=>!!e&&e.permit.privileges.includes(G[t]);return{canModerateVideos:i("moderate videos"),canViewAllVideos:i("moderate videos")||i("view all videos")}},get catalog(){var e;return null!==(e=M.value(t.readable.catalogOp))&&void 0!==e?e:[]},get views(){var e;return null!==(e=M.value(t.readable.viewsOp))&&void 0!==e?e:[]},get privileges(){var e;return null!==(e=M.value(t.readable.privilegesOp))&&void 0!==e?e:[]},get shows(){var e;return null!==(e=M.value(t.readable.showsOp))&&void 0!==e?e:[]},getView(e){var i;return(null!==(i=M.value(t.readable.viewsOp))&&void 0!==i?i:[]).find((t=>t.label===e))},getPrivilege(e){var i;return(null!==(i=M.value(t.readable.privilegesOp))&&void 0!==i?i:[]).find((t=>t.privilegeId===e))},getShow(e){var i;return(null!==(i=M.value(t.readable.showsOp))&&void 0!==i?i:[]).find((t=>t.label===e))},async setView(i){var o;const n=null!==(o=M.value(t.readable.viewsOp))&&void 0!==o?o:[];await M.operation({setOp:e=>t.writable.viewsOp=e,promise:e.writeView(i).then((()=>[...n.filter((e=>e.label!==i.label)),{...i.reference,label:i.label,privileges:i.privileges}]))}),await s(i.label)},async deleteView(i){var o,n;const r=null!==(o=M.value(t.readable.viewsOp))&&void 0!==o?o:[];await M.operation({setOp:e=>t.writable.viewsOp=e,promise:e.deleteView({label:i}).then((()=>r.filter((e=>e.label!==i))))});const a=null!==(n=M.value(t.readable.showsOp))&&void 0!==n?n:[];t.writable.showsOp=M.replaceValue(t.readable.showsOp,a.filter((e=>e.label!==i)))}}}(e);return t.onLinkChange(i.onVideoHostingUpdate),{dacastModel:t,contentModel:i,updateAccessOp(e){t.updateAccessOp(e),i.updateAccessOp(e)}}}function me(e,t,i){const o=[...e];for(const e of t){!!o.find((t=>i(t,e)))||o.push(e)}return o}function be({state:e,actions:t,questionsPostingService:i,questionsAnsweringService:o,questionsModerationService:n,getAccess:r,loadQuestionsForBoard:a}){return s=>({getPermissions(){const{access:t}=e;return{"read questions":!!t&&t.permit.privileges.includes(se.privileges["read questions"]),"post questions":!!t&&(t.permit.privileges.includes(se.privileges["post questions"])&&!t.permit.privileges.includes(se.privileges.banned)),"moderate questions":!!t&&t.permit.privileges.includes(se.privileges["moderate questions"]),"answer questions":!!t&&t.permit.privileges.includes(se.privileges["answer questions"]),"like questions":!!t&&t.permit.privileges.includes(se.privileges["like questions"]),"report questions":!!t&&t.permit.privileges.includes(se.privileges["report questions"])}},getBoardName:()=>s,getAccess:()=>e.access,getBoardOp:()=>e.boardOps[s],getPostingOp:()=>e.postingOp,getQuestions:()=>e.questions.filter((e=>e.board===s)).filter((e=>!1===e.archive)).map((e=>({...e,answers:e.answers.filter((e=>!1===e.archive))}))),getUser:t=>e.users.find((e=>e.userId===t)),async loadQuestions(){await a(s)},async postQuestion({content:e}){const o=await M.operation({promise:i.postQuestion({questionDraft:{board:s,content:e}}),setOp:e=>t.setPostingOp(M.replaceValue(e,void 0))});t.addQuestions([o]);const n=M.value(r());return t.addUsers([n.user]),o},async postAnswer(e,i){const n=await M.operation({promise:o.postAnswer({questionId:e,answerDraft:i}),setOp:e=>t.setPostingOp(M.replaceValue(e,void 0))});t.addAnswer(n);const a=M.value(r());return t.addUsers([a.user]),n},async likeQuestion(e,o){await i.likeQuestion({like:o,questionId:e}),t.setQuestionLike(e,o)},async likeAnswer(e,i,n){await o.likeAnswer({answerId:i,like:n}),t.setAnswerLike(e,i,n)},async reportQuestion(e,o){await i.reportQuestion({report:o,questionId:e}),t.setQuestionReport(e,o)},async reportAnswer(e,i,n){await o.reportAnswer({answerId:i,report:n}),t.setAnswerReport(e,i,n)},async archiveQuestion(e,o){await i.archiveQuestion({archive:o,questionId:e}),t.setQuestionArchive(e,o)},async archiveAnswer(e,i,n){await o.archiveAnswer({answerId:i,archive:n}),t.setAnswerArchive(e,i,n)},async archiveBoard(){await n.archiveBoard({board:s});for(const i of e.questions)t.setQuestionArchive(i.questionId,!0)}})}function ve(e){const{questionsReadingService:t}=e,{state:i,actions:o,subscribe:n}=function(){const e=W({access:void 0,users:[],questions:[],boardOps:{},postingOp:M.ready(void 0)}),t=e.writable,i={setAccess(e){t.access=e},setBoardOp(e,i){t.boardOps={...t.boardOps,[e]:i}},setPostingOp(e){t.postingOp=e},addUsers(e){t.users=[...me(e.filter((e=>!!e)),t.users,((e,t)=>e.userId===t.userId))]},addQuestions(e){t.questions=[...me(e,t.questions,((e,t)=>e.questionId===t.questionId))]},addAnswer(e){const i=t.questions.find((t=>t.questionId===e.questionId));if(!i)throw new Error(`can't find question to add answer, question id: "${e.questionId}"`);const o={...i,answers:[...i.answers,e]};t.questions=[...me([o],t.questions,((e,t)=>e.questionId===t.questionId))]},setQuestionLike(e,i){t.questions=t.questions.map((t=>t.questionId===e?{...t,liked:i,likes:t.liked===i?t.likes:i?t.likes+1:t.likes-1}:{...t}))},setAnswerLike(e,i,o){t.questions=t.questions.map((t=>t.questionId===e?{...t,answers:t.answers.map((e=>e.answerId===i?{...e,liked:o,likes:e.liked===o?e.likes:o?e.likes+1:e.likes-1}:{...e}))}:{...t}))},setAnswerReport(e,i,o){t.questions=t.questions.map((t=>t.questionId===e?{...t,answers:t.answers.map((e=>e.answerId===i?{...e,reported:o,reports:e.reported===o?e.reports:o?e.reports+1:e.reports-1}:{...e}))}:{...t}))},setQuestionReport(e,i){t.questions=t.questions.map((t=>t.questionId===e?{...t,reported:i,reports:t.reported===i?t.reports:i?t.reports+1:t.reports-1}:{...t}))},setQuestionArchive(e,i){t.questions=t.questions.map((t=>t.questionId===e?{...t,archive:i}:{...t}))},setAnswerArchive(e,i,o){t.questions=t.questions.map((t=>t.questionId===e?{...t,answers:t.answers.map((e=>e.answerId===i?{...e,archive:o}:{...e}))}:{...t}))}};return{actions:i,state:e.readable,subscribe:e.subscribe}}();async function r(e){await M.operation({promise:(async()=>{const{users:i,questions:n}=await t.fetchQuestions({board:e});o.addUsers(i),o.addQuestions(n)})(),setOp:t=>o.setBoardOp(e,t)})}return{subscribe:n,makeBoardModel:be({state:i,actions:o,loadQuestionsForBoard:r,...e}),accessChange:e=>{o.setAccess(e),(null==e?void 0:e.user)&&o.addUsers([e.user]),async function(){await Promise.all(Object.keys(i.boardOps).map(r))}()}}}class ge extends Error{}class we extends ge{constructor(){super("login token has expired")}}function ye({roleAssignmentService:e,reauthorize:t}){const i=W({accessOp:M.none(),permissionsOp:M.none()});function o(){return M.value(i.readable.accessOp)}let n=!1;function r(){return function(e,t){const i={};for(const[o,n]of Object.entries(t))i[o]=!!e&&e.permit.privileges.includes(n);return e=>i[e]}(o(),se.privileges)}async function a(){n&&r()("administrate user roles")&&await M.operation({promise:e.fetchPermissions(),setOp:e=>i.writable.permissionsOp=e})}return{state:i.readable,subscribe:i.subscribe,getAccess:o,initialize:async function(){n=!0,await a()},get isAllowed(){return r()},reauthorize:t,searchUsers:e.searchUsers,assignRoleToUser:e.assignRoleToUser,revokeRoleFromUser:e.revokeRoleFromUser,async updateAccessOp(e){i.writable.accessOp=e,a()}}}var xe,$e,ke;function Oe({stripePopups:e,services:t,stateSystem:i,reloadStore:o}){const n=i.snap.writable,{allowance:r}=i;return{load:async function(){n.stripeConnect.connectStatusOp=M.none(),n.stripeConnect.connectDetailsOp=M.none(),r.connectStripeAccount?await M.operation({promise:t.connect.loadConnectDetails(),setOp:e=>{var t,i;n.stripeConnect.connectStatusOp=M.replaceValue(e,null===(t=M.value(e))||void 0===t?void 0:t.connectStatus),n.stripeConnect.connectDetailsOp=M.replaceValue(e,null===(i=M.value(e))||void 0===i?void 0:i.connectDetails)}}):await M.operation({promise:t.connect.loadConnectStatus(),setOp:e=>n.stripeConnect.connectStatusOp=e})},get isOnboardingNeeded(){var e;const{get:t}=i;return t.connect.status===xe.Unlinked||!(null===(e=t.connect.details)||void 0===e?void 0:e.details_submitted)},get isAllowedToOnboard(){var e;const{get:t}=i,o=t.user.access;return!!(null==o?void 0:o.user)&&(!!o.permit.privileges.includes(Y["control stripe account"])&&(t.connect.status===xe.Unlinked||o.user.userId===(null===(e=t.connect.details)||void 0===e?void 0:e.userId)))},async stripeAccountOnboarding(){var i;const n=await t.connect.generatePopupForStripeAccountOnboarding();"return"===(null===(i=(await e.connect(n)).details)||void 0===i?void 0:i.status)&&await o()},async stripeLogin(){const i=M.value(n.stripeConnect.connectStatusOp),r=M.value(n.stripeConnect.connectDetailsOp);if(i===xe.Unlinked)throw new Error("no stripe account to generate login link for");if(!r)throw new Error("stripe connect details missing for login");const{stripeLoginLink:a,popupId:s}=await t.connect.generateStripeLoginLink(),{stripeAccountId:l}=r;await e.login({stripeAccountId:l,stripeLoginLink:a,popupId:s}),await o()},async pause(){await t.connect.pause(),n.stripeConnect.connectStatusOp=M.ready(xe.Paused),r.manageStore&&(n.stripeConnect.connectDetailsOp=M.ready({...M.value(n.stripeConnect.connectDetailsOp),paused:!0}))},async resume(){await t.connect.resume(),n.stripeConnect.connectStatusOp=M.ready(xe.Ready),r.manageStore&&(n.stripeConnect.connectDetailsOp=M.ready({...M.value(n.stripeConnect.connectDetailsOp),paused:!1}))}}}function Se({stripePopups:e,services:t,stateSystem:i,reloadStore:o}){const n=i.snap.writable,{get:r,allowance:a}=i;return{load:async function(){n.billing.paymentMethodOp=M.none(),r.is.storeActive&&r.is.userLoggedIn&&await M.operation({promise:t.billing.getDefaultPaymentMethod(),setOp:e=>n.billing.paymentMethodOp=e})},allowance:a,customerPortal:async function(){const{popupId:i,stripeSessionUrl:n,customer:r,stripeAccountId:a}=await t.billing.generateCustomerPortalLink();await e.openStoreCustomerPortal({popupId:i,customer:r,stripeSessionUrl:n,stripeAccountId:a}),await o()}}}function Ae({services:e,stateSystem:t,stripePopups:i,reauthorize:o}){const n=t.snap.writable,{get:r}=t;function a(){var e;return null!==(e=M.value(D(n.subscriptions.subscriptionPlansOp)))&&void 0!==e?e:[]}return{load:async function(){n.subscriptions.subscriptionPlansOp=M.none(),n.subscriptions.mySubscriptionDetailsOp=M.none(),r.is.storeActive&&(await M.operation({setOp:e=>n.subscriptions.subscriptionPlansOp=e,promise:e.subscriptions.listing.listPlans()}),r.is.userLoggedIn&&await M.operation({setOp:e=>n.subscriptions.mySubscriptionDetailsOp=e,promise:e.subscriptions.shopping.fetchDetailsAboutMySubscriptions()}))},...T({async purchase({stripePriceId:t,showLoadingSpinner:o}){o&&(n.subscriptions.mySubscriptionDetailsOp=M.loading());const{checkoutDetails:r}=await e.subscriptions.shopping.buy(t);r&&await i.checkoutSubscription(r)},async cancel(t){n.subscriptions.mySubscriptionDetailsOp=M.loading(),await e.subscriptions.shopping.cancel(t)},async uncancel(t){n.subscriptions.mySubscriptionDetailsOp=M.loading(),await e.subscriptions.shopping.uncancel(t)}},(e=>async(...t)=>{await e(...t),await o()})),async addPlan(t){const i=await e.subscriptions.planning.addPlan(t),o=a();return n.subscriptions.subscriptionPlansOp=M.replaceValue(n.subscriptions.subscriptionPlansOp,[...o,i]),i},async addTier(t){const i=a(),o=await e.subscriptions.planning.addTier(t),r=i.find((e=>e.planId===t.planId));return r.tiers=[...r.tiers,o],n.subscriptions.subscriptionPlansOp=M.ready(i),o},async editPlan({planId:t,label:i,archived:o}){await e.subscriptions.planning.editPlan({planId:t,label:i,archived:o});const r=a(),s=r.find((e=>e.planId===t));s.label=i,s.archived=o,n.subscriptions.subscriptionPlansOp=M.ready(r)},async editTier({planId:t,tierId:i,label:o,active:r,pricing:s}){const l=await e.subscriptions.planning.editTier({tierId:i,active:r,label:o,pricing:s}),c=a(),d=c.find((e=>e.planId===t));d.tiers=d.tiers.map((function(e){return e.tierId===l.tierId?l:e})),n.subscriptions.subscriptionPlansOp=M.ready(c)}}}function Pe(e){const t=function(){const e=W({user:{accessOp:M.none()},stripeConnect:{connectStatusOp:M.none(),connectDetailsOp:M.none()},subscriptions:{subscriptionPlansOp:M.none(),mySubscriptionDetailsOp:M.none()},billing:{paymentMethodOp:M.none()}}),t=e.readable,i=(()=>{const e=e=>{var i,o;return(null!==(o=null===(i=M.value(t.user.accessOp))||void 0===i?void 0:i.permit.privileges)&&void 0!==o?o:[]).includes(Y[e])};return{get manageStore(){return e("manage store")},get connectStripeAccount(){return e("control stripe account")},get giveAwayFreebies(){return e("give away freebies")}}})();return{snap:e,state:t,allowance:i,get:{is:{get storeActive(){return M.value(e.state.stripeConnect.connectStatusOp)===xe.Ready},get userLoggedIn(){var t;return!!(null===(t=M.value(e.state.user.accessOp))||void 0===t?void 0:t.user)}},user:{get access(){return M.value(t.user.accessOp)}},connect:{get status(){return M.value(t.stripeConnect.connectStatusOp)},get details(){return M.value(t.stripeConnect.connectDetailsOp)}},subscriptions:{get plans(){return M.value(t.subscriptions.subscriptionPlansOp)},get mySubscriptionDetails(){return M.value(t.subscriptions.mySubscriptionDetailsOp)}},billing:{get paymentMethod(){return M.value(t.billing.paymentMethodOp)}}}}}(),i={...e,stateSystem:t,reloadStore:async()=>n.load()},o={subscriptions:Ae(i),billing:Se(i),connect:Oe(i)},n=function({state:e,loadStore:t}){async function i(){M.isReady(e.user.accessOp)&&await t()}let o=!1;return{load:i,initialize:async function(){o||(o=!0,await i())},refresh:async function(){o&&await i()}}}({state:t.state,loadStore:async()=>{await o.connect.load(),await Promise.all([o.billing.load(),o.subscriptions.load()])}});return{...t,...o,...n,async updateAccessOp(e){t.snap.state.user.accessOp=e,await n.refresh()}}}async function Ce({appId:e,remote:t,storage:i,authMediator:o,stripePopups:n,chatConnect:r}){const a=function({authMediator:e,loginService:t}){let i=M.none();const o=P();async function n(e){i=e,await o.publish(e)}async function r(e){return M.operation({promise:e,setOp:n})}e.subscribeToAccessChange((async e=>n(M.ready(e))));const a={async useExistingLogin(){await r(e.initialize())},sendLoginLink:async e=>t.sendLoginLink({email:e}),async login(i){try{if(!g(i))throw new we;await r(t.authenticateViaLoginToken({loginToken:i}).then((t=>e.login(t))))}catch(t){throw console.error(t),await n(M.none()),await r(e.initialize()),t}},async logout(){await r(e.logout()),await M.operation({promise:e.logout(),setOp:n})},async reauthorize(){await r(e.reauthorize())}};return{...a,subscribe:o.subscribe,getAccessOp:()=>structuredClone(i),getAccess:()=>M.value(structuredClone(i)),getValidAccess:()=>e.getValidAccess()}}({authMediator:o,loginService:t.auth.users.loginService}),{getAccessOp:s,getAccess:l,getValidAccess:c,reauthorize:d}=a,p=function({getAccessOp:e}){const t=W({accessOp:e()});return{state:t.readable,subscribe:t.subscribe,updateAccessOp:e=>{t.writable.accessOp=e}}}({getAccessOp:s}),u=function({personalService:e,getAccessOp:t,reauthorize:i}){const{readable:o,writable:n,track:r,subscribe:a}=W({accessOp:t(),submitDraftOp:M.ready(void 0)});return{track:r,subscribe:a,readable:o,async saveProfile(t){await M.operation({promise:(async()=>{const{user:{userId:n}}=M.value(o.accessOp);await e.setProfile({userId:n,profileDraft:t}),await i()})(),errorReason:"error saving profile",setOp(e){n.submitDraftOp=e}})},updateAccessOp(e){n.accessOp=e}}}({personalService:t.auth.users.personalService,getAccessOp:s,reauthorize:d}),h=function({appService:e,appEditService:t,getValidAccess:i}){const{readable:o,writable:n,subscribe:r}=W({active:!1,appRecords:M.none(),addingNewApp:M.none()}),a={setAppRecords(e){var t;const i=null!==(t=M.value(e))&&void 0!==t?t:[];let o={};for(const e of i)o[e.appId]=M.ready(e);n.appRecords=M.replaceValue(e,o)},setIndividualAppRecord(e,t){var i;if(M.isLoading(n.appRecords))throw new Error("cannot set individual app while apps are loading");const o=null!==(i=M.value(n.appRecords))&&void 0!==i?i:{};n.appRecords=M.ready({...o,[e]:t})},deleteIndividualAppRecord(e){if(!M.isReady(n.appRecords))throw new Error("cannot delete individual app while apps are loading");{const t=M.value(n.appRecords),i={};for(const[o,n]of Object.entries(t))o!==e&&(i[o]=n);n.appRecords=M.ready(i)}}};async function s(){var e;const t=await i();return null===(e=null==t?void 0:t.user)||void 0===e?void 0:e.userId}async function l(){return n.active=!0,M.operation({promise:(async()=>{const t=await s();return t?e.listApps({ownerUserId:t}):[]})(),setOp:e=>a.setAppRecords(e)})}function c(e){const t=M.value(n.appRecords);return t?M.value(t[e]):void 0}return{state:o,subscribe:r,appEditService:t,getApp:c,loadApps:l,deleteApp:async function(e){await M.operation({promise:t.deleteApp({appId:e}),setOp:t=>{a.setIndividualAppRecord(e,M.replaceValue(t,c(e)))}}),a.deleteIndividualAppRecord(e)},updateApp:async function(e,i){const o=M.value(n.appRecords);if(!o)throw new Error("cannot update app while loading records");const r=M.value(o[e]);if(!r)throw new Error("cannot update app not present in records");return M.operation({promise:t.updateApp({appId:e,appDraft:i}),setOp:t=>a.setIndividualAppRecord(e,M.replaceValue(t,{...r,...i}))})},registerApp:async function(i){const o=await s();return await M.operation({errorReason:"failed to register app",promise:(async()=>{const n=await e.registerApp({appDraft:i,ownerUserId:o});return await t.assignPlatformUserAsAdmin({appId:n.appId,platformUserId:o}),n})(),setOp:e=>{if(n.addingNewApp=M.replaceValue(e,null),M.isReady(e)){const t={...M.value(e),...i};a.setIndividualAppRecord(t.appId,M.ready(t))}}})},async updateAccessOp(e){o.active&&await l()}}}({appService:t.auth.apps.appService,appEditService:t.auth.apps.appEditService,getValidAccess:c}),f=function({permissionsService:e,reauthorize:t}){const{readable:i,writable:o,subscribe:n,track:r}=W({active:!1,accessOp:M.none(),permissionsDisplay:M.none()});function a(){return M.value(i.accessOp)}function s(e){const t=[],i=[];for(const o of e.privileges)o.hard?i.push(o):t.push(o);return t.sort(((e,t)=>t.time-e.time)),{...e,privileges:[...t,...i]}}async function l(){await M.operation({promise:Promise.resolve().then((async()=>c()?e.fetchPermissions().then(s):void 0)),setOp:e=>o.permissionsDisplay=e})}function c(){const e=a();return!!(null==e?void 0:e.user)&&e.permit.privileges.includes(se.privileges["customize permissions"])}function d(e){return async(...i)=>{const o=await e(...i);return await l(),await t(),o}}return{readable:i,subscribe:n,track:r,getAccess:a,initialize:async function(){o.active=!0,c()&&await l()},getUserCanCustomizePermissions:c,createRole:d(e.createRole),deleteRole:d(e.deleteRole),assignPrivilege:d(e.assignPrivilege),unassignPrivilege:d(e.unassignPrivilege),deletePrivilege:d(e.deletePrivilege),createPrivilege:d(e.createPrivilege),async updateAccessOp(e){o.accessOp=e;const t=a();(null==t?void 0:t.user)&&o.active&&await l()}}}({permissionsService:t.auth.permissions.permissionsService,reauthorize:d}),m=fe({dacastService:t.videos.dacastService,contentService:t.videos.contentService}),b=de({chatConnect:r,getChatMeta:async()=>({accessToken:await o.getValidAccessToken()})}),v=ue({notesService:t.notes.notesService}),w=Pe({stripePopups:n,services:t.store,reauthorize:d}),y=ye({roleAssignmentService:t.administrative.roleAssignmentService,reauthorize:()=>a.reauthorize()}),x=ve({...t.questions,getAccess:s});return a.subscribe((async e=>{const t=l();await Promise.all([p.updateAccessOp(e),u.updateAccessOp(e),h.updateAccessOp(e),f.updateAccessOp(e),x.accessChange(t),y.updateAccessOp(e),m.dacastModel.updateAccessOp(e),m.contentModel.updateAccessOp(e),b.updateAccessOp(e),v.updateAccessOp(e),w.updateAccessOp(e)])})),{exampleModel:p,appsModel:h,chatModel:b,accessModel:a,videoModels:m,notesModel:v,storeModel:w,personalModel:u,questionsModel:x,permissionsModel:f,administrativeModel:y}}!function(e){e[e.Unlinked=0]="Unlinked",e[e.Incomplete=1]="Incomplete",e[e.Paused=2]="Paused",e[e.Ready=3]="Ready"}(xe||(xe={})),function(e){e[e.Unsubscribed=0]="Unsubscribed",e[e.Active=1]="Active",e[e.Unpaid=2]="Unpaid",e[e.Cancelled=3]="Cancelled"}($e||($e={})),function(e){e[e.Update=0]="Update",e[e.UsePaymentMethod=1]="UsePaymentMethod",e[e.CheckoutPopup=2]="CheckoutPopup"}(ke||(ke={}));const Ie=window,Me=Ie.ShadowRoot&&(void 0===Ie.ShadyCSS||Ie.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Ee=Symbol(),Re=new WeakMap;let Te=class{constructor(e,t,i){if(this._$cssResult$=!0,i!==Ee)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(Me&&void 0===e){const i=void 0!==t&&1===t.length;i&&(e=Re.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),i&&Re.set(t,e))}return e}toString(){return this.cssText}};const _e=e=>new Te("string"==typeof e?e:e+"",void 0,Ee),je=(e,...t)=>{const i=1===e.length?e[0]:t.reduce(((t,i,o)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(i)+e[o+1]),e[0]);return new Te(i,e,Ee)},De=Me?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const i of e.cssRules)t+=i.cssText;return _e(t)})(e):e;var qe;const Ue=window,Ne=Ue.trustedTypes,ze=Ne?Ne.emptyScript:"",Le=Ue.reactiveElementPolyfillSupport,Be={toAttribute(e,t){switch(t){case Boolean:e=e?ze:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let i=e;switch(t){case Boolean:i=null!==e;break;case Number:i=null===e?null:Number(e);break;case Object:case Array:try{i=JSON.parse(e)}catch(e){i=null}}return i}},Ve=(e,t)=>t!==e&&(t==t||e==e),We={attribute:!0,type:String,converter:Be,reflect:!1,hasChanged:Ve};let He=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,i)=>{const o=this._$Ep(i,t);void 0!==o&&(this._$Ev.set(o,i),e.push(o))})),e}static createProperty(e,t=We){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const i="symbol"==typeof e?Symbol():"__"+e,o=this.getPropertyDescriptor(e,i,t);void 0!==o&&Object.defineProperty(this.prototype,e,o)}}static getPropertyDescriptor(e,t,i){return{get(){return this[t]},set(o){const n=this[e];this[t]=o,this.requestUpdate(e,n,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||We}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const i of t)this.createProperty(i,e[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const i=new Set(e.flat(1/0).reverse());for(const e of i)t.unshift(De(e))}else void 0!==e&&t.push(De(e));return t}static _$Ep(e,t){const i=t.attribute;return!1===i?void 0:"string"==typeof i?i:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,i;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(i=e.hostConnected)||void 0===i||i.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{Me?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const i=document.createElement("style"),o=Ie.litNonce;void 0!==o&&i.setAttribute("nonce",o),i.textContent=t.cssText,e.appendChild(i)}))})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,i){this._$AK(e,i)}_$EO(e,t,i=We){var o;const n=this.constructor._$Ep(e,i);if(void 0!==n&&!0===i.reflect){const r=(void 0!==(null===(o=i.converter)||void 0===o?void 0:o.toAttribute)?i.converter:Be).toAttribute(t,i.type);this._$El=e,null==r?this.removeAttribute(n):this.setAttribute(n,r),this._$El=null}}_$AK(e,t){var i;const o=this.constructor,n=o._$Ev.get(e);if(void 0!==n&&this._$El!==n){const e=o.getPropertyOptions(n),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(i=e.converter)||void 0===i?void 0:i.fromAttribute)?e.converter:Be;this._$El=n,this[n]=r.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,i){let o=!0;void 0!==e&&(((i=i||this.constructor.getPropertyOptions(e)).hasChanged||Ve)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===i.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,i))):o=!1),!this.isUpdatePending&&o&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const i=this._$AL;try{t=this.shouldUpdate(i),t?(this.willUpdate(i),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(i)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(i)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}};var Fe;He.finalized=!0,He.elementProperties=new Map,He.elementStyles=[],He.shadowRootOptions={mode:"open"},null==Le||Le({ReactiveElement:He}),(null!==(qe=Ue.reactiveElementVersions)&&void 0!==qe?qe:Ue.reactiveElementVersions=[]).push("1.5.0");const Xe=window,Qe=Xe.trustedTypes,Je=Qe?Qe.createPolicy("lit-html",{createHTML:e=>e}):void 0,Ke=`lit$${(Math.random()+"").slice(9)}$`,Ye="?"+Ke,Ze=`<${Ye}>`,Ge=document,et=(e="")=>Ge.createComment(e),tt=e=>null===e||"object"!=typeof e&&"function"!=typeof e,it=Array.isArray,ot=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,nt=/-->/g,rt=/>/g,at=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),st=/'/g,lt=/"/g,ct=/^(?:script|style|textarea|title)$/i,dt=e=>(t,...i)=>({_$litType$:e,strings:t,values:i}),pt=dt(1),ut=dt(2),ht=Symbol.for("lit-noChange"),ft=Symbol.for("lit-nothing"),mt=new WeakMap,bt=Ge.createTreeWalker(Ge,129,null,!1),vt=(e,t)=>{const i=e.length-1,o=[];let n,r=2===t?"<svg>":"",a=ot;for(let t=0;t<i;t++){const i=e[t];let s,l,c=-1,d=0;for(;d<i.length&&(a.lastIndex=d,l=a.exec(i),null!==l);)d=a.lastIndex,a===ot?"!--"===l[1]?a=nt:void 0!==l[1]?a=rt:void 0!==l[2]?(ct.test(l[2])&&(n=RegExp("</"+l[2],"g")),a=at):void 0!==l[3]&&(a=at):a===at?">"===l[0]?(a=null!=n?n:ot,c=-1):void 0===l[1]?c=-2:(c=a.lastIndex-l[2].length,s=l[1],a=void 0===l[3]?at:'"'===l[3]?lt:st):a===lt||a===st?a=at:a===nt||a===rt?a=ot:(a=at,n=void 0);const p=a===at&&e[t+1].startsWith("/>")?" ":"";r+=a===ot?i+Ze:c>=0?(o.push(s),i.slice(0,c)+"$lit$"+i.slice(c)+Ke+p):i+Ke+(-2===c?(o.push(void 0),t):p)}const s=r+(e[i]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==Je?Je.createHTML(s):s,o]};class gt{constructor({strings:e,_$litType$:t},i){let o;this.parts=[];let n=0,r=0;const a=e.length-1,s=this.parts,[l,c]=vt(e,t);if(this.el=gt.createElement(l,i),bt.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(o=bt.nextNode())&&s.length<a;){if(1===o.nodeType){if(o.hasAttributes()){const e=[];for(const t of o.getAttributeNames())if(t.endsWith("$lit$")||t.startsWith(Ke)){const i=c[r++];if(e.push(t),void 0!==i){const e=o.getAttribute(i.toLowerCase()+"$lit$").split(Ke),t=/([.?@])?(.*)/.exec(i);s.push({type:1,index:n,name:t[2],strings:e,ctor:"."===t[1]?kt:"?"===t[1]?St:"@"===t[1]?At:$t})}else s.push({type:6,index:n})}for(const t of e)o.removeAttribute(t)}if(ct.test(o.tagName)){const e=o.textContent.split(Ke),t=e.length-1;if(t>0){o.textContent=Qe?Qe.emptyScript:"";for(let i=0;i<t;i++)o.append(e[i],et()),bt.nextNode(),s.push({type:2,index:++n});o.append(e[t],et())}}}else if(8===o.nodeType)if(o.data===Ye)s.push({type:2,index:n});else{let e=-1;for(;-1!==(e=o.data.indexOf(Ke,e+1));)s.push({type:7,index:n}),e+=Ke.length-1}n++}}static createElement(e,t){const i=Ge.createElement("template");return i.innerHTML=e,i}}function wt(e,t,i=e,o){var n,r,a,s;if(t===ht)return t;let l=void 0!==o?null===(n=i._$Co)||void 0===n?void 0:n[o]:i._$Cl;const c=tt(t)?void 0:t._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(r=null==l?void 0:l._$AO)||void 0===r||r.call(l,!1),void 0===c?l=void 0:(l=new c(e),l._$AT(e,i,o)),void 0!==o?(null!==(a=(s=i)._$Co)&&void 0!==a?a:s._$Co=[])[o]=l:i._$Cl=l),void 0!==l&&(t=wt(e,l._$AS(e,t.values),l,o)),t}class yt{constructor(e,t){this.u=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(e){var t;const{el:{content:i},parts:o}=this._$AD,n=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:Ge).importNode(i,!0);bt.currentNode=n;let r=bt.nextNode(),a=0,s=0,l=o[0];for(;void 0!==l;){if(a===l.index){let t;2===l.type?t=new xt(r,r.nextSibling,this,e):1===l.type?t=new l.ctor(r,l.name,l.strings,this,e):6===l.type&&(t=new Pt(r,this,e)),this.u.push(t),l=o[++s]}a!==(null==l?void 0:l.index)&&(r=bt.nextNode(),a++)}return n}p(e){let t=0;for(const i of this.u)void 0!==i&&(void 0!==i.strings?(i._$AI(e,i,t),t+=i.strings.length-2):i._$AI(e[t])),t++}}class xt{constructor(e,t,i,o){var n;this.type=2,this._$AH=ft,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=i,this.options=o,this._$Cm=null===(n=null==o?void 0:o.isConnected)||void 0===n||n}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cm}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=wt(this,e,t),tt(e)?e===ft||null==e||""===e?(this._$AH!==ft&&this._$AR(),this._$AH=ft):e!==this._$AH&&e!==ht&&this.g(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>it(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.k(e):this.g(e)}O(e,t=this._$AB){return this._$AA.parentNode.insertBefore(e,t)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}g(e){this._$AH!==ft&&tt(this._$AH)?this._$AA.nextSibling.data=e:this.T(Ge.createTextNode(e)),this._$AH=e}$(e){var t;const{values:i,_$litType$:o}=e,n="number"==typeof o?this._$AC(e):(void 0===o.el&&(o.el=gt.createElement(o.h,this.options)),o);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===n)this._$AH.p(i);else{const e=new yt(n,this),t=e.v(this.options);e.p(i),this.T(t),this._$AH=e}}_$AC(e){let t=mt.get(e.strings);return void 0===t&&mt.set(e.strings,t=new gt(e)),t}k(e){it(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let i,o=0;for(const n of e)o===t.length?t.push(i=new xt(this.O(et()),this.O(et()),this,this.options)):i=t[o],i._$AI(n),o++;o<t.length&&(this._$AR(i&&i._$AB.nextSibling,o),t.length=o)}_$AR(e=this._$AA.nextSibling,t){var i;for(null===(i=this._$AP)||void 0===i||i.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cm=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class $t{constructor(e,t,i,o,n){this.type=1,this._$AH=ft,this._$AN=void 0,this.element=e,this.name=t,this._$AM=o,this.options=n,i.length>2||""!==i[0]||""!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=ft}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,i,o){const n=this.strings;let r=!1;if(void 0===n)e=wt(this,e,t,0),r=!tt(e)||e!==this._$AH&&e!==ht,r&&(this._$AH=e);else{const o=e;let a,s;for(e=n[0],a=0;a<n.length-1;a++)s=wt(this,o[i+a],t,a),s===ht&&(s=this._$AH[a]),r||(r=!tt(s)||s!==this._$AH[a]),s===ft?e=ft:e!==ft&&(e+=(null!=s?s:"")+n[a+1]),this._$AH[a]=s}r&&!o&&this.j(e)}j(e){e===ft?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class kt extends $t{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===ft?void 0:e}}const Ot=Qe?Qe.emptyScript:"";class St extends $t{constructor(){super(...arguments),this.type=4}j(e){e&&e!==ft?this.element.setAttribute(this.name,Ot):this.element.removeAttribute(this.name)}}class At extends $t{constructor(e,t,i,o,n){super(e,t,i,o,n),this.type=5}_$AI(e,t=this){var i;if((e=null!==(i=wt(this,e,t,0))&&void 0!==i?i:ft)===ht)return;const o=this._$AH,n=e===ft&&o!==ft||e.capture!==o.capture||e.once!==o.once||e.passive!==o.passive,r=e!==ft&&(o===ft||n);n&&this.element.removeEventListener(this.name,this,o),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,i;"function"==typeof this._$AH?this._$AH.call(null!==(i=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==i?i:this.element,e):this._$AH.handleEvent(e)}}class Pt{constructor(e,t,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){wt(this,e)}}const Ct=Xe.litHtmlPolyfillSupport;null==Ct||Ct(gt,xt),(null!==(Fe=Xe.litHtmlVersions)&&void 0!==Fe?Fe:Xe.litHtmlVersions=[]).push("2.5.0");const It=(e,t,i)=>{var o,n;const r=null!==(o=null==i?void 0:i.renderBefore)&&void 0!==o?o:t;let a=r._$litPart$;if(void 0===a){const e=null!==(n=null==i?void 0:i.renderBefore)&&void 0!==n?n:null;r._$litPart$=a=new xt(t.insertBefore(et(),e),e,void 0,null!=i?i:{})}return a._$AI(e),a};var Mt,Et;class Rt extends He{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const i=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=i.firstChild),i}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=It(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return ht}}Rt.finalized=!0,Rt._$litElement$=!0,null===(Mt=globalThis.litElementHydrateSupport)||void 0===Mt||Mt.call(globalThis,{LitElement:Rt});const Tt=globalThis.litElementPolyfillSupport;null==Tt||Tt({LitElement:Rt}),(null!==(Et=globalThis.litElementVersions)&&void 0!==Et?Et:globalThis.litElementVersions=[]).push("3.2.2");const _t=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(i){i.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(i){i.createProperty(t.key,e)}};function jt(e){return(t,i)=>void 0!==i?((e,t,i)=>{t.constructor.createProperty(i,e)})(e,t,i):_t(e,t)}function Dt(e,t){return(({finisher:e,descriptor:t})=>(i,o)=>{var n;if(void 0===o){const o=null!==(n=i.originalKey)&&void 0!==n?n:i.key,r=null!=t?{kind:"method",placement:"prototype",key:o,descriptor:t(i.key)}:{...i,key:o};return null!=e&&(r.finisher=function(t){e(t,o)}),r}{const n=i.constructor;void 0!==t&&Object.defineProperty(i,o,t(o)),null==e||e(n,o)}})({descriptor:i=>{const o={get(){var t,i;return null!==(i=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(e))&&void 0!==i?i:null},enumerable:!0,configurable:!0};if(t){const t="symbol"==typeof i?Symbol():"__"+i;o.get=function(){var i,o;return void 0===this[t]&&(this[t]=null!==(o=null===(i=this.renderRoot)||void 0===i?void 0:i.querySelector(e))&&void 0!==o?o:null),this[t]}}return o}})}var qt;function Ut(e){return[e].flat()}null===(qt=window.HTMLSlotElement)||void 0===qt||qt.prototype.assignedElements;const Nt=e=>void 0!==e;function zt(...e){return function(t){var i;return(i=class extends t{}).styles=function(e,t){var i;return[...null!==(i=Ut(e))&&void 0!==i?i:[],...Ut(t)].flat().filter(Nt)}(t.styles,e),i}}const Lt=(e,t)=>function(e,t){const i={};for(const[o,n]of Object.entries(e))i[o]=t(n,o);return i}(t,(t=>zt(e)(t)));function Bt(e){return class extends e{connectedCallback(){super.connectedCallback(),this.setAttribute("focusable","")}}}var Vt=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},Wt=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};function Ht(...e){return function(t){var i,o;return o=class extends t{constructor(){super(...arguments),i.set(this,[])}connectedCallback(){super.connectedCallback();const t=()=>{this.requestUpdate()};Wt(this,i,e.map((e=>e(t))),"f")}disconnectedCallback(){super.disconnectedCallback();for(const e of Vt(this,i,"f"))e();Wt(this,i,[],"f")}},i=new WeakMap,o}}function Ft(e){return function(t){return class extends t{get share(){return e}}}}function Xt(e){return function(t){return class extends t{get share(){throw new Error("share required by component"+(e?" "+e:""))}}}}var Qt=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i},Jt=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};var Kt,Yt,Zt=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},Gt=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};class ei extends(function(e){return class extends e{connectedCallback(){super.connectedCallback(),this.hasAttribute("initially-hidden")&&this.removeAttribute("initially-hidden")}}}(Rt)){constructor(){super(...arguments),Kt.set(this,[]),Yt.set(this,(()=>{}))}init(){}firstUpdated(e){super.firstUpdated(e),this.init()}addSubscription(e){if(Zt(this,Kt,"f").push(e),this.isConnected){const t=e(),i=Zt(this,Yt,"f");Gt(this,Yt,(()=>{t(),i()}),"f")}}subscribe(){const e=Zt(this,Kt,"f").map((e=>e()));return()=>e.forEach((e=>e()))}connectedCallback(){super.connectedCallback(),Gt(this,Yt,this.subscribe(),"f")}disconnectedCallback(){super.disconnectedCallback(),Zt(this,Yt,"f").call(this),Gt(this,Yt,(()=>{}),"f")}render(){throw new Error("component render method not implemented")}}Kt=new WeakMap,Yt=new WeakMap;var ti=je`

* {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
}

:focus {
	outline: var(--focus-outline, 2px solid cyan);
}

:host-context(:focus) {
	outline: 0 !important;
}

`,ii=je`

:host {
	display: inline-block;
	position: relative;
	width: 6em;
}

:host::before {
	opacity: 0;
	content: "copied!";
	display: block;
	position: absolute;
	top: -0.5em;
	right: -0.5em;
	background: #0a0c;
	padding: 0 0.5em;
	border-radius: 1em;
	pointer-events: none;
	z-index: 1;
}

:host(:not([copied]))::before {
	transition: opacity 500ms ease;
}

:host([copied])::before {
	opacity: 1;
}

button {
	font: inherit;
	color: inherit;
	background: transparent;
	width: 100%;
}

.container {
	position: relative;
	display: flex;
	flex-direction: row;
	user-select: none;
	cursor: pointer;
	border: none;
}

.content {
	display: flex;
	justify-content: row;
}

.label::after {
	content: ":";
	margin-right: 0.2em;
}

.id {
	opacity: 0.75;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}

.copy svg {
	width: 1em;
	height: 1em;
}

.copy {
	opacity: 0.4;
	transition: opacity 100ms linear;
}

.container:hover .copy {
	opacity: 0.9;
}

.container:active .copy {
	opacity: 1;
}

`,oi=ut`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clipboard"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg>`,ni=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let ri=class extends ei{constructor(){super(...arguments),this.copied=!1}async copy(){try{await navigator.clipboard.writeText(this.id);const e=document.activeElement;e&&e.blur(),this.copyTimeout&&clearTimeout(this.copyTimeout),this.copied=!0,this.copyTimeout=setTimeout((()=>{this.copied=!1,this.copyTimeout=void 0}),1e3)}catch(e){console.error("failed to copy")}}render(){return pt`
			<button class=container @click=${this.copy}>
				<div class=id>${this.id}</div>
				<div class=copy>
					${oi}
				</div>
			</button>
		`}};ni([jt()],ri.prototype,"id",void 0),ni([jt({type:Boolean,reflect:!0})],ri.prototype,"copied",void 0),ri=ni([Bt,zt(ii)],ri);var ai=je`

slot {
	vertical-align: middle;
}

svg, span {
	display: inline-block;
	vertical-align: middle;
}

svg {
	width: var(--op-size, 1.2em);
	height: var(--op-size, 1.2em);
}

slot[name=loading] svg {
	animation:
		spin 10s linear infinite,
		fade 500ms ease infinite alternate;
}

slot[name=error] * {
	color: var(--loading-error-color, red);
}

@keyframes spin {
	from { transform: rotate(0deg); }
	to { transform: rotate(360deg); }
}

@keyframes fade {
	from { opacity: 1.0; }
	to { opacity: 0.5; }
}

`,si=ut`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 20 20"><g fill="none"><path d="M10 7a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0v-4A.5.5 0 0 1 10 7z" fill="currentColor"/><path d="M10 14.5a.75.75 0 1 0 0-1.5a.75.75 0 0 0 0 1.5z" fill="currentColor"/><path d="M8.686 2.852a1.5 1.5 0 0 1 2.628 0l6.56 11.925A1.5 1.5 0 0 1 16.558 17H3.44a1.5 1.5 0 0 1-1.314-2.223L8.686 2.852zm1.752.482a.5.5 0 0 0-.876 0L3.003 15.26a.5.5 0 0 0 .438.741H16.56a.5.5 0 0 0 .438-.74L10.438 3.333z" fill="currentColor"/></g></svg>`,li=ut`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-loader"><line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line></svg>`,ci=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let di=class extends ei{constructor(){super(...arguments),this.mode="none",this._op=M.none(),this.errorIcon=si,this.loadingIcon=li,this["loading-message"]="",this["error-message"]="error",this["hide-error-text"]=!1}get op(){return this._op}set op(e){const t=this._op;this._op=e,this.mode=M.mode(e),this.requestUpdate("op",t)}firstUpdated(){this["start-loading"]&&(this.op=M.loading())}render(){return M.select(this.op,{none:()=>pt`
				<slot name=none></slot>
			`,loading:()=>pt`
				<slot name=loading>
					${this.loadingIcon}
					${this["loading-message"]?pt`<span>${this["loading-message"]}</span>`:null}
				</slot>
			`,error:e=>pt`
				<slot name=error>
					${this.errorIcon}
					${this["hide-error-text"]?null:pt`<span>${null!=e?e:this["error-message"]}</span>`}
					
				</slot>
			`,ready:()=>pt`
				<slot></slot>
			`})}};function pi(e){return Array.from(e.assignedNodes()).filter((e=>e instanceof HTMLElement))}ci([jt({type:String,reflect:!0})],di.prototype,"mode",void 0),ci([jt({type:Object})],di.prototype,"op",null),ci([jt()],di.prototype,"errorIcon",void 0),ci([jt()],di.prototype,"loadingIcon",void 0),ci([jt({type:String})],di.prototype,"loading-message",void 0),ci([jt({type:String})],di.prototype,"error-message",void 0),ci([jt({type:Boolean})],di.prototype,"hide-error-text",void 0),ci([jt({type:Boolean})],di.prototype,"start-loading",void 0),di=ci([zt(ai)],di);var ui,hi,fi=je`

:host {
	display: block;
	width: 2em;
	height: 2em;
}

:host([theme="concrete"]) [part="button"] {
	display: block;
	font-size: inherit;
	color: inherit;
	position: relative;
	padding: 0;
	border: none;
	background: transparent;
	width: 100%;
	height: 100%;
}

:host([theme="concrete"]) [part="buttoncontent"] {
	display: flex;
	width: 100%;
	height: 100%;
	justify-content: center;
	align-items: center;
}

:host([theme="concrete"]) [part="buttoncontent"] {
	transform: scale(1);
	transition: transform 100ms ease;
}

:host([theme="concrete"]) [part="buttoncontent"]:active {
	transform: scale(1.1);
}

[part="panel"] {
	display: none;
}

:host([open]) [part="panel"] {
	display: block;
}

:host([theme="concrete"]) [part="panel"] {
	position: absolute;
	left: var(--menu-lanesize, 1rem);
	right: var(--menu-lanesize, 1rem);
	width: var(--menu-panel-width, 640px);
	max-width: calc(100% - calc(var(--menu-lanesize, 1rem) * 2));
	margin-top: var(--menu-padding, 0.15rem);
	margin-left: auto;
	padding: var(--menu-panel-padding, 1rem);
	background: var(--menu-panel-background, white);
	border-radius: var(--menu-panel-border-radius, 0);
	box-shadow: var(--menu-panel-box-shadow, none);
	backdrop-filter: var(--menu-panel-backdrop-filter, none);
	--webkit-backdrop-filter: var(--menu-panel-backdrop-filter, none);
}

:host([theme="concrete"][sticky]) [part="panel"] {
	top: 100%;
}

:host([theme="concrete"][lefty]) [part="panel"] {
	margin-left: unset;
	margin-right: auto;
}

`,mi=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},bi=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},vi=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};class gi extends CustomEvent{constructor(e){super("menuPanelChange",{detail:e,bubbles:!0})}}let wi=class extends ei{constructor(){super(...arguments),ui.set(this,!1),this.theme="",this.lefty=!1,this.open=!1,hi.set(this,(()=>{bi(this,ui,"f")&&(this.toggle(),this.shadowRoot.querySelector("button").focus())}))}toggle(e=!this.open){this.open=e;const t=new gi({open:e});this.dispatchEvent(t),this.onMenuPanelChange&&this.onMenuPanelChange(t)}updated(e){const t=!!pi(this.shadowRoot.querySelector('slot[name="panel"]')).length;bi(this,ui,"f")!==t&&(vi(this,ui,t,"f"),this.requestUpdate())}render(){return pt`
			<button
				part=button
				tabindex=${bi(this,ui,"f")?0:-1}
				@click=${bi(this,hi,"f")}>
					<slot part=buttoncontent></slot>
			</button>
			<slot name=panel part=panel></slot>
		`}};ui=new WeakMap,hi=new WeakMap,mi([jt({type:String,reflect:!0})],wi.prototype,"theme",void 0),mi([jt({type:Boolean,reflect:!0})],wi.prototype,"lefty",void 0),mi([jt({type:Boolean,reflect:!0})],wi.prototype,"open",void 0),wi=mi([zt(fi)],wi);var yi,xi,$i,ki,Oi,Si,Ai,Pi,Ci=je`

.system {
	position: static;
	margin: var(--menu-margin, auto);
}

:host([theme="concrete"]) .system {
	display: flex;
	align-items: flex-end;
	justify-content: flex-end;
}

:host([theme="concrete"][sticky]) .system {
	pointer-events: none;
	position: absolute;
	width: 100%;
	right: 0;
}

:host([theme="concrete"][sticky]) .system > * {
	pointer-events: all;
}

:host([theme="concrete"][lefty]) .system {
	right: auto;
	left: 0;
	align-items: flex-start;
	justify-content: flex-start;
}

:host([theme="concrete"]) [part="blanket"] {
	z-index: 99;
	display: none;
	position: fixed;
	background: var(--menu-blanket-background, rgba(0,0,0, 0.5));
	backdrop-filter: var(--menu-blanket-backdrop-filter, blur(5px));
	--webkit-backdrop-filter: var(--menu-blanket-backdrop-filter, blur(5px));
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
}

:host([theme="concrete"][active]) [part="blanket"] {
	display: block;
}

:host([theme="concrete"]) [part="list"] {
	z-index: 100;
	display: flex;
	align-items: flex-end;
	justify-content: flex-end;
	padding: var(--menu-padding, 0.15rem);
	background: var(--menu-background, rgba(240, 240, 240, 0.5));
	border-radius: var(--menu-border-radius, 0);
}

:host([theme="concrete"][sticky]) [part="list"] {
	margin-right: var(--menu-lanesize, 1rem);
}

:host([theme="concrete"][sticky][lefty]) [part="list"] {
	margin-right: unset;
	margin-left: var(--menu-lanesize, 1rem);
}

:host([theme="concrete"]) [part="list"] slot::slotted(menu-item) {
	display: block;
	flex: 0 0 auto;
}

`,Ii=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},Mi=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},Ei=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};let Ri=class extends ei{constructor(){super(...arguments),yi.add(this),this.theme="concrete",this.active=!1,this.sticky=!1,this.lefty=!1,xi.set(this,W({activeIndex:void 0,scrollTop:0})),$i.set(this,(()=>{})),ki.set(this,["scroll","resize"]),Oi.set(this,(()=>{var e,t;this.active||(Mi(this,xi,"f").state.scrollTop=this.sticky&&null!==(t=null!==(e=window.scrollY)&&void 0!==e?e:window.pageYOffset)&&void 0!==t?t:0)})),Si.set(this,(()=>{const e=this.getMenuItems();for(const t of e)t.toggle(!1)})),Pi.set(this,(({target:e,detail:{open:t}})=>{const i=this.getMenuItems();t&&Mi(this,yi,"m",Ai).call(this,e,i),this.active=!!i.find((e=>e.open)),Mi(this,Oi,"f").call(this)}))}createRenderRoot(){const e=super.createRenderRoot();return e.addEventListener("slotchange",(()=>this.requestUpdate())),e}connectedCallback(){super.connectedCallback(),Ei(this,$i,Mi(this,xi,"f").track((()=>this.render()),(()=>this.requestUpdate())),"f"),Mi(this,Oi,"f").call(this);for(const e of Mi(this,ki,"f"))window.addEventListener(e,Mi(this,Oi,"f"))}disconnectedCallback(){super.disconnectedCallback(),Mi(this,$i,"f").call(this),Ei(this,$i,(()=>{}),"f");for(const e of Mi(this,ki,"f"))window.removeEventListener(e,Mi(this,Oi,"f"))}getMenuItems(){return pi(this.shadowRoot.querySelector("slot")).filter((e=>e instanceof wi))}updated(){for(const e of this.getMenuItems())e.theme=this.theme}render(){const{scrollTop:e,activeIndex:t}=Mi(this,xi,"f").state;return pt`
			<div class=system data-active-index=${t} style="${`top: ${e}px`}">
				<div part=blanket @click=${Mi(this,Si,"f")}></div>
				<div part=list @menuPanelChange=${Mi(this,Pi,"f")}>
					<slot></slot>
				</div>
			</div>
		`}};xi=new WeakMap,$i=new WeakMap,ki=new WeakMap,Oi=new WeakMap,Si=new WeakMap,Pi=new WeakMap,yi=new WeakSet,Ai=function(e,t){const i=t.filter((t=>t!==e));for(const e of i)e.open=!1},Ii([jt({type:String,reflect:!0})],Ri.prototype,"theme",void 0),Ii([jt({type:Boolean,reflect:!0})],Ri.prototype,"active",void 0),Ii([jt({type:Boolean,reflect:!0})],Ri.prototype,"sticky",void 0),Ii([jt({type:Boolean,reflect:!0})],Ri.prototype,"lefty",void 0),Ri=Ii([zt(Ci)],Ri);var Ti=je`

:host {
	display: inline-block;
	width: var(--avatar-size, 2em);
	height: var(--avatar-size, 2em);
	border-radius: var(--avatar-border-radius, 0.3em);
	overflow: hidden;
	user-select: none;
}

.avatar {
	display: block;
	width: 100%;
	height: 100%;
	color: var(--xio-avatar-color, #444);
	background: var(--xio-avatar-background, #888);
}

.avatar[data-logged-in] {
	color: #fff;
}

svg, img {
	pointer-events: none;
	display: block;
	width: 100%;
	height: 100%;
	object-fit: cover;
}

`,_i=ut`<svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill="currentColor" fill-rule="evenodd" d="M12 14.002a.998.998 0 0 1-.998.998H1.001A1 1 0 0 1 0 13.999V13c0-2.633 4-4 4-4s.229-.409 0-1c-.841-.62-.944-1.59-1-4 .173-2.413 1.867-3 3-3s2.827.586 3 3c-.056 2.41-.159 3.38-1 4-.229.59 0 1 0 1s4 1.367 4 4v1.002z"/></svg>`;function ji(e,t,i){return e<t?t:e>i?i:e}function Di(e,t,i){return`hsl(${e%360}, ${ji(t,0,100)}%, ${ji(i,0,100)}%)`}var qi=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let Ui=class extends ei{renderBlankAvatar(e){return pt`
			<div class=avatar>
				${_i}
			</div>
		`}renderSimpleAvatar({value:e}){const{color1:t,color2:i,color3:o}=function(e){const t=Math.ceil(360*e),i=(t-30)%360,o=(t+30)%360;return{color1:Di(t,100,90),color2:Di(i,50,60),color3:Di(o,50,40)}}(e);return pt`
			<div class=avatar style=${`color: ${t}; background: linear-gradient(to bottom right, ${i}, ${o});`}>
				${_i}
			</div>
		`}renderImageAvatar({link:e}){return pt`
			<div class=avatar>
				<img src="${e}" alt=""/>
			</div>
		`}render(){const{spec:e={type:"blank"}}=this;switch(e.type){case"blank":return this.renderBlankAvatar(e);case"simple":return this.renderSimpleAvatar(e);case"image":return this.renderImageAvatar(e);default:return pt`avatar missing`}}};qi([jt({type:Object})],Ui.prototype,"spec",void 0),Ui=qi([zt(Ti)],Ui);var Ni=je`

:host {
	display: inline-block;
	width: max-content;
	height: max-content;
	--_padding: var(--xio-button-padding, 0.2em 0.5em);
	--_background: var(--xio-button-background, transparent);
	--_border: var(--xio-button-border, 1px solid);
	--_border-radius: var(--xio-button-border-radius, 0);
	--_opacity: var(--xio-button-opacity, 0.7);
	--_hover-opacity: var(--xio-button-hover-opacity, 1);
	--_hover-color: var(--xio-button-hover-color, inherit);
	--_hover-background: var(--xio-button-hover-background, var(--_background));
	--_disabled-opacity: var(--xio-button-disabled-opacity, 0.2);
	--_disabled-border-style: var(--xio-button-disabled-border-style, dashed);
}

button {
	width: 100%;
	height: 100%;
	cursor: pointer;
	font: inherit;
	color: inherit;
	padding: var(--_padding);
	font-weight: bold;
	background: var(--_background);
	border: var(--_border);
	border-radius: var(--_border-radius);
	opacity: var(--_opacity);
}

button:not([disabled]):hover,
button:not([disabled]):focus {
	opacity: var(--_hover-opacity);
	color: var(--_hover-color);
	background: var(--_hover-background);
}

button[disabled] {
	cursor: default;
	opacity: var(--_disabled-opacity);
	border-style: var(--_disabled-border-style);
}

`;class zi extends CustomEvent{constructor(e){super("press",{detail:e})}}var Li=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let Bi=class extends ei{constructor(){super(...arguments),this.disabled=!1,this.handleClick=()=>{const e=new zi(this);this.onpress&&this.onpress(e),this.disabled||this.dispatchEvent(e),e.stopPropagation()}}focus(){this.shadowRoot.querySelector("button").focus()}render(){return pt`
			<button
				part=button
				@click=${this.handleClick}
				?disabled=${this.disabled}>
					<slot part=button-slot></slot>
			</button>
		`}};Li([jt({type:Boolean,reflect:!0})],Bi.prototype,"disabled",void 0),Li([jt({type:Function})],Bi.prototype,"onpress",void 0),Bi=Li([Bt,zt(Ni)],Bi);var Vi=je`

.example {
	color: #f90;
}

`,Wi=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let Hi=class extends ei{render(){return pt`
			<div class=example>
				<p>xio-example</p>
				<slot></slot>
			</div>
		`}};Hi=Wi([zt(Vi)],Hi);var Fi=je`

* {box-sizing: border-box;}

:host {
	display: inline-block;
	vertical-align: middle;
	color: white;
}

:host([disabled]) {
	opacity: 0.25;
}

button {
	display: inline-block;
	border: unset;
	color: unset;
	background: unset;
}

button {
	position: relative;
	width: 1.5em;
	height: 1.5em;
	background: #3338;
	box-shadow: inset 1px 2px 3px #000a;
	border-radius: 0.5em;
	border: 1px solid #fff4;
}

button[data-mode="ready"] {
	cursor: pointer;
}

button[data-mode="ready"]:hover,
button[data-mode="ready"]:focus {
	background: #5558;
	border: 1px solid #fff8;
}

button > span {
	display: inline-block;
}

button svg {
	width: 100%;
	height: 100%;
}

button .error {
	display: inline-block;
	position: absolute;
	top: 80%;
	left: 0;
	width: max-content;
	max-width: 16em;
	color: red;
	background: #200a;
	text-shadow: 1px 2px 3px #0008;
	text-align: left;
	padding: 0.2em 0.5em;
	border-radius: 0.5em;
	pointer-events: none;
}

button[data-mode="loading"] svg,
button[data-mode="error"] svg {
	padding: 10%;
}

button[data-mode="error"] svg {
	color: red;
	animation: fade 1s ease infinite alternate;
}

button[data-mode="loading"] svg {
	animation:
		spin 10s linear infinite,
		fade 500ms ease infinite alternate;
}

@keyframes spin {
	from { transform: rotate(0deg); }
	to { transform: rotate(360deg); }
}

@keyframes fade {
	from { opacity: 1.0; }
	to { opacity: 0.5; }
}

`;class Xi extends CustomEvent{constructor(e){super("press",{detail:e})}}var Qi=ut`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check"><polyline points="20 6 9 17 4 12"></polyline></svg>`,Ji=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let Ki=class extends ei{constructor(){super(...arguments),this.loading=M.none(),this["initially-checked"]=!1,this["error-message"]="error",this.disabled=!1,this.handleClick=()=>{if(!this.disabled){this.toggle();const e=document.activeElement;e&&e.blur()}}}init(){this.loading=M.ready(this["initially-checked"])}get checked(){return M.value(this.loading)}set checked(e){this.loading=M.ready(e)}async toggle(e=M.value(this.loading),t=!0){const i=!e,o=!this.disabled,n=M.isReady(this.loading);return o&&n?M.operation({setOp:e=>this.loading=e,errorReason:this["error-message"],promise:(async()=>{var e;if(await(null!==(e=this.save)&&void 0!==e?e:async()=>{})(i),t){const e=new Xi(this);this.oncheck&&this.oncheck(e),this.dispatchEvent(e),e.stopPropagation()}return i})()}):i}render(){return pt`
			<button
				data-mode="${M.mode(this.loading)}"
				?data-checked=${M.value(this.loading)}
				@click=${this.handleClick}>
					${M.select(this.loading,{none:()=>null,loading:()=>li,error:e=>pt`${si}<div class=error>${e}</div>`,ready:e=>e?Qi:null})}
			</button>
		`}};Ji([jt()],Ki.prototype,"loading",void 0),Ji([jt({type:Boolean})],Ki.prototype,"initially-checked",void 0),Ji([jt({type:String})],Ki.prototype,"error-message",void 0),Ji([jt({type:Boolean,reflect:!0})],Ki.prototype,"disabled",void 0),Ji([jt({type:Function})],Ki.prototype,"oncheck",void 0),Ji([jt({type:Function})],Ki.prototype,"save",void 0),Ki=Ji([Bt,zt(Fi)],Ki);var Yi=je`

/* * { outline: 1px solid #f002; } */

:host {
	display: block;
	width: 100%;
	max-width: 48rem;
	--height: var(--xio-text-input-height, 5rem);
	--pad: var(--xio-text-input-pad, 0.2em);
	--font: var(--xio-text-input-font, inherit);
	--color: var(--xio-text-input-color, inherit);
	--label-font: var(--xio-text-input-label-font, inherit);
	--label-color: var(--xio-text-input-label-color, inherit);
	--problems-font: var(--xio-text-input-problems-font, inherit);
	--problems-color: var(--xio-text-input-problems-color);
	--background: var(--xio-text-input-background, transparent);
	--valid-color: var(--xio-text-input-valid-color, #00ff8c);
	--invalid-color: var(--xio-text-input-invalid-color, #ff6100);
	--border: var(--xio-text-input-border, 1px solid);
	--border-radius: var(--xio-text-input-border-radius, 0.3em);
}

:host([disabled]) [part="inputbox"] {
	opacity: 0.4;
}

:host([hidden]) {
	display: none;
}

label {
	font: var(--label-font);
	color: var(--label-color);
}

slot {
	display: block;
	padding: 0 var(--pad);
}

.flexy {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
}

.flexy > * {
	flex: 0 0 auto;
}

:host([textarea]) .flexy {
	flex-direction: column;
}

[part="inputbox"] {
	display: block;
	/* max-width: var(--width); */
	position: relative;
	flex: 1 1 auto;
}

:host([textarea]) [part="inputbox"] {
	flex: 1 1 auto;
	/* max-width: unset; */
}

[part="inputbox"] svg {
	position: absolute;
	display: block;
	top: var(--pad);
	right: var(--pad);
	width: 1.2em;
	height: 1.2em;
	pointer-events: none;
}

.container[data-valid] [part="inputbox"] svg {
	color: var(--valid-color);
}

.container:not([data-valid]) [part="inputbox"] svg {
	color: var(--invalid-color);
}

#textinput {
	min-width: 1em;
	width: 100%;
	font: var(--font);
	padding: var(--pad);
	padding-right: calc(1em + calc(2 * var(--pad)));
	margin: 0;
	color: var(--color);
	background: var(--background);
	border: var(--border);
	border-radius: var(--border-radius);
	text-overflow: ellipsis;
}

textarea {
	min-height: var(--height);
}

[part="problems"] {
	display: flex;
	font: var(--problems-font);
	padding: 0 calc(2 * var(--pad));
	flex-direction: column;
	justify-content: flex-start;
	flex: 1 1 auto;
	/* min-width: 12rem; */
	list-style: none;
	color: var(--problems-color, var(--invalid-color));
}

[part="problems"] > li {
	margin-top: 0.2em;
}

`,Zi=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-check-circle"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><path d="M22 4L12 14.01l-3-3"/></svg>`;function Gi(e){return e}class eo extends CustomEvent{constructor(){super("enterpress",{bubbles:!0,composed:!0,detail:void 0})}}class to extends CustomEvent{constructor(e){super("valuechange",{bubbles:!0,composed:!0,detail:{value:e}})}}var io=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let oo=class extends ei{constructor(){super(...arguments),this.initial="",this.readonly=!1,this.textarea=!1,this["hide-validation"]=!1,this["show-validation-when-empty"]=!1,this.disabled=!1,this.placeholder="",this.hidden=!1,this.parser=Gi,this.problems=[],this.onvaluechange=()=>{},this.onenterpress=()=>{},this.draft="",this.lastDraft="",this.vettedLength=0,this.dispatchValueChange=()=>{const{draft:e,lastDraft:t}=this;e!==t&&(this.vettedLength=e.length,this.dispatchEvent(new to(this.value))),this.lastDraft=e},this.dispatchValueChangeDebounced=q(250,this.dispatchValueChange),this.dispatchEnterPress=()=>{this.dispatchEvent(new eo)},this.updateDraft=()=>{this.draft=this.input.value},this.handleInputKeyPress=e=>{if("Enter"===e.key){const t=this.textarea,i=e.shiftKey,o=()=>{this.updateDraft(),this.dispatchValueChange(),this.dispatchEnterPress(),e.preventDefault()};t?i&&o():o()}},this.handleInput=()=>{this.updateDraft(),this.dispatchValueChangeDebounced()},this.handleChange=()=>{this.updateDraft(),this.dispatchValueChange()}}get input(){return this.shadowRoot?this.shadowRoot.querySelector("#textinput"):void 0}focus(){this.input&&this.input.focus()}get value(){var e;const{draft:t}=this,i=(null!==(e=this.parser)&&void 0!==e?e:Gi)(t);return this.problems=this.validator?this.validator(i):[],0===this.problems.length?i:void 0}get text(){return this.draft}set text(e){const{input:t}=this;t?(this.input.value=e,this.updateDraft(),this.dispatchValueChange()):this.initial=e}init(){const{initial:e}=this;this.draft=e,this.lastDraft=e,this.text=e,this.addEventListener("valuechange",this.onvaluechange),this.addEventListener("enterpress",this.onenterpress),this.dispatchValueChange()}render(){const{readonly:e,disabled:t,problems:i,vettedLength:o,placeholder:n,textarea:r,validator:a,handleInput:s,handleInputKeyPress:l,handleChange:c}=this,d=0===i.length,p=!this["hide-validation"]&&!e&&a&&(!!this["show-validation-when-empty"]||0!==o);return pt`
			<div class=container ?data-valid=${d}>
				<label for=textinput part=label><slot></slot></label>
				<div class=flexy>
					<div part=inputbox>
						${p?p?d?Zi:si:null:null}
						${r?pt`
							<textarea
								id=textinput
								part=textinput
								?disabled=${t}
								?readonly=${e}
								tabindex=${e?"-1":"0"}
								placeholder=${n}
								@input=${s}
								@keypress=${l}
								@change=${c}
							></textarea>
						`:pt`
							<input
								id=textinput
								type=text
								part=textinput
								?disabled=${t}
								?readonly=${e}
								tabindex=${e?"-1":"0"}
								placeholder=${n}
								@input=${s}
								@keypress=${l}
								@change=${c}
								/>
						`}
					</div>
					<ol part=problems>
						${p&&!d?i.map((e=>pt`
								<li>${e}</li>
							`)):null}
					</ol>
				</div>
			</div>
		`}};function*no(e){function t(e,i){let o=[];const[n,r,a]=e,s=i?`${i} ${n}`.replaceAll(/(\s+)*(\^)/gm,""):n;const l=Object.entries(r);if(l.length>0){const e=l.map((([e,t])=>`\t${e}: ${ro(t)};`)).join("\n");o.push(`${ro(s)} {\n${e}\n}`)}for(const e of a)o=[...o,...t(e,s)];return o}yield"\n";for(const i of e)yield"\n"+t(i,void 0).join("\n");yield"\n"}function ro(e){return e.replaceAll(/(\s*)(\/\/.*)$/gm,"")}var ao;io([jt({type:String,reflect:!0})],oo.prototype,"initial",void 0),io([jt({type:Boolean,reflect:!0})],oo.prototype,"readonly",void 0),io([jt({type:Boolean,reflect:!0})],oo.prototype,"textarea",void 0),io([jt({type:Boolean,reflect:!0})],oo.prototype,"hide-validation",void 0),io([jt({type:Boolean,reflect:!0})],oo.prototype,"show-validation-when-empty",void 0),io([jt({type:Boolean,reflect:!0})],oo.prototype,"disabled",void 0),io([jt({type:String,reflect:!0})],oo.prototype,"placeholder",void 0),io([jt({type:Boolean,reflect:!0})],oo.prototype,"hidden",void 0),io([jt({type:Function})],oo.prototype,"parser",void 0),io([jt({type:Function})],oo.prototype,"validator",void 0),io([jt({type:Object})],oo.prototype,"problems",void 0),io([jt({type:String})],oo.prototype,"text",null),io([jt({type:String})],oo.prototype,"draft",void 0),oo=io([Bt,zt(Yi)],oo),function(e){var t;(t=e.Type||(e.Type={}))[t.Open=0]="Open",t[t.Close=1]="Close",t[t.RuleName=2]="RuleName",t[t.RuleValue=3]="RuleValue",t[t.SlashSlashComment=4]="SlashSlashComment"}(ao||(ao={}));class so extends Error{constructor(){super(...arguments),this.name=this.constructor.name}}class lo extends so{constructor(e){super(e>1?`missing ${e} closing braces "}"`:`missing ${e} closing brace "}"`)}}class co extends so{constructor(e,t){super(`(${e.cursor.line}:${e.cursor.column}) ${t}`),this.trace=e}}class po extends co{constructor(e){super(e,"expression is missing selector")}}class uo extends co{constructor(e){super(e,'unwanted closing brace "}"')}}class ho extends co{constructor(e,t){super(e,`invalid place for rule name "${t}"`)}}class fo extends co{constructor(e,t){super(e,`invalid place for rule value "${t}"`)}}const mo=e=>({error:t=>new co(e,t),missingSelector:()=>new po(e),excessClosingBrace:()=>new uo(e),ruleNamePlacement:t=>new ho(e,t),ruleValuePlacement:t=>new fo(e,t)});const bo=/(\s*)/my;function vo(e,t,i){const o=(/\n/g.exec(e)??[]).length,n=t.line+o;let r=0;if(o>0){const[,t]=/\n(.*)$/.exec(e)??[];r=1+t.length}else r=t.column+(i-t.index);return{line:n,column:r,index:i}}function go({index:e,cursor:t,leadingWhitespace:i}){return o=>{const n=vo(i,t,t.index+i.length);return{cursor:n,length:o??e-n.index}}}function wo(e,t){return(i,o)=>{let n=o.index;const r=e=>n=e,a=function({source:e,index:t,setIndex:i}){bo.lastIndex=t;const o=bo.exec(e.code);o&&i(bo.lastIndex);const[,n=""]=o??[];return n}({source:i,index:n,setIndex:r}),s=function({source:e,regex:t,index:i,setIndex:o}){t.lastIndex=i;const n=t.exec(e.code);return n&&o(t.lastIndex),n}({source:i,regex:e,index:n,setIndex:r});return s?{newIndex:n,token:t(s,go({index:n,cursor:o,leadingWhitespace:a}))}:void 0}}const yo={slashSlashComment:wo(/(\/\/.*)$/my,((e,t)=>{const[,i]=e,o=i.trim();return{type:ao.Type.SlashSlashComment,trace:t(o.length),value:o}})),open:wo(/([^{};]*){/my,((e,t)=>{const[,i]=e,o=i.trim();return{type:ao.Type.Open,trace:t(o.length),selector:i.trim()}})),close:wo(/}/my,((e,t)=>({type:ao.Type.Close,trace:t(1)}))),ruleName:wo(/([\S]+):/my,((e,t)=>{const[,i]=e,o=i.trim();return{type:ao.Type.RuleName,trace:t(o.length),name:o}})),ruleValue:wo(/([^;}]+)(;|(?=}))/my,((e,t)=>{const[,i]=e,o=i.trim();return{type:ao.Type.RuleValue,trace:t(o.length),value:o}}))};function xo(e){const t=function*(e){let t;const i=[];for(const o of e){const n=mo(o.trace);switch(o.type){case ao.Type.Open:t={selector:o.selector.replaceAll(/\s+/gm," "),ruleName:void 0,rules:{},childFrames:[]},i.push(t);break;case ao.Type.RuleName:if(!t)throw n.ruleNamePlacement(o.name);t.ruleName=o.name;break;case ao.Type.RuleValue:if(!t||!t.ruleName)throw n.ruleValuePlacement(o.value);t.rules[t.ruleName]=o.value,t.ruleName=void 0;break;case ao.Type.Close:{const r=i.pop(),a=i.length>0?i[i.length-1]:void 0;if(t=a,!r)throw n.excessClosingBrace();if(!r.selector)throw n.missingSelector();if(a)a.childFrames.push(r);else{function s(e){return[e.selector,e.rules,e.childFrames.map(s)]}yield s(r)}}}}if(i.length>0)throw new lo(i.length)}(function*(e){const t={code:e};let i=!1,o={index:0,line:1,column:1};for(;!i;){let e;for(const i of Object.values(yo)){let n=i(t,o);if(n){e=n.token,o=vo(t.code.slice(o.index,n.newIndex),o,n.newIndex);break}}e?yield e:i=!0}}(e));return[...no(t)].join("")}function $o(e,...t){const i=xo(Array.from(e).reduce(((e,i,o)=>e+i+(t[o]??"")),""));return _e(i)}var ko,Oo,So,Ao,Po,Co,Io,Mo,Eo=$o`

:host {
	display: block;
	width: 100%;
	max-width: 48rem;
	--pad: var(--xio-price-input-pad, 0.2em);
	--font: var(--xio-price-input-font, inherit);
	--color: var(--xio-price-input-color, inherit);
	--font-size: var(--xio-price-input-button-font-size, 1.5rem);
	--svg-height: var(--xio-price-input-height, 1.2em);
	--label-font: var(--xio-price-input-label-font, inherit);
	--label-color: var(--xio-price-input-label-color, inherit);
	--pad-problems: var(--xio-price-input-problems-padding, 1.7em);
	--problems-font: var(--xio-price-input-problems-font, inherit);
	--problems-color: var(--xio-price-input-problems-color);
	--background: var(--xio-price-input-background, transparent);
	--valid-color: var(--xio-price-input-valid-color, #00ff8c);
	--invalid-color: var(--xio-price-input-invalid-color, #ff6100);
	--border: var(--xio-price-input-border, 1px solid);
	--border-radius: var(--xio-price-input-border-radius, 0.3em);
}

.container {
	display: flex;
	flex-direction: column;

	label {
		font: var(--label-font);
		color: var(--label-color);
		slot {
			display: block;
			padding: 0 var(--pad);
		}
	}

	svg {
		width: var(--svg-height);
		height: var(--svg-height);
		pointer-events: none;
	}

	ul {
		font: var(--problems-font);
		list-style-type: none;
		padding-left: var(--pad-problems);
		color: var(--problems-color, var(--invalid-color));
	}
}

.inner__container{
	display: flex;
	align-items: center;
	gap: 0.5rem;

	button {
		display: flex;
		font-size: var(--font-size);
		color: var(--color);
		opacity: 0.4;
		background: var(--background);
		cursor: pointer;
		border: none;
		user-select: none;
		transition: all 0.2s ease-in 0s;
	
		^:is(:hover, :focus) {
			opacity: 1;
			outline: none;
		}
	}

	.decrement:active {
		opacity: 0.6;
		transform: translateY(2px);
	}

	.increment:active {
		opacity: 0.6;
		transform: translateY(-2px);
	}
}

.price__input__parent {
	display: flex;
	align-items: center;
	gap: 0.2rem;
	padding: var(--pad) calc(2 * var(--pad));
	border-radius: var(--border-radius);
	border: var(--border);

	input {
		font: var(--font);
		font-size: 1.5rem;
		text-align: right;
		border: none;
		padding: 0;
		background: var(--background);
		color: var(--color);

		^:is(:focus, :active) {
			outline: 0;
		}
	}

	.symbol, .currency {
		font-size: 1rem;
		opacity: 0.4;
		user-select: none;
		text-transform: uppercase;
	}

	.currency {
		margin-left: 0.5em;
	}

	^[data-valid] svg {
		color: var(--valid-color);
	}

	^:not([data-valid]) svg {
		color: var(--invalid-color);
	}
}

.focussed {
	outline: 2px solid cyan;
}

input::-webkit-inner-spin-button {
	-webkit-appearance: none;
}
`,Ro=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"></polyline></svg>`,To=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>`,_o=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},jo=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};!function(e){e[e.INCREMENT=0]="INCREMENT",e[e.DECREMENT=1]="DECREMENT"}(Mo||(Mo={}));let Do=class extends ei{constructor(){super(...arguments),ko.add(this),this.min=1,this.max=10,this.step="0.5",this["initial-value"]="",this.currency="USD",this.symbol="$",this.problems=[],this.valid=!0,this.showValidation=!1,Oo.set(this,(()=>{this.inputParent.classList.add("focussed")})),So.set(this,(()=>{this.inputParent.classList.remove("focussed")})),Ao.set(this,(()=>{const{input:e}=this,t=e.value.length>1?e.value.length:3;e.style.width=`${t+.4}ch`})),Po.set(this,(e=>{this.showValidation=!0,this.problems=this.validator?this.validator(Number(e)):[],this.valid=this.problems.length<1})),Io.set(this,(e=>{const t=e.target;this.inputValue=t.value,jo(this,Po,"f").call(this,this.inputValue),jo(this,Ao,"f").call(this),this.dispatchEvent(new to(this.inputValue))}))}get input(){return this.shadowRoot?this.shadowRoot.querySelector("#price"):void 0}get inputParent(){return this.shadowRoot?this.shadowRoot.querySelector(".price__input__parent"):void 0}get value(){return this.valid?this.inputValue:void 0}init(){this.inputValue=this["initial-value"]}render(){const{symbol:e,currency:t,inputValue:i,readonly:o,valid:n,showValidation:r,problems:a}=this,s=this["initial-value"]?this["initial-value"].length:4,l=r?n?Zi:si:null;return pt`
			<div class="container">
				<label for="price" part="label"><slot></slot></label>
				<div class="inner__container">
					<button
						?disabled=${o}
						@click=${()=>jo(this,ko,"m",Co).call(this,Mo.DECREMENT)}
						class="decrement">
						${To}
					</button>
					<div class="price__input__parent" tabindex="-1" ?data-valid=${n}>
						<span class="symbol">${e}</span>
						<input
							?readonly=${o}
							@focus=${jo(this,Oo,"f")}
							@blur=${jo(this,So,"f")}
							@input=${jo(this,Io,"f")}
							.value=${i}
							type="number"
							id="price"
							style="width: ${s}ch"
							placeholder="0.00"
						/>
						${l}
						<span class="currency">${t}</span>
					</div>
					<button
						?disabled=${o}
						@click=${()=>jo(this,ko,"m",Co).call(this,Mo.INCREMENT)}
						class="increment">
						${Ro}
					</button>
				</div>
				<ul part=problems>
					${n?null:a.map((e=>pt`
							<li>${e}</li>
						`))}
				</ul>
			</div>
		`}};Oo=new WeakMap,So=new WeakMap,Ao=new WeakMap,Po=new WeakMap,Io=new WeakMap,ko=new WeakSet,Co=function(e){const{step:t,inputValue:i}=this;e===Mo.INCREMENT?this.inputValue=(Number(i)+Number(t)).toFixed(2):e===Mo.DECREMENT&&(this.inputValue=(Number(i)-Number(t)).toFixed(2)),jo(this,Po,"f").call(this,this.inputValue),jo(this,Ao,"f").call(this),this.dispatchEvent(new to(this.inputValue))},_o([jt({type:Number,reflect:!0})],Do.prototype,"min",void 0),_o([jt({type:Number,reflect:!0})],Do.prototype,"max",void 0),_o([jt({type:String,reflect:!0})],Do.prototype,"step",void 0),_o([jt({type:Boolean,reflect:!0})],Do.prototype,"readonly",void 0),_o([jt({type:String})],Do.prototype,"initial-value",void 0),_o([jt({type:String})],Do.prototype,"currency",void 0),_o([jt({type:String})],Do.prototype,"symbol",void 0),_o([jt({type:String})],Do.prototype,"inputValue",void 0),_o([jt({type:Object})],Do.prototype,"problems",void 0),_o([jt({type:Boolean})],Do.prototype,"valid",void 0),_o([jt({type:Boolean})],Do.prototype,"showValidation",void 0),_o([jt({type:Function})],Do.prototype,"validator",void 0),Do=_o([zt(Eo)],Do);class qo extends CustomEvent{constructor(e){super("nightlightChange",{detail:e,bubbles:!0})}}const Uo="nightlightSettings";var No,zo,Lo,Bo,Vo=je`

:host {
	display: inline-block;
	width: 2em;
	height: 2em;
}

button {
	display: block;
	font-size: inherit;
	color: inherit;
	background: transparent;
	border: none;
	width: 100%;
	height: 100%;

	Xtransform: scale(1);
	Xtransition: transform 200ms ease;
}

Xbutton:active {
	transform: scale(0.8);
}

slot {
	display: block;
	width: 100%;
	height: 100%;
}

slot svg, slot::slotted(svg) {
	display: block;
	width: 100%;
	height: 100%;
}

`,Wo=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>`,Ho=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>`,Fo=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},Xo=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};const Qo="data-nightlight";let Jo=class extends ei{constructor(){super(...arguments),No.add(this),this["show-destination-state"]=!1,this["title-to-night"]="turn down the lights",this["title-to-day"]="turn up the lights",this.sourceElement=document.documentElement,zo.set(this,{save(e){e?window.localStorage.setItem(Uo,JSON.stringify(e)):window.localStorage.removeItem(Uo)},load(){const e=window.localStorage.getItem(Uo);return e?JSON.parse(e):void 0}})}firstUpdated(){const e=Xo(this,zo,"f").load();e&&(this.night=e.night),window.addEventListener("nightlightChange",(e=>{e.target!==this&&this.requestUpdate()}))}get night(){return null!==this.sourceElement.getAttribute(Qo)}set night(e){Xo(this,zo,"f").save({night:e});e!==this.night&&(Xo(this,No,"m",Lo).call(this,e),this.requestUpdate(),Xo(this,No,"m",Bo).call(this))}toggle(e=!this.night){this.night=e}render(){const{night:e}=this,t=this["show-destination-state"]?!e:e;return pt`
			<button
				part=button
				title="${e?this["title-to-day"]:this["title-to-night"]}"
				?data-nightlight=${e}
				@click=${()=>this.toggle()}>
					${t?pt`
							<slot name=night>
								${Ho}
							</slot>
						`:pt`
							<slot name=day>
								${Wo}
							</slot>
						`}
			</button>
		`}};zo=new WeakMap,No=new WeakSet,Lo=function(e){e?this.sourceElement.setAttribute(Qo,""):this.sourceElement.removeAttribute(Qo)},Bo=function(){const e=new qo({night:this.night});this.dispatchEvent(e),this.onNightlightChange&&this.onNightlightChange(e)},Jo.NightlightChangeEvent=qo,Fo([jt({type:Boolean,reflect:!0})],Jo.prototype,"show-destination-state",void 0),Fo([jt({type:String,reflect:!0})],Jo.prototype,"title-to-night",void 0),Fo([jt({type:String,reflect:!0})],Jo.prototype,"title-to-day",void 0),Jo=Fo([zt(Vo)],Jo);var Ko=je`

:host {
	display: inline-block;
	--local-avatar-size: var(--avatar-size, 3em);
}

.container {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
}

xio-avatar {
	flex: 0 0 auto;
	margin-right: 0.4em;
	--avatar-size: var(--local-avatar-size);
}

.box {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
	flex: 1;
	flex-basis: 8em;
}

[part="nameplate"] {
	flex: 1 1 auto;
	margin-right: 1em;
	margin-bottom: 0.5em;
}

[part="details"] {
	margin-bottom: 0.5em;
}

.buttonbar {
	margin-top: 0.5em;
}

.cardplate > * {
	display: block;
}

.tags {
	list-style: none;
	font-size: 0.6em;
	cursor: default;
}

.tags > li {
	display: inline-block;
	margin: 0 0.1em;
	padding: 0 0.25em;
	border: 1px solid;
	border-radius: 1em;
}

[data-tag=staff] {
	color: var(--cobalt-tagcolor-staff, lime);
}

[data-tag=banned] {
	color: var(--cobalt-tagcolor-banned, red);
}

p[data-field=tagline] {
	opacity: 0.7;
	font-size: 0.7em;
	font-style: italic;
}

xio-text-input > span {
	opacity: 0.4;
	font-size: 0.7rem;
}

xio-text-input + xio-text-input {
	margin-top: 0.1em;
}

[part="details"] {
	font-size: 0.7em;
	list-style: none;
}

[part="details"] > li {
	margin-top: 0.2em;
}

[part="details"] > li > :first-child {
	font-weight: bold;
}

[part="details"] code {
	font-size: 0.6em;
	padding: 0.2em;
	border-radius: 0.3em;
	word-break: break-all;
	background: #0002;
}

.roles {
	font-size: 0.6em;
	list-style: none;
	padding: 0;
	margin-top: 0.3rem;
}

.roles li {
	display: inline-block;
	border: 1px solid;
	border-radius: 1em;
	padding: 0.1em 0.3em;
	line-height: 0.8em;
}

`;const Yo=e=>null!=e;function Zo(e,t){if(!Yo(e)||!Yo(t))return e===t;for(const[i,o]of Object.entries(e)){if(!t.hasOwnProperty(i))return!1;const e=t[i];switch(typeof o){case"object":if(!Zo(o,e))return!1;break;case"function":if(!Yo(e)||o.toString()!==e.toString())return!1;break;default:if(o!==e)return!1}}for(const[i]of Object.entries(e))if(!t.hasOwnProperty(i))return!1;for(const[i]of Object.entries(t))if(!e.hasOwnProperty(i))return!1;return!0}function Go({field:e,initial:t,text:i,input:o}){return o?pt`
			<xio-text-input
				data-field="${e}"
				initial="${t}"
				text="${i}"
				part="xiotextinput"
				exportparts="${"\n\t\t\t\t\tlabel: xiotextinput-label,\n\t\t\t\t\ttextinput: xiotextinput-textinput,\n\t\t\t\t\tproblems: xiotextinput-problems,\n\t\t\t\t"}"
				show-validation-when-empty
				?readonly=${o.readonly}
				?hide-validation=${!o.draftIsChanged}
				.validator=${o.validator}
				@valuechange=${o.onvaluechange}>
					<span>${o.label}</span>
			</xio-text-input>
		`:pt`
			<p part="textfield" data-field="${e}">${t}</p>
		`}function en(e){const t=new Date(e),i=e=>e.toString().padStart(2,"0"),o=i(t.getFullYear()),n=i(t.getMonth()+1),r=i(t.getDate()),a=t.getHours();let s=t.getHours();s%=12,s=s||12;const l=i(t.getMinutes()),c=a>=12?"pm":"am",d=-t.getTimezoneOffset(),p=(d/60).toFixed(d%60==0?0:1),u=0===d?"UTC":`UTC${d<0?"":"+"}${p}`,h=`${o}-${n}-${r}`,f=`${s}:${l} ${c}`,m=`${`${Intl.DateTimeFormat().resolvedOptions().timeZone} ${u}`}`;return{date:h,time:f,zone:m,full:`${h} ${f} (${m})`}}function tn(e){return{tagline:e.tagline,nickname:e.nickname}}function on(e,t){return M.isReady(e)?t(M.value(e)):null}function nn(e,t,i=null,{loadingMessage:o="",errorMessage:n="",hideErrorText:r=!1}={}){return pt`
		<xio-op
			.op=${e}
			loading-message="${o}"
			error-message="${n}"
			?hide-error-text=${r}>
				${on(e,t)}
				${i}
		</xio-op>
	`}function rn(...e){return t=>{let i=[];for(const o of e)if(i=o(t),i.length>0)break;return i}}function an(e){const t=Object.keys(e);return i=>Object.entries(i).flatMap((([i,o])=>t.includes(i)?e[i](o).map((e=>`"${i}": ${e}`)):[`"${i} not in schema"`]))}function sn(...e){return t=>{const i=e.map((e=>e(t)));let o=!1;for(const e of i)0===e.length&&(o=!0);return o?[]:i.flat().map(((e,t)=>t>0?`or, ${e}`:e))}}function ln(...e){return t=>{if(!Array.isArray(t))return["must be array"];const i=rn(...e),o=[];return t.forEach(((e,t)=>{for(const n of i(e))o.push(`(${t+1}) ${n}`)})),o}}const cn=e=>t=>t===e?[]:["wrong value"],dn=e=>t=>t.length<e?["too small"]:[],pn=e=>t=>t.length>e?["too big"]:[],un=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,hn=()=>e=>un.test(e)?[]:["invalid email"],fn={nickname:rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(1),pn(24),(e=>e.length>0&&0===e.trim().length?["can't be all whitespace"]:[])),tagline:rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(0),pn(32),(e=>e.length>0&&0===e.trim().length?["can't be all whitespace"]:[]))};var mn,bn=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},vn=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let gn=class extends ei{constructor(){super(...arguments),mn.set(this,W({busy:M.ready(void 0)})),this.profileDraft=void 0,this.problems=[],this.handleChange=q(200,(()=>{if(!this.user)return;const{profileDraft:e,isChanged:t}=this.generateNewProfileDraftFromInputs();this.profileDraft=t?e:void 0})),this.handleSave=async()=>{const{profileDraft:e}=this;await M.operation({promise:this.saveProfile(e).finally((()=>{this.profileDraft=null})),setOp:e=>vn(this,mn,"f").writable.busy=e}),this.requestUpdate(),await this.updateComplete;const t=(e,t)=>{this.shadowRoot.querySelector(`xio-text-input[data-field="${e}"]`).text=t};t("nickname",e.nickname),t("tagline",e.tagline)}}init(){this.addSubscription((()=>vn(this,mn,"f").subscribe((()=>this.requestUpdate()))))}get draftIsChanged(){return!!this.profileDraft}get readonly(){return!this.saveProfile}getTextInputField(e){return function(e,t=document){return t.querySelector(e)}(`xio-text-input[data-field="${e}"]`,this.shadowRoot)}generateNewProfileDraftFromInputs(){const{profile:e}=this.user,t=tn(e),i=this.getTextInputField("nickname");if(!i)return{profileDraft:t,isChanged:!1};const o=this.getTextInputField("tagline");t.nickname=i.value,t.tagline=o.value,this.problems=[...i.problems,...o.problems];return{profileDraft:t,isChanged:!Zo(tn(e),t)}}render(){const{user:e,draftIsChanged:t}=this;if(!e)return null;const i=e.profile.avatar;return nn(vn(this,mn,"f").readable.busy,(()=>pt`
			<div class=container ?data-readonly=${this.readonly}>
				<xio-avatar part=avatar .spec=${i}></xio-avatar>
				<div class=box>
					<div part=nameplate>
						${Go({field:"nickname",initial:this.profileDraft?this.profileDraft.nickname:e.profile.nickname,text:e.profile.nickname,input:this.readonly?void 0:{label:"nickname",readonly:!1,draftIsChanged:t,validator:fn.nickname,onvaluechange:this.handleChange}})}
						${Go({field:"tagline",initial:this.profileDraft?this.profileDraft.tagline:e.profile.tagline,text:e.profile.tagline,input:this.readonly?void 0:{label:"tagline",readonly:!1,draftIsChanged:t,validator:fn.tagline,onvaluechange:this.handleChange}})}
						${function(e){return pt`
		<ul class=roles>
			${e.roles.map((e=>pt`
				<li
					data-role-label="${e.label}"
					data-role-id="${e.roleId}">
						${e.label}
				</li>
			`))}
		</ul>
	`}(e)}
						${this.readonly?null:pt`
							<div class=buttonbar>
								<xio-button
									?disabled=${!this.profileDraft||this.problems.length>0}
									@press=${this.handleSave}>
										<slot name=save-button>save profile</slot>
								</xio-button>
							</div>
						`}
					</div>
					${this["show-details"]?function(e){return pt`
		<ul part=details>
			<li>
				<span>joined:</span>
				<span>${en(e.stats.joined).date}</span>
			</li>
			<li>
				<span>user id:</span>
				<span><xio-id id="${e.userId}"></xio-id></span>
			</li>
		</ul>
	`}(e):null}
				</div>
			</div>
		`))}};mn=new WeakMap,bn([jt({type:Boolean})],gn.prototype,"show-details",void 0),bn([jt({type:Object})],gn.prototype,"user",void 0),bn([jt({type:Object})],gn.prototype,"saveProfile",void 0),bn([jt({type:Object})],gn.prototype,"profileDraft",void 0),gn=bn([zt(Ko)],gn);var wn,yn,xn,$n,kn,On=$o`

:host {
	display: block;
	width: 100%;
	max-width: 48rem;
}

.card {
	display: flex;
	width: fit-content;
	margin: 0 auto;
}

.display {
	font-size: 1.2rem;
	display: flex;

	strong {
		font-size: 2em;
		line-height: 1;
	}

	.superscript {
		font-size: 1em;
		margin-top: 0.1em;
	}

	.symbol {
		opacity: 0.4;
		font-size: 1em;
		align-self: center;
		margin-right: 0.2em;
		user-select: none;
	}

	.currency {
		opacity: 0.4;
		font-size: 1em;
		margin-top: 0.1em;
		margin-left: 0.3em;
		user-select: none;
		text-transform: uppercase;
	}

	.vertical {
		font-size: 0.7em;
		text-orientation: upright;
		writing-mode: vertical-rl;
		text-align: center;
		letter-spacing: -0.2em;
	}
}
`,Sn=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},An=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let Pn=class extends ei{constructor(){super(...arguments),wn.add(this),this.symbol="$",this.currency="USD",this.value="9.50",$n.set(this,(()=>{const{cents:e,dollars:t}=An(this,wn,"m",xn).call(this);return pt`
			<strong>
				${`${t}.${e}`}
			</strong>
		`})),kn.set(this,(()=>{const{cents:e,dollars:t}=An(this,wn,"m",xn).call(this);return pt`
			<strong>${t}</strong>
			<span class="superscript">${e}</span>
		`}))}render(){const e=this["unit-superscript"],t=this["vertical-currency"],{symbol:i,currency:o}=this;return pt`
			<div class="card">
				<div class="display">
					<span class="symbol">${i}</span>
					${e?An(this,kn,"f").call(this):An(this,$n,"f").call(this)}
					<span class=${"currency "+(t?"vertical":"")}>
						${o}
					</span>
				</div>
			</div>
		`}};$n=new WeakMap,kn=new WeakMap,wn=new WeakSet,yn=function(e){return e.length>1?e:`0${e}`},xn=function(){const{value:e}=this,t=parseFloat(e),i=Math.floor(t),o=Math.round(t%1*100);return{dollars:i.toString(),cents:An(this,wn,"m",yn).call(this,o.toString())}},Sn([jt({type:String,reflect:!0})],Pn.prototype,"symbol",void 0),Sn([jt({type:String,reflect:!0})],Pn.prototype,"currency",void 0),Sn([jt({type:Boolean,reflect:!0})],Pn.prototype,"unit-superscript",void 0),Sn([jt({type:Boolean,reflect:!0})],Pn.prototype,"vertical-currency",void 0),Sn([jt({type:String})],Pn.prototype,"value",void 0),Pn=Sn([zt(On)],Pn);var Cn=je`

:host {
	display: block;
}

.app-list {
	margin-top: 2em;
	margin-bottom: 2em;
}

.app-list > xio-op {
	display: block;
	border: 1px solid #f00;
	margin-top: 0.5em;
	border: 1px solid #fff1;
	border-radius: 0.2em;
}

.app-list > xio-op[mode="loading"] {
	padding: 4em 2em;
}

.app > * + * {
	margin-top: 0.3em;
}

.app + .app {
	margin-top: 1.5em;
}

.app > * {
	padding: 0.4em 1rem;
}

.app-header {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
	justify-content: flex-end;
	padding: 0;
	background: #0001;
}

.app-header .title {
	max-width: 100%;
	flex: 1 0 auto;
	padding: 0.3em 1em;
}

.app-header .title h3 {
	font-size: 1.5em;
	font-weight: bold;
}

.app-header .title h3::before {
	content: "ðŸŒ";
	color: white;
}

.app-header .stats {
	display: flex;
	flex-direction: row;
	justify-content: center;
	flex-wrap: wrap;
	padding: 0.2em;
}

.app-header .stats [data-stat] {
	display: flex;
	flex-direction: column;
	justify-content: flex-end;
	max-width: 6em;
	text-align: center;
}

.app-header .stats [data-stat] > span {
	padding: 0.1em 0.6em;
}

.app-header .stats [data-stat] > span:nth-child(1) {
	justify-self: flex-start;
}

.app-header .stats [data-stat] > span:nth-child(2) {
	opacity: 0.3;
	font-size: 0.6em;
}

.twoside {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
}

.twoside > div {
	max-width: 100%;
	flex: 1 0 16em;
	padding-bottom: 1em;
}

.twoside > div:nth-child(1) {
	padding-right: 1rem;
}

.editside > .buttons {
	display: flex;
	justify-content: center;
	align-items: center;
}

.app-form > * + * {
	margin-top: 0.3em;
}

.app-form xio-button {
	margin-top: 0.6em;
}

.app-options {
	border: 1px solid #fff1;
	padding: 1em;
}

.app-options > * + * {
	margin-top: 3em;
}

code {
	display: inline-block;
	font-size: 0.8em;
	padding: 0.2em;
	border-radius: 0.3em;
	background: #0002;
	overflow-wrap: anywhere;
	word-break: break-all;
}

code.id {
	opacity: 0.7;
	font-size: 0.5em;
}

.codeblock {
	display: block;
}

.htmlcode { color: #fff6; }
.htmlcode [data-syntax=tag] { color: deepskyblue; }
.htmlcode [data-syntax=attr] { color: skyblue; }
.htmlcode [data-syntax=data] { color: #aaffa0; }
.htmlcode [data-syntax=indent] {
	display: block;
	margin-left: 1em;
}

.app-code > * {
	margin-top: 1em;
}

.app-code code {
	display: block;
	font-size: 0.6em;
	padding: 1em;
	margin: 0.5em 0;
}

.delete-app-button {
	display: block;
	text-align: right;
	--xio-button-hover-color: red;
}

${je`

.adminmanager .adminassigner {
	display: flex;
	flex-direction: row;
	margin: 0.5em 0;
}

.adminmanager .adminassigner > * {
	display: block;
}

.adminmanager .adminassigner > xio-text-input {
	flex: 1 1 auto;
}

.adminmanager .adminassigner > xio-text-input {
	width: 100%;
	max-width: 100%;
}

.adminmanager .adminassigner > xio-text-input::part(problems) {
	min-width: unset;
}

.adminmanager .adminassigner > xio-button {
	margin-top: 1.1em;
	margin-left: 0.3em;
}

.adminmanager .adminlist ul {
	list-style: none;
	padding: 0 1em;
	border: 1px solid #fff1;
}

.adminmanager .adminlist li {
	display: flex;
	flex-direction: row;
	align-content: center;
	padding: 0.3em 0;
	font-size: 0.8em;
}

.adminmanager .adminlist li + li {
	border-top: 1px solid #fff1;
}

.adminmanager .adminlist li > * {
	display: block;
}

.adminmanager .adminlist li > span {
	flex: 1 1 auto;
	display: flex;
	align-items: center;
	word-break: break-all;
}

.adminmanager .adminlist li > xio-button {
	color: #fff3;
}

`}

.app-list {
	margin-bottom: 5rem;
}

.app-registration {
	max-width: 40em;
	margin-bottom: 5em;
}

`;const In=e=>e.split("\n").map((e=>e.trim().toLowerCase())).filter((e=>e.length>0)),Mn=rn((e=>"string"!=typeof e?["must be a string"]:[]),pn(1e3),(e=>/^https?:\/\/[a-zA-Z\.\d-]+(?:|:\d+)$/i.test(e)?[]:["invalid origin"]),sn((e=>/^https:\/\//i.test(e)?[]:["must be secure, starting with 'https'"]),(e=>/^https?:\/\/(127\.0\.0\.1|localhost)(|:\d{1,5})(|\/\S*)$/i.test(e)?[]:["must be a localhost address"]))),En=Object.freeze({home:rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(1),pn(2e3),sn(rn((e=>{try{return new URL(e),[]}catch(e){return["invalid url"]}}),(e=>/^https:\/\//i.test(e)?[]:["must be secure, starting with 'https'"])),(e=>/^https?:\/\/(127\.0\.0\.1|localhost)(|:\d{1,5})(|\/\S*)$/i.test(e)?[]:["must be a localhost address"]))),label:rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(1),pn(50),(e=>e.length>0&&0===e.trim().length?["can't be all whitespace"]:[])),origins:rn(dn(1),pn(100),ln(Mn)),additionalOrigins:rn((e=>Array.isArray(e)?[]:["must be an array"]),dn(0),pn(99),ln(Mn))});function Rn({clearOnSubmit:e,submitButtonText:t,showAdditionalOrigins:i,initialValues:o={home:"",label:"",additionalOrigins:[]},query:n,submit:r,requestUpdate:a}){const s={problems:[],formDisabled:!1,draft:o,get valid(){return!this.formDisabled&&this.draft&&0===this.problems.length}};function l(){return{home:n('.app-form [data-form="home"]'),label:n('.app-form [data-form="label"]'),additionalOrigins:n('.app-form [data-form="additional-origins"]')}}const c=()=>{const{home:e,label:t,additionalOrigins:i}=l();var o;s.draft={home:e.value,label:t.value,additionalOrigins:i.value},s.problems=(o=s.draft,[...En.label(o.label),...En.home(o.home),...En.additionalOrigins(o.additionalOrigins)]),a()};function d(){s.problems=[],s.formDisabled||c()}async function p(){c(),s.formDisabled=!0,a();try{await r(s.draft),e?function(e){const t=l();t.home.text=e.home,t.label.text=e.label,t.additionalOrigins.text=e.additionalOrigins.join("\n")}(o={home:"",label:"",additionalOrigins:[]}):o=s.draft}finally{s.formDisabled=!1,a()}}return{render:function({partNamespace:e}){const{formDisabled:n,draft:r,problems:a}=s,l=!Zo(o,r),c=!l||n||a.length>0,u=`\n\t\t\tlabel: xiotextinput-label,\n\t\t\ttextinput: xiotextinput-textinput,\n\t\t\tproblems: xiotextinput-problems,\n\n\t\t\tlabel: ${e}-appform-xiotextinput-label,\n\t\t\ttextinput: ${e}-appform-xiotextinput-textinput,\n\t\t\tproblems: ${e}-appform-xiotextinput-problems,\n\t\t`,h=({hide:t,textarea:i,label:o,dataForm:r,initialText:a,showValidationWhenEmpty:s,parser:c,validator:p})=>pt`
			<xio-text-input
				?textarea=${i}
				part="${e}-appform-xiotextinput"
				exportparts="${u}"
				data-form="${r}"
				initial="${a}"
				?hidden=${t}
				?disabled=${n}
				?hide-validation=${!l}
				?show-validation-when-empty=${s}
				.parser=${c}
				.validator=${p}
				@valuechange=${d}>
					<span part=xio-text-input-label>
						${o}
					</span>
			</xio-text-input>
		`;return pt`
			<div class=app-form>
				<slot name=create-app-heading></slot>

				${h({hide:!1,textarea:!1,dataForm:"label",label:"community name",initialText:o.label,showValidationWhenEmpty:!1,parser:void 0,validator:En.label})}

				${h({hide:!1,textarea:!1,dataForm:"home",label:'website homepage, like "https://chasemoskal.com/"',initialText:o.home,showValidationWhenEmpty:!1,parser:void 0,validator:En.home})}

				${h({hide:!i,textarea:!0,dataForm:"additional-origins",label:"(optional) additional domain names",initialText:o.additionalOrigins.join("\n"),showValidationWhenEmpty:!0,parser:In,validator:En.additionalOrigins})}

				<xio-button
					class="create-app-button"
					?disabled=${c}
					@press=${p}>
						${t}
				</xio-button>
			</div>
		`}}}const Tn=rn((e=>"string"!=typeof e?["must be a string"]:[]),pn(256),hn());function _n({app:e,appEditService:t,query:i}){const{state:o,actions:n,subscribe:r}=function(){const e=W({admins:M.none(),assignerDraft:{email:void 0}}),t={setAdmins(t){e.writable.admins=t},setAssignerDraft(t){e.writable.assignerDraft=t}};return{subscribe:e.subscribe,state:e.readable,actions:t}}(),a=function({app:e,state:t,actions:i,appEditService:o}){const{appId:n}=e,r=(e=Promise.resolve(void 0))=>M.operation({promise:e.then((()=>o.listAdmins({appId:n}))),setOp:e=>i.setAdmins(e)});return{listAdmins:async function(){await r()},assignAdmin:async function(){const{email:e}=t.assignerDraft;i.setAssignerDraft({email:void 0}),await r(o.assignAdmin({appId:n,email:e}))},revokeAdmin:async function(e){await r(o.revokeAdmin({appId:n,userId:e}))}}}({app:e,state:o,actions:n,appEditService:t});function s(e){var t;const i=null!==(t=e.detail.value)&&void 0!==t?t:void 0;n.setAssignerDraft({email:i})}function l(){const e=i(".adminassigner xio-text-input");a.assignAdmin(),e.text=""}function c(){return pt`
			<div class=adminassigner>
				<xio-text-input
					part=adminmanager-xiotextinput
					exportparts="${"\n\t\t\tlabel: xiotextinput-label,\n\t\t\ttextinput: xiotextinput-textinput,\n\t\t\tproblems: xiotextinput-problems,\n\n\t\t\tlabel: adminmanager-xiotextinput-label,\n\t\t\ttextinput: adminmanager-xiotextinput-textinput,\n\t\t\tproblems: adminmanager-xiotextinput-problems,\n\t\t"}"
					.validator=${Tn}
					@valuechange=${s}>
						email
				</xio-text-input>
				<xio-button
					?disabled=${!o.assignerDraft.email}
					@press=${l}>
						grant
				</xio-button>
			</div>
		`}return{render:function(){return pt`
			${c()}
			${pt`
			<div class=adminlist>
				${nn(o.admins,(e=>pt`
					<ul>
						${e.map((({email:e,userId:t})=>pt`
							<li>
								<span>${e}</span>
								<xio-button @press=${()=>a.revokeAdmin(t)}>
									revoke
								</xio-button>
							</li>
						`))}
					</ul>
				`))}
			</div>
		`}
		`},controls:a,subscribe:r}}function jn(e){return{home:e.home,label:e.label,origins:(t=[new URL(e.home).origin,...e.additionalOrigins],[...new Set(t)])};var t}function Dn(){return function(e){const t=new Map;return function(i){let o;return t.has(i)?o=t.get(i):(o=e(i),t.set(i,o)),o}}}var qn=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let Un=class extends(Xt()(ei)){constructor(){super(...arguments),this.appRegistrationForm=Rn({clearOnSubmit:!0,showAdditionalOrigins:!1,submitButtonText:"create community",requestUpdate:()=>this.requestUpdate(),query:e=>this.shadowRoot.querySelector(".app-registration").querySelector(e),submit:async e=>{const t=jn(e);await this.share.appsModel.registerApp(t)}}),this.getAppState=Dn()((e=>{const t=this.share.appsModel.getApp(e),i=W({editMode:!1}),o={toggleEditMode(){i.writable.editMode=!i.writable.editMode}};return i.subscribe((()=>this.requestUpdate())),{toggleEditMode:o.toggleEditMode,get editMode(){return i.readable.editMode},appForm:Rn({clearOnSubmit:!1,showAdditionalOrigins:!0,submitButtonText:"save changes",initialValues:(n=t,{home:n.home,label:n.label,additionalOrigins:(r=n.home,a=n.origins,a.filter((e=>e.toLowerCase()!==new URL(r.toLowerCase()).origin)).map((e=>e.toLowerCase())))}),requestUpdate:()=>{this.requestUpdate()},query:e=>this.shadowRoot.querySelector(`.app[data-app-id="${t.appId}"] .app-options`).querySelector(e),submit:async e=>{const i=jn(e);await this.share.appsModel.updateApp(t.appId,i)}}),adminManager:(()=>{const e=_n({app:t,appEditService:this.share.appsModel.appEditService,query:e=>this.shadowRoot.querySelector(`.app[data-app-id="${t.appId}"] .adminmanager`).querySelector(e)});return e.subscribe((()=>this.requestUpdate())),e.controls.listAdmins(),e})()};var n,r,a})),this.deleteApp=async e=>{await this.share.modals.confirm({title:"are you certain?",body:`you really want to delete your community "${e.label}"?`,yes:{label:"delete whole community",vibe:"negative"},no:{label:"nevermind",vibe:"neutral"},focusNthElement:2})&&await this.share.appsModel.deleteApp(e.appId)}}init(){this.share.appsModel.loadApps()}renderAppRegistration(){return pt`
			<div class=app-registration>
				<slot name="register-app-heading"></slot>
				${this.appRegistrationForm.render({partNamespace:"appregistration"})}
			</div>
		`}renderNoApps(){return pt`
			<slot name=no-apps></slot>
			${this.renderAppRegistration()}
		`}renderAppList(e){return pt`
			<slot></slot>
			<div class=app-list>
				${Object.entries(e).map((([e,t])=>nn(t,(e=>this.renderApp(e)))))}
			</div>
			${this.renderAppRegistration()}
		`}renderAppBankLinking(e){return null}renderAppCode(e){return pt`
			<div class=app-code>
				<h4>connect your website</h4>
				<p>copy-paste this html into your website's &lt;head&gt; section:</p>
				<code class=htmlcode>
					${function(e){const t=(e,t)=>pt`<span data-syntax=${e}>${t}</span>`,i=e=>t("tag",e),o=e=>t("attr",e),n=e=>t("data",e),r=e=>t("glue",e),a=r('"');return pt`
		${r("<")}${i("script")} ${o("async")} ${o("defer")} ${o("src")}${r("=")}${a}${n("https://xiome.io/xiome.bundle.min.js")}${a}${r(">")}${r("</")}${i("script")}${r(">")}
		<br/>
		${r("<")}${i("xiome-config")} ${o("app")}${r("=")}${a}${n(e)}${a}${r(">")}${r("</")}${i("xiome-config")}${r(">")}
	`}(e)}
				</code>
				<p>then head over to the <a part=link href="./components">components page</a></p>
			</div>
		`}renderApp(e){const t=this.getAppState(e.appId);return pt`
			<div class=app data-app-id=${e.appId}>

				<div class=app-header part=app-header>
					<div class=title>
						<h3>
							<a part=link target=_blank href="${e.home}">
								${e.label}
							</a>
						</h3>
					</div>
					<div class=stats>
						<div data-stat=users>
							<span>${e.stats.users.toLocaleString()}</span>
							<span>users</span>
						</div>
						<div data-stat=monthly-active>
							<span>${e.stats.usersActiveMonthly.toLocaleString()}</span>
							<span>monthly active</span>
						</div>
						<div data-stat=active-last-day>
							<span>${e.stats.usersActiveDaily.toLocaleString()}</span>
							<span>daily active</span>
						</div>
					</div>
				</div>

				<div class=twoside>
					${this.renderAppCode(e.appId)}
					<div class=editside>
						<div class=buttons>
							<xio-button @click=${t.toggleEditMode}>edit community</xio-button>
						</div>
						<div class=app-options ?hidden=${!t.editMode}>
							<div class=app-details>
								${t.appForm.render({partNamespace:"appeditor"})}
							</div>
							<div class=adminmanager>
								<h4>manage admins</h4>
								${t.adminManager.render()}
							</div>
							${this.renderAppBankLinking(e)}
							<div class=finalbox>
								<xio-button
									class=delete-app-button
									@press=${()=>this.deleteApp(e)}>
										delete community
								</xio-button>
							</div>
						</div>
					</div>
				</div>
			</div>
		`}render(){const{appRecords:e}=this.share.appsModel.state;return pt`
			${nn(e,(e=>Object.values(e).length?this.renderAppList(e):this.renderNoApps()))}
		`}};Un=qn([zt(Cn)],Un);var Nn=je`

:host {
	display: block;
	width: var(--avatar-size, 2em);
	height: var(--avatar-size, 2em);
	--op-size: calc(var(--avatar-size, 2em) * 0.5);
}

xio-op {
	display: flex;
	justify-content: center;
	align-items: center;
	width: 100%;
	height: 100%;
}

:host([logged-in]) .avatar {
	color: #fff;
}

`,zn=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let Ln=class extends(Xt()(ei)){render(){return nn(this.share.accessModel.getAccessOp(),(e=>{var t;return pt`
				<xio-avatar
					part=avatar
					.spec=${null===(t=null==e?void 0:e.user)||void 0===t?void 0:t.profile.avatar}
				></xio-avatar>
			`}),null,{hideErrorText:!0})}};Ln=zn([zt(Nn)],Ln);var Bn=je`

xio-profile-card {
	--avatar-size: 7em;
}

`,Vn=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let Wn=class extends(Xt()(ei)){constructor(){super(...arguments),this.saveProfile=async e=>{await this.share.personalModel.saveProfile(e)}}render(){const{accessOp:e}=this.share.personalModel.readable;return nn(e,(({user:e})=>pt`
			<xio-profile-card
				show-details
				.user=${e}
				.saveProfile=${this.saveProfile}
			></xio-profile-card>
			<slot></slot>
		`))}};Wn=Vn([zt(Bn)],Wn);var Hn=je`

:host {
	display: block;
}

slot {
	display: block;
}

xio-text-input,
xio-button {
	margin-top: 0.2em;
}

xio-text-input > span {
	opacity: 0.4;
	font-size: 0.7em;
}

.buttonbar {
	margin-top: 0.5em;
	vertical-align: middle;
}

slot[name="legal"] {
	display: inline-block;
	margin: 0 1em;
}

small {
	display: block;
	opacity: 0.5;
	font-size: 0.7em;
}

`,Fn=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let Xn=class extends(Xt()(ei)){constructor(){super(...arguments),this["show-logout"]=!1,this.status="loading",this.sentLoading=M.none(),this.emailIsValid=!1}async sendEmail(){const e=this.textInput.value;await M.operation({promise:this.share.accessModel.sendLoginLink(e).then((()=>({email:e}))),setOp:e=>this.sentLoading=e,errorReason:`failed sending email to "${e}"`})}resetSentLoading(){this.sentLoading=M.none(),this.textInput&&(this.textInput.text="")}logout(){this.share.accessModel.logout().then((()=>this.sentLoading=M.none()))}subscribe(){return this.share.accessModel.subscribe((()=>{this.resetSentLoading()}))}renderLoggedIn(e){return pt`
			<slot>
				<p>Welcome ${e.user.profile.nickname}!</p>
			</slot>
			${this["show-logout"]?pt`
					<div part=buttonbar>
						<xio-button class=logout-button @press=${this.logout}>
							Logout
						</xio-button>
					</div>
				`:null}
		`}handleEmailChange(){this.emailIsValid=0===this.textInput.problems.length}renderLegalLink(){return pt`
			<small>
				<p>
					<a
						part=link
						target=_blank
						href="https://xiome.io/legal">
							policies and terms
					</a>
				</p>
			</small>
		`}renderLoggedOut(){const{emailIsValid:e}=this;return pt`
			<xio-op .op=${this.sentLoading}>
				<div slot=none>
					<slot name=logged-out>
						<p>login with your email address</p>
					</slot>
					<xio-text-input
						.validator=${hn()}
						@valuechange=${this.handleEmailChange}
						@enterpress=${this.sendEmail}>
							<span>your email</span>
					</xio-text-input>
					<div class=buttonbar>
						<slot name=legal>
							${this.renderLegalLink()}
						</slot>
						<xio-button
							?disabled=${!e}
							@press=${this.sendEmail}>
								send login link
						</xio-button>
					</div>
				</div>
				${M.isReady(this.sentLoading)?pt`
						<p>email sent to ${M.value(this.sentLoading).email}</p>
						<p>please wait a few minutes for it to arrive</p>
						<xio-button @press=${this.resetSentLoading}>
							restart
						</xio-button>
					`:null}
			</xio-op>
		`}render(){var e;const t=this.share.accessModel.getAccessOp();return this.status="loading",M.isReady(t)&&(this.status=(null===(e=M.value(t))||void 0===e?void 0:e.user)?"logged-in":"logged-out"),nn(t,(e=>(null==e?void 0:e.user)?this.renderLoggedIn(e):this.renderLoggedOut()))}};Fn([jt({type:Boolean,reflect:!0})],Xn.prototype,"show-logout",void 0),Fn([jt({type:String,reflect:!0})],Xn.prototype,"status",void 0),Fn([jt()],Xn.prototype,"sentLoading",void 0),Fn([Dt("xio-text-input")],Xn.prototype,"textInput",void 0),Fn([jt({type:String})],Xn.prototype,"emailIsValid",void 0),Xn=Fn([zt(Hn)],Xn);var Qn=je`

.creator {
	margin: 1em auto;
}

.privilege {
	display: inline-flex;
	flex-direction: row;
	padding: 0.2em 0.5em;
	margin: 0.2em;
	border: 1px solid;
}

.privilege .icon {
	padding-right: 0.5em;
}

.privilege xio-button {
	--xio-button-padding: 0;
	--xio-button-border: none;
}

.privilege[data-hard] {
	opacity: 0.5;
	border: 1px solid dashed;
}

`,Jn=ut`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><g fill="none"><path d="M7 5a4 4 0 0 1 5.445-3.73a.5.5 0 0 1 .173.819L10.708 4L12 5.293l1.91-1.91a.5.5 0 0 1 .82.172a4 4 0 0 1-4.829 5.292L4.897 13.92a1.986 1.986 0 0 1-2.843-2.774l5.051-5.234A4.01 4.01 0 0 1 7 5zm4-3a3 3 0 0 0-2.862 3.903a.5.5 0 0 1-.117.498L2.773 11.84a.986.986 0 0 0 1.41 1.377l5.225-5.293a.5.5 0 0 1 .532-.116a3 3 0 0 0 4.046-3.088l-1.633 1.634a.5.5 0 0 1-.707 0l-2-2a.5.5 0 0 1 0-.707l1.634-1.634A3.045 3.045 0 0 0 11 2z" fill="currentColor"/></g></svg>`,Kn=ut`<svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill="currentColor" fill-rule="evenodd" d="M7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm0 1.3c1.3 0 2.5.44 3.47 1.17l-8 8A5.755 5.755 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zm0 11.41c-1.3 0-2.5-.44-3.47-1.17l8-8c.73.97 1.17 2.17 1.17 3.47 0 3.14-2.56 5.7-5.7 5.7z"/></svg>`;const Yn=rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(1),pn(32));var Zn,Gn,er,tr,ir,or,nr,rr,ar=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},sr=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},lr=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};let cr=class extends(Xt()(ei)){constructor(){super(...arguments),Zn.add(this),Gn.set(this,!1),or.set(this,void 0),nr.set(this,(e=>{lr(this,or,e.detail.value,"f"),this.requestUpdate()}))}get model(){return this.share.permissionsModel}init(){this.model.initialize()}render(){const{readable:{permissionsDisplay:e}}=this.model,t=this.model.getUserCanCustomizePermissions();return nn(e,(e=>t?pt`
			<div class=privileges>
				${sr(this,Zn,"m",rr).call(this)}
				${e.privileges.map((e=>function({privilege:{hard:e,label:t,privilegeId:i},onDeleteClick:o}){return pt`
		<div
			class=privilege
			?data-hard=${e}>
				${e?pt`
			<div class="icon system">
				${Jn}
			</div>
		`:pt`
			<xio-button
				title="delete privilege"
				class="icon delete"
				@press=${o}>
					${Kn}
			</xio-button>
		`}
				<span class=text>${t}</span>
		</div>
	`}({privilege:e,onDeleteClick:()=>sr(this,Zn,"m",ir).call(this,e)})))}
			</div>
		`:pt`
			<p>you are not permitted to customize privileges</p>
		`))}};Gn=new WeakMap,or=new WeakMap,nr=new WeakMap,Zn=new WeakSet,er=function(){this.shadowRoot.querySelector(".creator xio-text-input").text=""},tr=async function(){if(sr(this,Gn,"f"))throw new Error("privilege creator is busy");const e=sr(this,or,"f");sr(this,Zn,"m",er).call(this),lr(this,Gn,!0,"f");try{await this.model.createPrivilege({label:e})}finally{lr(this,Gn,!1,"f")}},ir=async function({privilegeId:e,label:t}){await this.share.modals.confirm({title:pt`delete privilege ${t}?`,body:pt`are you sure you want to delete this privilege?`})&&await this.model.deletePrivilege({privilegeId:e})},rr=function(){const e=!sr(this,or,"f");return pt`
			<div class=creator>
				<xio-text-input
					?disabled=${sr(this,Gn,"f")}
					.validator=${Yn}
					@valuechange=${sr(this,nr,"f")}
					@enterpress=${sr(this,Zn,"m",tr)}>
						privilege label
				</xio-text-input>
				<xio-button
					?disabled=${e}
					@press=${sr(this,Zn,"m",tr)}>
						create privilege
				</xio-button>
			</div>
		`},cr=ar([zt(Qn)],cr);var dr=je`

* {
	ZZoutline: 1px solid #0f02;
}

:host {
	display: block;
	width: 100%;
}

.container {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
	gap: 0.5em;
}

.container > * {
	flex: 3 1 10em;
	display: flex;
	flex-direction: column;
}

.roles {
	flex: 1 3 10em;
}

.roles xio-button[data-hard] {
	opacity: 0.6;
}

.container > * > p {
	padding: 0 0.5em;
}

[part=plate] {
	flex: 1 1 auto;
	padding: 0.5em;
	background: #fff2;
}

[part=plate] xio-button {
	display: inline-block;
	margin: 0.2em 0.1em;
	--xio-button-disabled-opacity: 0.6;
}

[part=plate] xio-button[data-hard] {
	opacity: 0.6;
}

[part=plate] xio-button[data-selected]::part(button) {
	border: 1px solid lime;
	background: yellow;
	color: black;
}

[part=plate] xio-button > div {
	display: flex;
	flex-direction: row;
}

[part=plate] xio-button .icon {
	margin-right: 0.2em;
}

[part=plate] xio-button svg {
	width: 0.8em;
	height: 0.8em;
}

.buttonbar {
	text-align: right;
	background: #0002;
}

.buttonbar [data-button=delete] {
	--xio-button-hover-color: red;
	--xio-button-hover-background: transparent;
}

.buttonbar [data-button=new] {
	--xio-button-hover-color: lime;
	--xio-button-hover-background: transparent;
}

`,pr=ut`<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-lock"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>`;const ur=rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(1),pn(16),(e=>e.length>0&&0===e.trim().length?["can't be all whitespace"]:[]));var hr=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let fr=class extends(Xt()(ei)){constructor(){super(...arguments),this.clickRole=e=>()=>{this.roleSelected=e},this.clickDeleteRole=async()=>{const{modals:e,permissionsModel:t}=this.share,i=this.roleSelected;await e.confirm({title:"Delete role?",body:`Are you sure you want to permanently delete the role "${i.label}"`,yes:{vibe:"negative",label:"Delete role"},no:{vibe:"neutral",label:"Nevermind"},focusNthElement:2})&&await t.deleteRole({roleId:i.roleId})},this.clickNewRole=async()=>{const{modals:e,permissionsModel:t}=this.share,i=await e.prompt({title:"Create a new role",input:{label:"Role name",validator:ur},yes:{vibe:"positive",label:"Create role"}});i&&await t.createRole({label:i.value})},this.clickAvailablePrivilege=e=>async()=>{const{roleSelected:t}=this;t&&await this.share.permissionsModel.assignPrivilege({privilegeId:e,roleId:t.roleId})},this.clickAssignedPrivilege=e=>async()=>{const{roleSelected:t}=this;t&&await this.share.permissionsModel.unassignPrivilege({privilegeId:e,roleId:t.roleId})}}init(){this.share.permissionsModel.initialize()}getAssignedPrivileges(e){const{roleSelected:t}=this;if(!t)return[];const i=e.rolesHavePrivileges.filter((({roleId:e})=>e===t.roleId)).map((({privilegeId:e})=>e));return e.privileges.filter((({privilegeId:e})=>i.includes(e))).map((i=>{const{active:o,immutable:n}=e.rolesHavePrivileges.find((e=>e.roleId===t.roleId&&e.privilegeId===i.privilegeId));return{...i,active:o,immutable:n}}))}renderPrivilege({privilegeId:e,label:t,hard:i,immutable:o,onPrivilegeClick:n}){return pt`
			<xio-button
				title="${e}"
				?disabled=${o}
				?data-hard=${i}
				?data-soft=${!i}
				?data-immutable=${o}
				@press=${n}>
					<div>
						${i?pt`<div class=icon>${Jn}</div>`:null}
						${o?pt`<div class=icon>${pr}</div>`:null}
						${t}
					</div>
			</xio-button>
		`}renderPermissions(e){const t=this.getAssignedPrivileges(e),i=t.filter((e=>e.active)),o=this.roleSelected?[...e.privileges.filter((e=>!t.find((t=>t.privilegeId===e.privilegeId)))).map((e=>({...e,immutable:!1}))),...t.filter((e=>!e.active))]:[];return pt`
			<div class=container>
				<div class=roles>
					<p>roles</p>
					<div part=plate>
						${e.roles.map((e=>pt`
							<xio-button
								title="${e.roleId}"
								?data-selected=${this.roleSelected&&e.roleId===this.roleSelected.roleId}
								?data-hard=${e.hard}
								?disabled=${this.roleSelected&&e.roleId===this.roleSelected.roleId}
								@click=${this.clickRole(e)}>
								<div>
									${e.hard?pt`<div class=icon>${Jn}</div>`:null}
									${e.label}
								</div>
							</xio-button>
						`))}
					</div>
					<div part=plate class=buttonbar>
						${this.roleSelected?pt`
								<xio-button
									data-button=delete
									?disabled=${this.roleSelected.hard}
									@press=${this.clickDeleteRole}>
										delete role
								</xio-button>
							`:null}
						<xio-button data-button=new @press=${this.clickNewRole}>
							new role
						</xio-button>
					</div>
				</div>

				<div class=assigned>
					<p>
						privileges assigned
						${this.roleSelected?` to "${this.roleSelected.label}"`:null}
					</p>
					<div part=plate>
						${i.map((e=>this.renderPrivilege({...e,onPrivilegeClick:this.clickAssignedPrivilege(e.privilegeId)})))}
					</div>
				</div>

				<div class=available>
					<p>privileges available</p>
					<div part=plate>
						${o.map((e=>this.renderPrivilege({...e,onPrivilegeClick:this.clickAvailablePrivilege(e.privilegeId)})))}
					</div>
				</div>
			</div>
		`}render(){const{permissionsModel:e}=this.share,{getUserCanCustomizePermissions:t,readable:i}=e;return t()?nn(i.permissionsDisplay,this.renderPermissions.bind(this)):pt`
				<p>you are not privileged to customize permissions</p>
			`}};function mr({models:e,modals:t}){const{accessModel:i,appsModel:o,personalModel:n,permissionsModel:r}=e;return{XiomeMyAvatar:Ht(i.subscribe)(Ft({accessModel:i})(Ln)),XiomeLoginPanel:Ht(i.subscribe)(Ft({accessModel:i})(Xn)),XiomeAppManager:Ht(o.subscribe)(Ft({modals:t,appsModel:o})(Un)),XiomeMyAccount:Ht(n.subscribe)(Ft({personalModel:n})(Wn)),XiomePermissions:Ht(r.subscribe)(Ft({modals:t,permissionsModel:r})(fr)),XiomePrivileges:Ht(r.subscribe)(Ft({modals:t,permissionsModel:r})(cr))}}hr([jt()],fr.prototype,"roleSelected",void 0),fr=hr([zt(dr)],fr);var br=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-users"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>`,vr=ut`
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>`,gr=ut`
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-volume-2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>`,wr=ut`
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-power"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"></path><line x1="12" y1="2" x2="12" y2="12"></line></svg>`;function yr(e,t,i){return 1===e?t:i}var xr=ut`
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-volume-x"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line></svg>`,$r=ut`<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>`;const kr=rn((e=>"string"!=typeof e?["must be a string"]:[]),(Or=64,e=>e.length!==Or?[`length must be ${Or}`]:[]),((e,t="invalid string")=>i=>e.test(i)?[]:[t])(/^[0-9a-z]{64}$/));var Or;const Sr=rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(1),pn(280),(e=>e.length>0&&0===e.trim().length?["can't be all whitespace"]:[]));var Ar,Pr,Cr,Ir,Mr,Er,Rr,Tr,_r,jr,Dr,qr,Ur,Nr,zr,Lr,Br=je`

:host {
	display: block;
	max-width: 56em;
	--xiome-chat-history-height: 20em;
}

.modheader {
	display: flex;
	flex-wrap: wrap;
	flex-direction: row;
	align-items: end;
	padding: 0 1em;
}

.modheader > span:nth-child(1) {
	opacity: 0.5;
	padding: 0.2em 0;
}

.modheader > span:nth-child(2) {
	margin-left: auto;
}

xio-button {
	--xio-button-disabled-border-style: none;
}

.modheader xio-button {
	--xio-button-border: none;
}

.modheader xio-button::part(button-slot) {
	display: flex;
	align-items: center;
	gap: 0.5em;
}

.history {
	padding: 1em;
	border: 1px solid;
	border-radius: 0.5em 0.5em 0 0;
	border-bottom: 0;
}

.chatbox xiome-login-panel {
	display: block;
	border: 1px solid currentColor;
	border-radius: 0 0 0.5em 0.5em;
}

.chatbox xiome-login-panel[status="logged-out"] {
	padding: 1em;
}

.chatbox slot[name="offline"],
.chatbox slot[name="muted"] {
	display: block;
	padding: 2em 1em;
	text-align: center;
}

.chatbox slot[name="offline"] {
	border: 1px solid currentColor;
	border-radius: 0.5em;
}

.chatfooter {
	display: flex;
	flex-wrap: wrap;
	align-items: center;
	margin: 0.1em 0.5em;
}

.chatfooter svg {
	width: 1.3em;
}

.chatfooter .user-count {
	margin: 0 0.5em;
}

.chatfooter .user-counting-details {
	opacity: 0.5;
}

${je`

.history ol,
.history slot[name="no-messages"] {
	height: var(--xiome-chat-history-height);
	overflow-y: auto;
	scrollbar-color: #0004 #0002;
	scrollbar-width: thin;
}

.history ol::-webkit-scrollbar {
	width: 0.4em;
}

.history ol::-webkit-scrollbar-thumb {
	border-radius: 1em;
	background: #0004;
}

.history ol::-webkit-scrollbar-thumb:hover {
	background: #0008;
}

.history ol::-webkit-scrollbar-thumb:active {
	background: #000a;
}

.history ol::-webkit-scrollbar-track {
	border-radius: 1em;
	background: #0002;
}

slot[name="no-messages"] {
	opacity: 0.5;
	display: flex;
	justify-content: center;
	align-items: center;
	text-align: center;
}

.history li + li {
	margin-top: 0.75em;
}

.history li > header {
	display: flex;
	flex-direction: row;
	align-items: center;
	gap: 0.5em;
}

.history li .moderation {
	opacity: 0.5;
}

.history li > header > span {
	display: flex;
	align-items: center;
}

.history li > header > span > xio-button {
	--xio-button-border: none;
	--xio-button-padding: 0 0.3em;
}

.history li .nickname {
	font-size: 1em;
	opacity: var(--xio-chat-nickname-opacity, 0.5);
	color: var(--xio-chat-nickname-color, currentColor);
}

.history li .userid {
	font-size: 1em;
	opacity: var(--xio-chat-userid-opacity, 0.5);
	color: var(--xio-chat-userid-color, currentColor);
}

.history li .content {
	font-size: 1.3em;
	word-break: break-word;
}

.history li .time {
	opacity: 0.3;
	font-size: 1rem;
}

`}

.authorship {
	display: flex;
	align-items: stretch;
	Xborder: 1px solid;
}

.authorship xio-text-input {
	border-right: 1px solid;
	--xio-text-input-height: 6em;
	--xio-text-input-label-opacity: 0.5;
	--xio-text-input-border: 0;
	--xio-text-input-pad: 1em;
}

.authorship xio-button {
	height: 6em;
	flex: 1 1 auto;
	--xio-button-border: 0;
	--xio-button-disabled-border-style: none;
}

.authorship xio-button::part(button) {
	width: 100%;
}

.authorship .inputlabel {
	display: block;
	opacity: 0.5;
	padding: 0.2em 0;
	margin-left: 1em;
}

`,Vr=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},Wr=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},Hr=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};let Fr=class extends(Xt()(ei)){constructor(){super(...arguments),Ar.add(this),this.room="default",Ir.set(this,void 0),Mr.set(this,(()=>{})),Er.set(this,!0),Tr.set(this,(()=>{const e=this.shadowRoot.querySelector(".history ol");e?e.scrollHeight<=e.clientHeight?Hr(this,Er,!0,"f"):Wr(this,Er,"f")&&e.scrollTo(0,e.scrollHeight-e.clientHeight):Hr(this,Er,!0,"f")})),this.draftValid=!1,this.tooSoon=!1,qr.set(this,Date.now()),Ur.set(this,(()=>{const e=Date.now()-Wr(this,qr,"f");this.tooSoon=e<3e3})),zr.set(this,(e=>{e.preventDefault();const{tooSoon:t}=this;if(!t){const{value:e}=this.authorshipInput,t={content:e};Hr(this,qr,Date.now(),"f"),this.authorshipInput.text="",Wr(this,Ur,"f").call(this),Wr(this,Ir,"f").post(t)}}))}subscribe(){Wr(this,Ar,"a",Pr).session(this.room).then((({room:e,dispose:t})=>{Hr(this,Ir,e,"f"),Hr(this,Mr,t,"f")})).then((()=>this.requestUpdate()));const e=[super.subscribe(),()=>Wr(this,Mr,"f").call(this),Wr(this,Ar,"m",Nr).call(this),Wr(this,Ar,"a",Pr).subscribeToChange(Wr(this,Tr,"f"))];return()=>{for(const t of e)t()}}render(){return nn(Wr(this,Ar,"a",Pr).state.connectionOp,(()=>{var e;return pt`
			<div class=chatbox>
				${Wr(this,Ir,"f")?pt`
						${Wr(this,Ar,"m",jr).call(this)}
						${(null===(e=Wr(this,Ir,"f"))||void 0===e?void 0:e.status)===le.Online?[Wr(this,Ar,"m",Dr).call(this),Wr(this,Ar,"m",Lr).call(this),Wr(this,Ar,"m",_r).call(this)]:pt`
								<slot name=offline>
									chat is offline
								</slot>
							`}
					`:null}
			</div>
		`}))}};function Xr({models:e,modals:t}){const{chatModel:i}=e;return{XiomeChat:Ht(i.subscribe)(Ft({modals:t,chatModel:i})(Fr))}}Ir=new WeakMap,Mr=new WeakMap,Er=new WeakMap,Tr=new WeakMap,qr=new WeakMap,Ur=new WeakMap,zr=new WeakMap,Ar=new WeakSet,Pr=function(){return this.share.chatModel},Cr=function(){var e;const t=null===(e=Wr(this,Ar,"a",Pr).state.cache.roomStats)||void 0===e?void 0:e.statsForRooms;if(t)return t[this.room]},Rr=function(){const e=this.shadowRoot.querySelector("ol"),{scrollTop:t,scrollHeight:i,clientHeight:o}=e;Hr(this,Er,i-o-t<50,"f")},_r=function(){const e=Wr(this,Ar,"a",Cr);if(e){const{moderators:t,viewers:i,participants:o,totalUsers:n}=e;return Wr(this,Ir,"f")?pt`
					<p class=chatfooter>
						${br}
						<span class=user-count>
							${n} ${yr(n,"user","users")}
						</span>
						<span class=user-counting-details>
							(${t} ${yr(t,"moderator","moderators")},
							${o} ${yr(o,"participant","participants")},
							${i} ${yr(i,"viewer","viewers")})
						</span>
					</p>
				`:null}},jr=function(){const e=Wr(this,Ir,"f").status,t=Wr(this,Ir,"f").muted.length;return Wr(this,Ar,"a",Pr).allowance.moderateAllChats?pt`
				<header class=modheader>
					<span>room="${this.room}"</span>
					<span>
						<xio-button
							title="unmute ${t} users"
							?disabled=${0===t}
							@press=${()=>Wr(this,Ir,"f").unmuteAll()}>
								${gr} ${t}
						</xio-button>
						<xio-button
							title="clear chat room"
							@press=${()=>Wr(this,Ir,"f").clear()}>
								${vr}
						</xio-button>
						<xio-button
							title="set chat ${e===le.Offline?"online":"offline"}"
							@press=${()=>{Wr(this,Ir,"f").setRoomStatus(Wr(this,Ir,"f").status===le.Offline?le.Online:le.Offline)}}>
								${wr}
						</xio-button>
					</span>
				</header>
			`:null},Dr=function(){return pt`
			<div class=history>
				${Wr(this,Ar,"a",Pr).allowance.viewAllChats?pt`
						${Wr(this,Ir,"f").posts.length?pt`
								<ol @scroll=${Wr(this,Ar,"m",Rr)}>
									${Wr(this,Ir,"f").posts.map((e=>function({post:e,isModerator:t,mute:i,remove:o,mutedIds:n}){const r=en(e.time),a=n.includes(e.userId);return pt`
		<li data-post="${e.postId}">
			<header>
				<span class=nickname>${e.nickname}</span>
				${t?pt`
						<span class=moderation>
							<xio-button
								title="mute user"
								@press=${i}
								?disabled=${a}>
									${xr}
							</xio-button>
							<xio-button
								title="delete post"
								@press=${o}>
									${$r}
							</xio-button>
						</span>
					`:null}
				<xio-id class=userid title="copy user id" id="${e.userId}"></xio-id>
			</header>
			<div>
				<p class=content>
					${e.content}
					<span class=time title="${r.date} ${r.zone}">
						${r.time}
					</span>
				</p>
			</div>
		</li>
	`}({post:e,isModerator:Wr(this,Ar,"a",Pr).allowance.moderateAllChats,mute:()=>Wr(this,Ir,"f").mute(e.userId),remove:()=>Wr(this,Ir,"f").remove([e.postId]),mutedIds:Wr(this,Ir,"f").muted})))}
								</ol>
							`:pt`
								<slot name=no-messages>
									no messages
								</slot>
							`}
					`:pt`
						<slot name=cannot-view>
							you are not privileged to view the chat
						</slot>
					`}
			</div>
		`},Nr=function(){const e=setInterval(Wr(this,Ur,"f"),1e3);return()=>clearInterval(e)},Lr=function(){const e=()=>Wr(this,Ir,"f").weAreBanned?pt`<slot name=banned>you are banned</slot>`:Wr(this,Ir,"f").weAreMuted?pt`<slot name=muted>you are muted</slot>`:function({sendable:e,onSendClick:t,onEnterPress:i,onValidityChange:o}){return pt`
		<div class=authorship>

			<xio-text-input
				textarea
				.validator=${Sr}
				@valuechange=${function(e){const t=e.detail.value;o(void 0!==t)}}
				@enterpress=${i}>
			</xio-text-input>

			<xio-button
				?disabled=${!e}
				@press=${t}>
					send message
			</xio-button>
		</div>
	`}({sendable:!!this.draftValid&&!this.tooSoon,onSendClick:Wr(this,zr,"f"),onEnterPress:Wr(this,zr,"f"),onValidityChange:e=>this.draftValid=e});return pt`
			<xiome-login-panel>
				${on(Wr(this,Ar,"a",Pr).state.accessOp,(()=>pt`
					<slot name=logged-out slot=logged-out>
						login to participate in the chat
					</slot>
					<div class=participation>
						${Wr(this,Ar,"a",Pr).allowance.participateInAllChats?e():pt`
								<slot name=cannot-participate>
									you do not have privilege to participate in the chat
								</slot>
							`}
					</div>
				`))}
			</xiome-login-panel>
		`},Vr([jt({type:String})],Fr.prototype,"room",void 0),Vr([jt()],Fr.prototype,"draftValid",void 0),Vr([Dt(".authorship xio-text-input")],Fr.prototype,"authorshipInput",void 0),Vr([jt()],Fr.prototype,"tooSoon",void 0),Fr=Vr([zt(Br)],Fr);var Qr=je`

:host {
	display: flex;
	flex-direction: column;
	align-items: stretch;
	justify-content: center;
	max-width: 32em;
	border: solid 0.1em;
}

xio-button {
	--xio-button-border: none;
	--_disabled-border-style: none;
}

/* Note tabs new/old */

.tabs {
	display: flex;
	justify-content: space-evenly;
	padding-bottom: 1em;
	margin: 1em 2em;
	border-bottom: solid 0.1em;
}

[data-tab] {
	font-weight: normal;
}

[data-tab][data-active='true'] {
	font-weight: bold;
	border-bottom: solid 0.2em;
}

/* Individual note */

ol > li {
	display: flex;
	flex-direction: column;
	padding: 1em;
	margin: 1em 2em;
	border: solid 0.1em;
	list-style-type: none;
}

ol > li > header {
	display: flex;
	justify-content: space-between;
	align-self: flex-end;
	width: 100%;
}

ol > li > p {
	opacity: 0.6;
}

/* Pagination */

.paginationBar {
	display: flex;
	justify-content: center;
	align-items: center;
	margin: 1em 2em;
}

.paginationBar > span {
	margin: 0em 1em;
}

/* Notifications */

xio-op[mode="loading"], slot {
	display: block;
	text-align: center;
	width: 100%;
	margin-bottom: 1em;
}

/* Button bar */

.buttonbar {
	display: flex;
	justify-content: flex-end;
	padding-top: 1em;
	margin: 0 2em 1em 2em;
	border-top: solid 0.1em;
}

.buttonbar > xio-button {
	--xio-button-border: solid 0.1em;
}
`,Jr=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-left"><polyline points="15 18 9 12 15 6"></polyline></svg>`,Kr=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>`,Yr=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>`,Zr=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>`;const Gr=36e5,ea=24*Gr,ta=e=>1===e?"":"s";var ia,oa,na,ra,aa,sa,la,ca,da,pa=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},ua=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let ha=class extends(Xt()(ei)){constructor(){super(...arguments),ia.add(this),oa.set(this,this.share.notesModel),na.set(this,this.share.notesModel.createNotesCacheDetails()),ra.set(this,ua(this,na,"f").cache)}async init(){await ua(this,oa,"f").initialize()}subscribe(){const e=[super.subscribe(),ua(this,na,"f").setup(),ua(this,ra,"f").subscribe((()=>this.requestUpdate()))];return ua(this,oa,"f").isLoggedIn&&ua(this,ra,"f").fetchAppropriateNotes(),()=>e.forEach((e=>e()))}render(){return nn(ua(this,oa,"f").state.accessOp,(e=>(null==e?void 0:e.user)?pt`
					${ua(this,ia,"m",da).call(this)}
				`:pt`
					<slot name="logged-out">
						you must be logged in to see your notifications
					</slot>
				`))}};oa=new WeakMap,na=new WeakMap,ra=new WeakMap,ia=new WeakSet,aa=function(){const{old:e}=ua(this,ra,"f").cacheState,{switchTabNew:t,switchTabOld:i}=ua(this,ra,"f");return pt`
			<div class=tabs>
				<xio-button
					@press=${t}
					data-tab="new"
					data-active=${!e}>
						new
				</xio-button>
				<xio-button
					@press=${i}
					data-tab="old"
					data-active=${e}>
						old
				</xio-button>
			</div>
		`},sa=function(){const{old:e,notesOp:t}=ua(this,ra,"f").cacheState,{markSpecificNoteNew:i,markSpecificNoteOld:o}=ua(this,ra,"f"),n=Date.now();return nn(t,(t=>pt`
			<ol>
				${t.map((t=>pt`
					<li>
						<header class="note-header">
							<h2>${t.title}</h2>
							${e?pt`
								<xio-button @press=${()=>i(t.noteId)}>
									${Yr}
								</xio-button>
							`:pt`
								<xio-button @press=${()=>o(t.noteId)}>
									${Zr}
								</xio-button>
							`}
						</header>
						<p><strong>${t.type}</strong> â€“ <em>${function(e){const t=t=>{const i=Math.floor(e/t);return e%=t,i},i=t(ea),o=t(Gr),n=t(6e4),r=t(1e3),a={days:`${i} day${ta(i)}`,hours:`${o} hour${ta(o)}`,minutes:`${n} minute${ta(n)}`,seconds:`${r} second${ta(r)}`},s=i>3?`${a.days} ago`:i>1?`${a.days} and ${a.hours} ago`:o>3?`${a.hours} ago`:o>1?`${a.hours} and ${a.minutes} ago`:n>3?`${a.minutes} ago`:n>1?`${a.minutes} and ${a.seconds} ago`:`${a.seconds} ago`;return{...a,ago:s}}(n-t.time).ago}</em></p>
					</li>
				`))}
			</ol>
		`))},la=function(){const{pageNumber:e}=ua(this,ra,"f").cacheState,{nextPage:t,previousPage:i,totalPages:o,isNextPageAvailable:n,isPreviousPageAvailable:r}=ua(this,ra,"f");return pt`
			${n||r?pt`
				<div class="paginationBar">
					<xio-button
						?disabled=${!r}
						@press=${i}>
							${Jr}
					</xio-button>
					<span>
						${e} / ${o}
					</span>
					<xio-button
						?disabled=${!n}
						@press=${t}>
							${Kr}
					</xio-button>
				</div>
				`:null}
		`},ca=function(){const{old:e}=ua(this,ra,"f").cacheState,{markAllNotesOld:t}=ua(this,ra,"f");return pt`
			<div class=buttonbar>
				${e?null:pt`
						<xio-button @press=${t}>
							mark all old
						</xio-button>
					`}
			</div>
		`},da=function(){var e;const{old:t,notesOp:i}=ua(this,ra,"f").cacheState;return pt`
			${0===(null===(e=M.value(i))||void 0===e?void 0:e.length)?pt`
					${ua(this,ia,"m",aa).call(this)}
					<slot name="empty">
						you have no ${t?"old":"new"} notifications
					</slot>
				`:pt`
					${ua(this,ia,"m",aa).call(this)}
					${ua(this,ia,"m",sa).call(this)}
					${ua(this,ia,"m",la).call(this)}
					${ua(this,ia,"m",ca).call(this)}
				`}
		`},ha=pa([zt(Qr)],ha);var fa=je`

:host {
	display: inline-block;
	--xiome-notes-indicator-count-size: 1em;
	--xiome-notes-indicator-color: red;
	--xiome-notes-indicator-bleedout: 0em;
	font-size: var(--xiome-notes-indicator-size, 1em);
	width: var(--xiome-notes-indicator-icon-size, 3em);
	position: relative;
}

:host([no-icon]) .bell {
	display: none;
}

.count {
	display: flex;
	justify-content: center;
	align-items: center;
	vertical-align: top;
	position: absolute;
	height: 1em;
	width: 1em;
	background-color: var(--xiome-notes-indicator-color);
	border-radius: 50%;
	text-align: center;
	right: var(--xiome-notes-indicator-bleedout);
	top: var(--xiome-notes-indicator-bleedout);
	font-weight: bold;
	color: white;
	font-size: var(--xiome-notes-indicator-count-size);
}
`,ma=ut`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bell"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>`,ba=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let va=class extends(Xt()(ei)){constructor(){super(...arguments),this.noIcon=!1}render(){const e=pt`<span class="bell">${ma}</span>`,{stats:t}=this.share.notesModel;return pt`
				${0===t.newCount?pt`${e}`:pt`
					<span class="count">${t.newCount}</span>
					${e}
				`}
			`}};function ga({models:{notesModel:e}}){return{XiomeNotes:Ht(e.stateSubscribe)(Ft({notesModel:e})(ha)),XiomeNotesIndicator:Ht(e.stateSubscribe)(Ft({notesModel:e})(va))}}ba([jt({attribute:"no-icon"})],va.prototype,"noIcon",void 0),va=ba([zt(fa)],va);var wa=je`

:host {
	display: block;
}

`;function ya({view:e,onDeleteClick:t,getPrivilegeDisplay:i}){return pt`
		<div class="view">
			<div class="view-details">
				<div>
					<h4>hosting provider</h4>
					<p>${e.provider}</p>
				</div>
				<div>
					<h4>content type</h4>
					<p>${e.type}</p>
				</div>
				<div>
					<h4>content id</h4>
					<xio-id id="${e.id}"></xio-id>
				</div>
			</div>
			<h4>privileges with access</h4>
			<ul>
				${e.privileges.map(i).map((e=>e?pt`<li>${e.label}</li>`:null))}
			</ul>
			<div class=buttonbar>
			<xio-button @press=${t}>
				unassign from this display
			</xio-button>
			</div>
		</div>
	`}var xa=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let $a=class extends(Xt()(ei)){async init(){this.share.contentModel.initializeForModerationData()}render(){const e=this.share.contentModel;return e.allowance.canModerateVideos?nn(e.state.viewsOp,(t=>pt`
				<slot>
					<h3>all video views</h3>
				</slot>
				${t.length?pt`
					<div class=views>
						${t.map((t=>ya({view:t,onDeleteClick:()=>e.deleteView(t.label),getPrivilegeDisplay:t=>e.getPrivilege(t)})))}
					</div>
				`:pt`
					<slot name=no-views>
						<p>no video views are registered</p>
					</slot>
				`}
			`)):pt`
				<slot name=unprivileged>
					<p>you don't have sufficient privileges to moderate video views</p>
				</slot>
			`}};$a=xa([zt(wa)],$a);var ka=ut`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>`;const Oa=rn(rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(16),pn(64),(e=>/\s/.test(e)?["must not have any spaces"]:[]))),Sa=e=>"good"===e?[]:Oa(e);var Aa,Pa,Ca,Ia,Ma,Ea,Ra,Ta,_a,ja,Da=je`

:host {
	display: block;
	width: 24em;
	max-width: 100%;
	border: 1px solid;
	border-radius: 5px;
	--xiome-video-hosting-warning-color: red;
}

.dacastbox {
	padding: 1em;
}

xio-text-input::part(problems) {
	width: 100%;
}

.buttonbar {
	display: flex;
	flex-direction: row;
	justify-content: flex-end;
}

.buttonbar > * {
	margin: 0.4em 0.2em;
}

.failed {
	color: var(--xiome-video-hosting-warning-color);
	display: flex;
	align-items: center;
	padding: 0.5em 0;
}

.failed svg {
	margin-right: 0.5em;
}

.linked {
	display: flex;
}

.helpbox ul {
	padding-left: 1.5em;
}

.link-time-info {
	display: inline-flex;
	align-items: center;
	padding: 0.5em 0;
}


.unlink-button {
	display: flex;
	justify-content: flex-end;
}

.link-time-info svg {
	width: 6em;
	height: 3em;
}
`,qa=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},Ua=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},Na=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};let za=class extends(Xt()(ei)){constructor(){super(...arguments),Aa.set(this,!1),Pa.set(this,!1),Ca.set(this,""),Ia.set(this,(({detail:{value:e}})=>{Na(this,Ca,e,"f"),this.requestUpdate()})),Ma.set(this,(async()=>{const e=Ua(this,Ca,"f");if(e){Na(this,Pa,!1,"f"),Na(this,Ca,"","f");const t=await this.share.dacastModel.linkAccount({apiKey:e});Na(this,Pa,!t,"f")}})),Ea.set(this,(async()=>{Na(this,Ca,"","f"),await this.share.dacastModel.unlinkAccount()})),Ra.set(this,(()=>{Na(this,Aa,!Ua(this,Aa,"f"),"f"),this.requestUpdate()})),Ta.set(this,(()=>pt`
			<div class=helpbox>
				<p>how to find your dacast api key:</p>
				<ul>
					<li>create a <a part=link target=_blank href="https://dacast.com/">dacast</a> account</li>
					<li>if you have a trial account, you must email support and ask them to activate your account's "api access"</li>
					<li>generate an api key in your <a part=link target=_blank href="https://app.dacast.com/settings/integrations">dacast integrations settings</a></li>
				</ul>
			</div>
		`)),_a.set(this,(()=>pt`
			<h2>link your dacast account</h2>
			<xio-text-input
				placeholder="api key"
				.validator=${Sa}
				@enterpress=${Ua(this,Ma,"f")}
				@valuechange=${Ua(this,Ia,"f")}>
			</xio-text-input>
			${Ua(this,Pa,"f")?pt`<div class=failed>${si} <p>dacast rejected the api link</p></div>`:null}
			<div class=buttonbar>
				<xio-button
					class=help-button
					@press=${Ua(this,Ra,"f")}>
						${Ua(this,Aa,"f")?"hide help":"show help"}
				</xio-button>
				<xio-button
					class=link-button
					?disabled=${!Ua(this,Ca,"f")}
					@press=${Ua(this,Ma,"f")}>
						link
				</xio-button>
			</div>
			${Ua(this,Aa,"f")?Ua(this,Ta,"f").call(this):null}
		`)),ja.set(this,(e=>pt`
			<h2>your dacast account is linked</h2>
			<div class=link-time-info>
				${ka}
				<p>linked on ${en(e.time).full}</p>
			</div>
			<div class=unlink-button>
				<xio-button @press=${Ua(this,Ea,"f")}>unlink</xio-button>
			</div>
		`))}get state(){return this.share.dacastModel.state}async init(){await this.share.dacastModel.initialize()}render(){return nn(this.state.accessOp,(e=>pt`
			<div class=dacastbox>
				${e.permit.privileges.includes(G["moderate videos"])?nn(this.state.linkedAccountOp,(e=>e?Ua(this,ja,"f").call(this,e):Ua(this,_a,"f").call(this))):pt`<slot name=forbidden>you don't have permission to edit video hosting settings</slot>`}
			</div>
		`))}};Aa=new WeakMap,Pa=new WeakMap,Ca=new WeakMap,Ia=new WeakMap,Ma=new WeakMap,Ea=new WeakMap,Ra=new WeakMap,Ta=new WeakMap,_a=new WeakMap,ja=new WeakMap,za=qa([zt(Da)],za);var La=je`

:host {
	display: block;
	--_select-bg: var(--xiome-video-display-select-background, #222);
	--xiome-video-display-selected-option-color: cyan;
}

.controls-title,
.view,
.viewcreator {
	max-width: 42rem;
}

[part="iframe"] {
	width: 100%;
	border: none;
}

.mock-embed img {
	width: 100%;
}

.buttonbar {
	text-align: right;
}

.controls-title,
.viewcreator,
.view {
	border: 1px solid;
	border-radius: 0.2em;
}

.controls-title {
	padding: 0.1em 0.5em;
}
.controls-title[data-open] {
	border-bottom-left-radius: 0;
	border-bottom-right-radius: 0;
}
.view, .viewcreator {
	border-top: 0;
	border-top-left-radius: 0;
	border-top-right-radius: 0;
}

.controls-title {
	display: flex;
	align-items: center;
}
.controls-title div span {
	display: block;
}
.controls-title span:nth-of-type(2) {
	opacity: 0.8;
	font-size: 0.8em;
	font-weight: normal;
	padding-left: 0.2em;
}

.togglebutton {
	--xio-button-border: 0;
	margin-left: auto;
	transition: transform 300ms ease;
	transform: rotate(0deg);
}
[data-open] .togglebutton {
	transform: rotate(180deg);
}

.view, .viewcreator {
	display: flex;
	flex-direction: column;
	gap: 0.2em;
	padding: 0.5em;
}

.viewcreator .selectionarea {
	display: flex;
	flex-wrap: wrap;
	justify-content: space-between;
	width: 100%;
	gap: 0.5em;
	margin: 0.5em 0;
}

.viewcreator .selectionarea > * {
	flex: 1 1 auto;
}

select {
	color: inherit;
	background: transparent;
	border: 1px solid;
	width: 100%;
}

select[multiple] {
	min-height: 10em;
}

select option {
	padding: 0.1em 0.2em;
	color: inherit;
	background: var(--_select-bg);
}

.create-privileges {
	visibility: hidden;
}

.create-privileges[data-visible] {
	visibility: visible;
}

.create-privileges option[selected] {
	color: var(--xiome-video-display-selected-option-color);
}

::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-thumb { background: currentColor; }

::scrollbar { width: 8px; }
::scrollbar-thumb { background: currentColor; }

/* When video is displayed css */

.view-details {
	display: flex;
	flex-wrap: wrap;
	justify-content: space-around;
	gap: 0.8em;
	margin: 0.5em 0;
}

.view-details > * {
	text-align: center;
}

.view ul {
	display: flex;
	justify-content: left;
	text-align: center;
	list-style-type: none;
	flex-wrap: wrap;
}

.view ul li {
	border: 1px solid;
	margin: 0.2em;
	padding: 0.1em 0.4em;
	border-radius: 1em;
}

`;function Ba(e,t){const i=document.createElement(e);for(const[e,o]of Object.entries(t))i.setAttribute(e,o);return i}const Va=/"(https:\/\/iframe\.dacast\.com\/(\S+)\/(\S+))"/i;function Wa(e){const t=e.match(Va);if(!t)throw new Error("failed to parse dacast iframe embed code: make-dacast-iframe likely needs to be updated");const[,,i,o]=t;return`https://iframe.dacast.com/${"playlists"===i?"playlist":i}/${o}`}let Ha=0;function Fa({isContentSelected:e,isCreateButtonDisabled:t,privilegesOp:i,catalogOp:o,selectedContent:n,queryAll:r,onCatalogSelect:a,onPrivilegesSelect:s,onCreateClick:l,isPrivilegeSelected:c}){const d=e=>{const t=e.target;a(parseInt(t.value))},p=()=>{s(r(".create-privileges select option").filter((e=>e.selected)).map((e=>e.value)))};function u(){const t=M.value(o);return pt`
			<div class=create-content>
				${t.length?pt`
					<h5>Select content for this view</h5>
					<select @change=${d}>
						${e?null:pt`
								<option disabled selected>
									(select video content)
								</option>
							`}
						${t.map((({provider:e,type:t,title:i},o)=>pt`
							<option value=${o} ?selected=${o===n}>
								${`${e} ${t} ${i}`}
							</option>
						`))}
					</select>
				`:pt`
					<p>no available video content (are your video accounts linked?)</p>
				`}
			</div>
		`}function h(){const t=M.value(i);return pt`
			<div class="create-privileges" ?data-visible=${e}>
				<h5>Select which privileges have access</h5>
				<select multiple @change=${p}>
					${t.map((e=>pt`
						<option
							?selected=${c(e.privilegeId)}
							value="${e.privilegeId}">
								${e.label}
						</option>
					`))}
				</select>
			</div>
		`}return nn(M.combine(o,i),(()=>pt`
		<div class=viewcreator>
			<h4>Assign Video Content</h4>
			<div class=selectionarea>
				${u()}
				${h()}
			</div>
			<div class=buttonbar>
				<xio-button
					class=create-button
					?disabled=${t}
					@press=${l}>
						Assign To This Video
				</xio-button>
			</div>
		</div>
	`))}var Xa=ut`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><g transform="rotate(180 8 8)"><g fill="currentColor"><path fill-rule="evenodd" d="M7.022 1.566a1.13 1.13 0 0 1 1.96 0l6.857 11.667c.457.778-.092 1.767-.98 1.767H1.144c-.889 0-1.437-.99-.98-1.767L7.022 1.566z"/></g></g></svg>`;function Qa({queryAll:e,contentModel:t,requestUpdate:i}){const{readable:o,writable:n,subscribe:r}=W({open:!1,selectedContent:void 0,selectedPrivileges:[]}),a=()=>{n.open=!n.open};return{render:function(i){const r=t.getView(i);return pt`
			<h3 class=controls-title ?data-open=${o.open}>
				<div>
					<span>video display controls</span>
					<span>label = <em>"${i}"</em></span>
				</div>
				<xio-button
					class=togglebutton
					title="${o.open?"close":"open"} video controls"
					@press=${a}>
						${Xa}
				</xio-button>
			</h3>
			${o.open?pt`
				${r?ya({view:r,onDeleteClick:()=>t.deleteView(i),getPrivilegeDisplay:e=>t.getPrivilege(e)}):Fa({queryAll:e,catalogOp:t.state.catalogOp,privilegesOp:t.state.privilegesOp,isContentSelected:void 0!==o.selectedContent,selectedContent:o.selectedContent,isCreateButtonDisabled:void 0===o.selectedContent||0===o.selectedPrivileges.length,onCatalogSelect:e=>{n.selectedContent=e,n.selectedPrivileges=[]},isPrivilegeSelected:e=>o.selectedPrivileges.some((t=>t===e)),onPrivilegesSelect:e=>{n.selectedPrivileges=e},onCreateClick:()=>{const{selectedContent:e,selectedPrivileges:r}=o;n.selectedContent=void 0,n.selectedPrivileges=[];const a=t.catalog[e];t.setView({label:i,privileges:r,reference:{id:a.id,type:a.type,provider:a.provider}})}})}
			`:null}
		`},subscribe:()=>r(i)}}var Ja,Ka,Ya,Za,Ga,es=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},ts=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let is=class extends(Xt()(ei)){constructor(){super(...arguments),Ja.add(this),this.label="default",this["mock-embed"]=!1,this["show-title"]=!1,Ya.set(this,function(){const e=new Map;return{obtain(t,i){if("dacast"!==t.provider)throw new Error(`unsupported video provider "${t.provider}"`);let o=e.get(t.id);if(!o){o=Ba("div",{"data-id":t.id});const n=i?Ba("img",{part:"iframe",alt:"",src:"https://source.unsplash.com/random/480x270?"+Ha++}):Ba("iframe",{src:Wa(t.embed),part:"iframe",allowfullscreen:"",webkitallowfullscreen:"",mozallowfullscreen:"",oallowfullscreen:"",msallowfullscreen:"",frameborder:"0",scrolling:"no",allow:"autoplay"});o.appendChild(n),e.set(t.id,o)}return o}}}()),Za.set(this,(()=>{const e=Qa({contentModel:ts(this,Ja,"a",Ka),requestUpdate:()=>this.requestUpdate(),queryAll:e=>Array.from(this.shadowRoot.querySelectorAll(e))});return this.addSubscription(e.subscribe),e})())}async init(){await ts(this,Ja,"a",Ka).initializeForVideo(this.label)}render(){return nn(ts(this,Ja,"a",Ka).state.accessOp,(()=>pt`
			${ts(this,Ja,"a",Ka).allowance.canModerateVideos?ts(this,Za,"f").render(this.label):null}
			${ts(this,Ja,"m",Ga).call(this)}
		`))}};Ya=new WeakMap,Za=new WeakMap,Ja=new WeakSet,Ka=function(){return this.share.contentModel},Ga=function(){var e;const t=ts(this,Ja,"a",Ka).getShow(this.label);return t?t.details?pt`
					${this["show-title"]?pt`<h4 part=title>${t.details.title}</h4>`:null}
					${null!==(e=ts(this,Ya,"f").obtain(t.details,this["mock-embed"]))&&void 0!==e?e:"(embed missing)"}
					<slot></slot>
				`:pt`<slot name=unprivileged></slot>`:pt`<slot name=unavailable></slot>`},es([jt({type:String})],is.prototype,"label",void 0),es([jt({type:Boolean,reflect:!0})],is.prototype,"mock-embed",void 0),es([jt({type:Boolean,reflect:!0})],is.prototype,"show-title",void 0),is=es([zt(La)],is);var os,ns,rs=je`

:host {
	display: block;
}

`,as=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},ss=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let ls=class extends(Xt()(ei)){constructor(){super(...arguments),os.add(this),this.label="default"}init(){ss(this,os,"a",ns).initializeForVideo(this.label)}render(){const e=ss(this,os,"a",ns).getShow(this.label),{accessOp:t,showsOp:i}=ss(this,os,"a",ns).state;return nn(M.combine(t,i),(()=>e?e.details?pt`<slot></slot>`:pt`<slot name=unprivileged></slot>`:pt`<slot name=unavailable></slot>`))}};function cs({models:e}){const{dacastModel:t,contentModel:i}=e.videoModels;return{XiomeVideoHosting:Ht(t.subscribe)(Ft({dacastModel:t})(za)),XiomeVideoDisplay:Ht(i.subscribe)(Ft({contentModel:i})(is)),XiomeVideoViews:Ht(i.subscribe)(Ft({contentModel:i})($a)),XiomeVideoCompanion:Ht(i.subscribe)(Ft({contentModel:i})(ls))}}os=new WeakSet,ns=function(){return this.share.contentModel},as([jt({type:String})],ls.prototype,"label",void 0),ls=as([zt(rs)],ls);var ds=je`

:host {
	display: block;
}

`,ps=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a};let us=class extends(Xt()(ei)){get state(){return this.share.exampleModel.state}render(){return nn(this.state.accessOp,(e=>pt`
			<p>Example Component</p>
			${(null==e?void 0:e.user)?pt`<p>Welcome, ${e.user.profile.nickname}</p>`:pt`<p>User is not logged in.</p>`}
		`))}};function hs({models:e,modals:t}){const{exampleModel:i}=e;return{XiomeExample:Ht(i.subscribe)(Ft({modals:t,exampleModel:i})(us))}}us=ps([zt(ds)],us);var fs=je`

/* * {
	outline: 1px solid #f002;
} */

:host {
	display: block;
	max-width: 42em;
	--like-color: var(--xiome-questions-like-color, cyan);
	--report-color: var(--xiome-questions-report-color, #f90);
}

.questions-moderation-panel {
	padding: 1em;
	border: 1px dotted;
	margin-bottom: 1em;
}

.questions-moderation-panel .purge-button {
	--xio-button-hover-color: red;
}

slot[name="empty"] {
	display: block;
	margin-top: 1em;
}

[part="questions-list"] {
	list-style: none;

}

[part="questions-list"] > li {
	margin-top: 2em;
}

${je`

${je`

[data-vote] {
	display: block;
	border: none;
	font: inherit;
	background: transparent;
	color: inherit;
}

[data-vote] {
	cursor: pointer;
	opacity: 0.6;
	user-select: none;
}

[data-vote="report"] {
	opacity: 0.4;
}

[data-vote]:not([disabled]):hover,
[data-vote]:not([disabled]):focus {
	opacity: 1;
}

[data-vote][disabled] {
	cursor: default;
}

[data-vote="like"][data-active] {
	color: var(--like-color);
}

[data-vote="report"][data-active] {
	color: var(--report-color);
}

[data-vote] > span {
	vertical-align: middle;
}

[data-vote] > span:nth-child(2) {
	font-size: 0.9em;
}

[data-vote] svg {
	width: 1.4em;
	height: 1.4em;
	position: relative;
	top: 0.1em;
}

`}

.post {
	display: grid;
	grid-template-rows: auto;
	grid-template-columns: auto 1fr auto;
	grid-template-areas:
		".... tophat    ...."
		"bar1 bubble    bar2"
		".... buttonbar ....";
}

a {
	opacity: 0.5;
	color: inherit;
	text-decoration: none;
}

a:hover, a:focus {
	opacity: 0.8;
	text-decoration: underline;
}

/*
** normal questions
*/

.post .tophat { grid-area: tophat }
.post .bar1 { grid-area: bar1 }
.post .bar2 { grid-area: bar2 }
.post .bubble { grid-area: bubble }
.post .buttonbar { grid-area: buttonbar }

.post .bar {
	padding: 0.5em;
	padding-top: 0.2em;
	display: flex;
	flex-direction: column;
}

.post .bar > * + * {
	margin-top: 0.1em;
}

.post .bar.bar2 {
	padding-top: 0;
}

.post .metabar {
	font-size: 0.7em;
	padding: 0 1.5em;
	opacity: 0.6;
}

.post .tophat xio-profile-card {
	width: 100%;
}

.post .bubble {
	flex: 1 1 auto;
	/* padding-left: 1em; */
}

.post .bubble xio-text-input {
	--xio-text-input-border-radius: 0 1em 1em 1em;
	--xio-text-input-pad: 0.5em;
}

.post .bubble .textbox p {
	border-radius: 0 1em 1em 1em;
	border: 1px solid;
	padding: 0.5em;
	min-height: 4em;
}

.post [part="bubble"] {
	white-space: pre-wrap;
}

/*
** question editor
*/

.intro {
	margin-bottom: 1em;
}

.intro .heading {
	font-size: 2em;
}

.post.editor .buttonbar {
	text-align: right;
	padding: 0.5em;
}

.post.editor {
	padding-bottom: 2em;
	margin-bottom: 2em;
	border-bottom: 1px dashed;
}

`}

[part="answers-list"] {
	list-style: none;
	margin-left: 3.4em;
	margin-right: 1em;
	margin-bottom: 1em;
}

[part="answers-list"] > li {
	
	margin-top: 1em;
}

@media (max-width: 420px) {
	[part="answers-list"] {
		margin-left: 1em;
		margin-right: 0;
	}
	[part="answers-list"] > li {
		border-left: 1px solid;
	}
}

/*
** question editor
*/

.editor .intro {
	margin-bottom: 1em;
}

.editor .intro .heading {
	font-size: 2em;
}

.editor .buttonbar {
	text-align: right;
	padding: 0.5em;
}

.question-editor {
	padding-bottom: 2em;
	margin-bottom: 2em;
	border-bottom: 1px dashed;
}

/*
** answer editor
*/

.answer-editor {
	border: 1px dashed;
	margin-left: 5em;
	margin-top: 1em;
}

.answer-editor .intro {
	padding: 1em;
}

`;const ms=1*ea;function bs(e,t){const i=vs(e),o=vs(t);return i>o?-1:o<i?1:0}function vs({timePosted:e,likes:t,reports:i}){return e+gs(t,ms)-gs(i,1728e5)}function gs(e,t){return(0===e?0:1+Math.log10(e))*t}const ws=rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(10),pn(280),(e=>e.length>0&&0===e.trim().length?["can't be all whitespace"]:[]));function ys({content:e,editable:t,timePosted:i,handleValueChange:o=(()=>{})}){const{date:n,time:r}=en(i);return pt`
		<div class=bubble ?data-editable=${t}>
			<div class=textbox>
				${t?pt`
						<xio-text-input
							exportparts="textinput: bubble"
							textarea
							.validator=${ws}
							@valuechange=${o}
						></xio-text-input>
					`:pt`
						<p part=bubble>${e}</p>
					`}
			</div>
			<div class=metabar>
				<p>${`${n} ${r}`}</p>
			</div>
		</div>
	`}function xs(e){return t=>{t.preventDefault(),e()}}var $s;!function(e){e[e.Question=0]="Question",e[e.Answer=1]="Answer",e[e.Editor=2]="Editor"}($s||($s={}));var ks=ut`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M6.736 4C4.657 4 2.5 5.88 2.5 8.514c0 3.107 2.324 5.96 4.861 8.12a29.66 29.66 0 0 0 4.566 3.175l.073.041l.073-.04c.271-.153.661-.38 1.13-.674c.94-.588 2.19-1.441 3.436-2.502c2.537-2.16 4.861-5.013 4.861-8.12C21.5 5.88 19.343 4 17.264 4c-2.106 0-3.801 1.389-4.553 3.643a.75.75 0 0 1-1.422 0C10.537 5.389 8.841 4 6.736 4zM12 20.703l.343.667a.75.75 0 0 1-.686 0l.343-.667zM1 8.513C1 5.053 3.829 2.5 6.736 2.5C9.03 2.5 10.881 3.726 12 5.605C13.12 3.726 14.97 2.5 17.264 2.5C20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262a31.146 31.146 0 0 1-5.233 3.576l-.025.013l-.007.003l-.002.001l-.344-.666l-.343.667l-.003-.002l-.007-.003l-.025-.013A29.308 29.308 0 0 1 10 20.408a31.147 31.147 0 0 1-3.611-2.632C3.8 15.573 1 12.332 1 8.514z" fill="currentColor"/></svg>`,Os=ut`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M14 20.408c-.492.308-.903.546-1.192.709c-.153.086-.308.17-.463.252h-.002a.75.75 0 0 1-.686 0a16.709 16.709 0 0 1-.465-.252a31.147 31.147 0 0 1-4.803-3.34C3.8 15.572 1 12.331 1 8.513C1 5.052 3.829 2.5 6.736 2.5C9.03 2.5 10.881 3.726 12 5.605C13.12 3.726 14.97 2.5 17.264 2.5C20.17 2.5 23 5.052 23 8.514c0 3.818-2.801 7.06-5.389 9.262A31.146 31.146 0 0 1 14 20.408z" fill="currentColor"/></svg>`;function Ss({title:e,dataVote:t,voteCount:i,voteCasted:o,icon:n,castVote:r}){const a=r?o?()=>r(!1):()=>r(!0):()=>{};return pt`
		<button
			tabindex=0
			data-vote="${t}"
			?data-active=${o}
			?disabled=${!r}
			title="${e}"
			@click=${a}>
				<span>${n}</span>
				<span>${i}</span>
		</button>
	`}function As(e){return Ss({dataVote:"like",icon:e.liked?Os:ks,title:e.liked?"unlike this post":"like this post",voteCount:e.likes,voteCasted:e.liked,castVote:e.castLikeVote?t=>e.castLikeVote(t):void 0})}var Ps=ut`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" width="1em" height="1em" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);" preserveAspectRatio="xMidYMid meet" viewBox="0 0 20 20"><g fill="none"><path d="M8.686 2.852L2.127 14.777A1.5 1.5 0 0 0 3.441 17H16.56a1.5 1.5 0 0 0 1.314-2.223L11.314 2.852a1.5 1.5 0 0 0-2.628 0zM10 6.75a.75.75 0 0 1 .75.75v4a.75.75 0 0 1-1.5 0v-4a.75.75 0 0 1 .75-.75zm.75 7a.75.75 0 1 1-1.5 0a.75.75 0 0 1 1.5 0z" fill="currentColor"/></g></svg>`;function Cs(e){return Ss({dataVote:"report",icon:e.reported?Ps:si,title:e.reported?"unreport this post":"report this post",voteCount:e.reports,voteCasted:e.reported,castVote:e.castReportVote?t=>e.castReportVote(t):void 0})}function Is({postOptions:e,bar1:t,bubble:i,bar2:o,buttonBar:n}){var r;return pt`
		<div class=post data-post-id="${null!==(r=e.postId)&&void 0!==r?r:""}">
			<div class=tophat>
				<xio-profile-card .user=${e.author} show-details></xio-profile-card>
			</div>
			<div class="bar bar1">
				${t}
			</div>
			${i}
			<div class="bar bar2">
				${o}
			</div>
			${n?pt`
					<div class=buttonbar>
						${n}
					</div>
				`:null}
		</div>
	`}function Ms(e){const{author:t,content:i,timePosted:o,...n}=e;switch(n.type){case $s.Question:{const{liking:t,reporting:r,deletePost:a,toggleAnswerEditor:s}=n;return Is({postOptions:e,bar1:pt`
					${As(t)}
				`,bubble:ys({content:i,timePosted:o,editable:!1,handleValueChange:void 0}),bar2:pt`
					${Cs(r)}
					${a?pt`<a href="#" @click=${xs(a)}>delete</a>`:null}
					${s?pt`<a href="#" @click=${xs(s)}>answer</a>`:null}
				`,buttonBar:void 0})}case $s.Answer:{const{liking:t,reporting:r,deletePost:a}=n;return Is({postOptions:e,bar1:pt`
					${As(t)}
				`,bubble:ys({content:i,timePosted:o,editable:!1,handleValueChange:void 0}),bar2:pt`
					${Cs(r)}
					${a?pt`<a href="#" @click=${xs(a)}>delete</a>`:null}
				`,buttonBar:void 0})}case $s.Editor:{const{isPostable:t,postButtonText:r,changeDraftContent:a,submitPost:s}=n;return Is({postOptions:e,bar1:null,bubble:ys({content:i,timePosted:o,editable:!0,handleValueChange:a}),bar2:null,buttonBar:pt`
					<xio-button
						?disabled=${!t}
						@click=${s}
							>${r}</xio-button>
				`})}}}function Es({now:e,question:t,modals:i,boardModel:o,answerEditor:n}){const{questionId:r}=t,a=o.getAccess(),s=o.getPermissions(),l=o.getUser(t.authorUserId),c=(()=>{const e=!(!a||!a.user)&&a.user.userId===l.userId;return{canDelete:s["moderate questions"]||e,canAnswer:s["answer questions"],canLike:s["like questions"],canReport:s["report questions"]}})(),d=n.state,p=e=>{var t;const i=(null===(t=null==a?void 0:a.user)||void 0===t?void 0:t.userId)===e.authorUserId;return s["moderate questions"]||i};return pt`
		${Ms({type:$s.Question,author:l,content:t.content,deletePost:c.canDelete?async()=>{await i.confirm({title:"Delete question?",body:"Are you sure you want to delete this question? This cannot be undone.",yes:{vibe:"negative",label:"Delete question"},no:{vibe:"neutral",label:"Nevermind"},focusNthElement:2})&&await o.archiveQuestion(r,!0)}:void 0,liking:{liked:t.liked,likes:t.likes,castLikeVote:c.canLike?e=>{o.likeQuestion(r,e)}:void 0},postId:t.questionId,reporting:{reported:t.reported,reports:t.reports,castReportVote:c.canReport?async e=>{(!e||await i.confirm({title:"Report question?",body:"Are you sure you want to submit a report against this question?",yes:{vibe:"negative",label:"Submit report"},no:{vibe:"neutral",label:"Nevermind"},focusNthElement:2}))&&await o.reportQuestion(r,e)}:void 0},timePosted:t.timePosted,toggleAnswerEditor:c.canAnswer?n.actions.toggleEditMode:void 0})}
		${d.editMode?function({now:e,boardModel:t,answerEditor:i}){const o=i.state;return pt`
		<div class="editor answer-editor">
			<div class=intro>
				<p class=heading>Post your answer</p>
			</div>
			${Ms({author:t.getAccess().user,type:$s.Editor,timePosted:e,postButtonText:"post answer",content:o.draftText,isPostable:o.isPostable,submitPost:i.submitAnswer,changeDraftContent:i.actions.handleValueChange})}
		</div>
	`}({now:e,boardModel:o,answerEditor:n}):null}
		${t.answers.length?pt`
			<ol part=answers-list>
				${t.answers.map((e=>pt`
					<li part=answer data-answer-id="${e.answerId}">
						${function({answer:e,questionId:t,modals:i,boardModel:o,canDeleteAnswer:n}){const r=o.getPermissions(),a=r["like questions"],s=r["report questions"];return Ms({type:$s.Answer,postId:e.answerId,author:o.getUser(e.authorUserId),content:e.content,timePosted:e.timePosted,liking:{liked:e.liked,likes:e.likes,castLikeVote:a?i=>o.likeAnswer(t,e.answerId,i):void 0},reporting:{reported:e.reported,reports:e.reports,castReportVote:s?async n=>{(!n||await i.confirm({title:"Report answer?",body:"Are you sure you want to submit a report against this answer?",yes:{vibe:"negative",label:"Submit report"},no:{vibe:"neutral",label:"Nevermind"},focusNthElement:2}))&&await o.reportAnswer(t,e.answerId,n)}:void 0},deletePost:n(e)?async()=>{await i.confirm({title:"Delete answer?",body:"Are you sure you want to delete this answer? This cannot be undone.",yes:{vibe:"negative",label:"Delete answer"},no:{vibe:"neutral",label:"Nevermind"},focusNthElement:2})&&await o.archiveAnswer(t,e.answerId,!0)}:void 0})}({answer:e,modals:i,questionId:r,boardModel:o,canDeleteAnswer:p})}
					</li>
				`))}
			</ol>
		`:null}
	`}function Rs(){const e=W({editMode:!1,draftText:"",isPostable:!1});return{...e,actions:{toggleEditMode(){e.writable.editMode=!e.writable.editMode},handleValueChange(t){e.writable.draftText=t.detail.value,e.writable.isPostable=!!e.writable.draftText}}}}function Ts({requestUpdate:e,getTextInput:t,getBoardModel:i}){const o=Rs();o.subscribe(e);return{state:o.readable,actions:o.actions,subscribe:o.subscribe,getTextInput:t,submitQuestion:async()=>{const{draftText:e}=o.readable;t().text="",await i().postQuestion({content:e})}}}function _s({requestUpdate:e,getBoardModel:t,getTextInput:i}){const o=Dn()((o=>{const n=Rs();n.subscribe(e);return{state:n.readable,actions:n.actions,subscribe:n.subscribe,submitAnswer:async()=>{const{draftText:e}=n.readable;i(o).text="",n.actions.toggleEditMode(),await t().postAnswer(o,{content:e})}}}));return e=>o(e)}var js,Ds,qs,Us,Ns=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},zs=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i},Ls=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let Bs=class extends(function(e){return function(t){var i,o;return o=class extends t{constructor(){super(...arguments),i.set(this,void 0)}tick(){}connectedCallback(){super.connectedCallback(),Qt(this,i,setInterval((()=>{this.tick(),this.requestUpdate()}),e),"f")}disconnectedCallback(){super.disconnectedCallback(),clearInterval(Jt(this,i,"f"))}},i=new WeakMap,o}}(1e3)(Xt()(ei))){constructor(){super(...arguments),js.set(this,void 0),Ds.set(this,Ts({getBoardModel:()=>Ls(this,js,"f"),requestUpdate:()=>this.requestUpdate(),getTextInput:()=>this.shadowRoot.querySelector(".question-editor xio-text-input")})),qs.set(this,_s({getBoardModel:()=>Ls(this,js,"f"),requestUpdate:()=>this.requestUpdate(),getTextInput:e=>this.shadowRoot.querySelector(`[part="questions-list"] li[data-question-id="${e}"] xio-text-input`)})),Us.set(this,Date.now()),this.board="default"}tick(){zs(this,Us,Date.now(),"f")}init(){zs(this,js,this.share.questionsModel.makeBoardModel(this.board),"f"),Ls(this,js,"f").loadQuestions()}renderQuestionsBoard(){var e;const t=Ls(this,Us,"f"),{modals:i}=this.share,o=Ls(this,Ds,"f"),{archiveBoard:n}=Ls(this,js,"f"),r=Ls(this,js,"f").getAccess(),a=Ls(this,js,"f").getBoardName(),s=Ls(this,js,"f").getBoardOp(),l=Ls(this,js,"f").getPostingOp(),c=Ls(this,js,"f").getPermissions(),d=function(e,t){const i=[],o=[];for(const n of e)t&&n.authorUserId===t?i.push(n):o.push(n);return[...i.sort(bs),...o.sort(bs)]}(Ls(this,js,"f").getQuestions(),null===(e=null==r?void 0:r.user)||void 0===e?void 0:e.userId);return nn(s,(()=>pt`

			${c["moderate questions"]?function({modals:e,board:t,archiveBoard:i}){return pt`
		<div class=questions-moderation-panel>
			<h3>moderate questions board "${t}"</h3>
			<xio-button
				class=purge-button
				@press=${async()=>{await e.confirm({title:"Purge questions?",body:`Are you sure you want to delete all the questions on the board "${t}"? This cannot be undone.`,yes:{vibe:"negative",label:"Purge all"},no:{vibe:"neutral",label:"Nevermind"},focusNthElement:2})&&await i()}}>
					Purge all questions
			</xio-button>
		</div>
	`}({modals:i,board:a,archiveBoard:n}):null}

			${c["post questions"]?function({now:e,access:t,postingOp:i,questionEditor:o}){const n=null==t?void 0:t.user,r=o.state;return nn(i,(()=>pt`
		<div class="editor question-editor" part=question-editor>
			<div class=intro>
				<p class=heading>Post a new question</p>
			</div>
			${Ms({type:$s.Editor,author:n,content:r.draftText,isPostable:r.isPostable,timePosted:e,postButtonText:"post question",submitPost:o.submitQuestion,changeDraftContent:o.actions.handleValueChange})}
		</div>
	`))}({now:t,access:r,postingOp:l,questionEditor:o}):null}

			${d.length>0?pt`
					<ol part=questions-list>
						${d.map((e=>pt`
							<li data-question-id="${e.questionId}">
								${Es({question:e,now:Ls(this,Us,"f"),modals:this.share.modals,boardModel:Ls(this,js,"f"),answerEditor:Ls(this,qs,"f").call(this,e.questionId)})}
							</li>
						`))}
					</ol>
				`:pt`<slot name=empty><p>Be the first to post a question!</p></slot>`}
		`))}render(){return Ls(this,js,"f")&&Ls(this,js,"f").getBoardOp()?this.renderQuestionsBoard():null}};function Vs({models:e,modals:t}){const{questionsModel:i}=e;return{XiomeQuestions:Ht(i.subscribe)(Ft({modals:t,questionsModel:i})(Bs))}}js=new WeakMap,Ds=new WeakMap,qs=new WeakMap,Us=new WeakMap,Ns([jt({type:String,reflect:!0})],Bs.prototype,"board",void 0),Bs=Ns([zt(fs)],Bs);var Ws=je`

.container {
	display: block;
	width: 100%;
	max-width: 36em;
	padding: 0.5em !important;
	border: 1px solid;
}

.results {
	margin-top: 0.5em;
}

.userlist {
	list-style: none;
}

.userlist > li {
	display: flex;
	flex-direction: column;
	flex-wrap: wrap;
	background: #0002;
	padding: 0.5em;
	margin-top: 0.5em;
}

.userinfo {
	display: flex;
	flex-direction: row;
}

.userinfo xio-profile-card {
	flex: 1 1 auto;
}

.userinfo .controls {
	margin-left: 1em;
}

.userinfo .controls .edit[data-edit-mode] {
	color: lime;
	--xio-button-hover-color: lime;
}

.editwidget > div {
	margin-top: 1em;
}

.editwidget header + * {
	margin-top: 0.25em;
}

.editwidget header small {
	font-size: inherit;
	opacity: 0.6;
}

.editwidget ul {
	list-style: none;
}

.editwidget .allprivileges li {
	display: inline-block;
	font-size: 0.75em;
	padding: 0.1em 0.3em;
	margin: 0.2em 0.1em;
	border: 1px solid;
	border-radius: 1em;
}

`;function Hs(e){return[...e.filter((e=>e.assignable)),...e.filter((e=>!e.assignable))]}function Fs(e,t){return pt`
		<xio-button
			?disabled=${!e.assignable}
			title=${e.roleId}
			data-role-id=${e.roleId}
			@press=${()=>t(e)}>
				${e.label}
		</xio-button>
	`}function Xs(e){return pt`
		<li
			title="${e.privilegeId}"
			data-privilege-id="${e.privilegeId}">
				${e.label}
		</li>
	`}const Qs=rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(1),pn(64));var Js,Ks,Ys=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},Zs=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},Gs=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};let el=class extends(Xt()(ei)){constructor(){super(...arguments),this.userResults=M.ready([]),this.updateLocalUserResultsCache={assignRole:(e,t)=>{if(!M.ready(this.userResults))throw new Error("error updating user cache");const i=M.value(this.userResults);this.userResults=M.ready(i.map((i=>i.user.userId===e?{user:i.user,roleIds:[...i.roleIds,t]}:i)))},revokeRole:(e,t)=>{if(!M.ready(this.userResults))throw new Error("error updating user cache");const i=M.value(this.userResults);this.userResults=M.ready(i.map((i=>i.user.userId===e?{user:i.user,roleIds:i.roleIds.filter((e=>e!==t))}:i)))}},this.userStates=function({getUserResultsOp:e,rerender:t}){const i=new Map;return{cleanupObsoleteStates:function(){const t=[],o=e();if(M.ready(o)){const e=M.value(o);for(const o of i.keys())!e.find((({user:e})=>e.userId===o))&&t.push(o)}for(const e of t)i.delete(e)},obtainStateForUser:function(e){let o=i.get(e);if(!o){const n={editMode:!1,toggleEditMode(){n.editMode=!n.editMode,t()}};o=n,i.set(e,o)}return o}}}({getUserResultsOp:()=>this.userResults,rerender:()=>this.requestUpdate()}),Js.set(this,""),Ks.set(this,""),this.commitSearch=async()=>{const e=Zs(this,Js,"f")===Zs(this,Ks,"f");Gs(this,Ks,Zs(this,Js,"f"),"f"),e||(this.userResults=M.ready([]),Zs(this,Js,"f")&&await M.operation({setOp:e=>this.userResults=e,promise:this.share.administrativeModel.searchUsers({term:Zs(this,Js,"f")})})),this.userStates.cleanupObsoleteStates()},this.commitSearchSoon=q(1e3,this.commitSearch),this.searchChange=e=>{var t;Gs(this,Js,null!==(t=e.detail.value)&&void 0!==t?t:"","f"),this.commitSearchSoon()},this.enterPress=()=>{this.commitSearch()}}init(){this.share.administrativeModel.initialize()}render(){const{permissionsOp:e}=this.share.administrativeModel.state,t=this.share.administrativeModel.isAllowed("administrate user roles"),i=t=>{const{user:i}=t,o=this.userStates.obtainStateForUser(i.userId);return pt`
				<li>
					<div class=userinfo>
						<xio-profile-card
							.user=${i}
							show-details
						></xio-profile-card>
						<div class=controls>
							<xio-button
								class=edit
								?data-edit-mode=${o.editMode}
								@press=${o.toggleEditMode}>
									${Jn}
							</xio-button>
						</div>
					</div>
					${o.editMode?nn(e,(e=>function({permissions:e,administrativeModel:t,updateLocalUserResultsCache:i,userResult:{user:{userId:o},roleIds:n},blur:r,search:a}){const s=Hs(n.map((t=>e.roles.find((e=>e.roleId===t)))).filter((e=>!!e))),l=Hs(e.roles.filter((e=>!n.includes(e.roleId))).filter((e=>!!e))),c=e.privileges.filter((t=>{const i=e.rolesHavePrivileges.filter((e=>e.active&&e.privilegeId===t.privilegeId)),o=i.filter((e=>n.includes(e.roleId)));return o.length>0}));async function d(){var e,i;o===(null===(i=null===(e=t.getAccess())||void 0===e?void 0:e.user)||void 0===i?void 0:i.userId)&&await t.reauthorize()}async function p({roleId:e}){await t.assignRoleToUser({userId:o,roleId:e,isPublic:!0,timeframeEnd:void 0,timeframeStart:void 0}),i.assignRole(o,e),r(),await d(),await a()}async function u({roleId:e}){await t.revokeRoleFromUser({userId:o,roleId:e}),i.revokeRole(o,e),r(),await d(),await a()}return pt`
		<div class=editwidget>
			<div class=available>
				<header>roles available <small>(click to assign)</small></header>
				<div>
					${l.map((e=>Fs(e,p)))}
				</div>
			</div>
			<div class=assigned>
				<header>roles assigned <small>(click to revoke)</small></header>
				<div>
					${s.map((e=>Fs(e,u)))}
				</div>
			</div>
			<div class=allprivileges>
				<header>user has these privileges</header>
				<ul>
					${c.map(Xs)}
				</ul>
			</div>
		</div>
	`}({userResult:t,permissions:e,administrativeModel:this.share.administrativeModel,updateLocalUserResultsCache:this.updateLocalUserResultsCache,blur:()=>{const e=document.activeElement;e&&e.blur()},search:()=>this.commitSearch()}))):null}
				</li>
			`};return pt`
			<div class=container>

				${t?pt`
					<xio-text-input
						placeholder="search for users"
						.validator=${Qs}
						@valuechange=${this.searchChange}
						@enterpress=${this.enterPress}
					></xio-text-input>

					<div class=results>
						${nn(this.userResults,(e=>e.length>0?pt`
								<ol class=userlist>
									${e.map(i)}
								</ol>
							`:pt`
								<div class=noresults>
									no results
								</div>
							`))}
					</div>
				`:pt`
					<p>you are not permitted to administrate user roles</p>
				`}

			</div>
		`}};function tl({models:e,modals:t}){const{administrativeModel:i}=e;return{XiomeManageUsers:Ht(i.subscribe)(Ft({modals:t,administrativeModel:i})(el))}}Js=new WeakMap,Ks=new WeakMap,Ys([jt()],el.prototype,"userResults",void 0),el=Ys([zt(Ws)],el);var il,ol,nl=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};class rl extends(Xt()(ei)){constructor(){super(...arguments),il.add(this)}async init(){await nl(this,il,"a",ol).initialize()}renderStripeConnectControls(){const e=nl(this,il,"a",ol).snap.readable,{connectStatusOp:t}=e.stripeConnect,{connectDetailsOp:i}=e.stripeConnect,{isOnboardingNeeded:o,isAllowedToOnboard:n,stripeAccountOnboarding:r,stripeLogin:a}=nl(this,il,"a",ol).connect,s=o&&n;return nn(t,(e=>{const t=M.value(i);function o(){return pt`
					<xio-button @press=${a}>
						Login to Stripe
					</xio-button>
					${s?pt`
							<xio-button @press=${r}>
								Onboard Stripe Account
							</xio-button>
						`:null}
				`}function n(){return pt`
					<p>details:</p>
					<ul>
						<li>charges enabled: ${t.charges_enabled?"true":"false"}</li>
						<li>details submitted: ${t.details_submitted?"true":"false"}</li>
						<li>payouts enabled: ${t.payouts_enabled?"true":"false"}</li>
						<li>email: ${t.email}</li>
						<li>paused: ${t.paused}</li>
						<li>stripe account id: ${t.stripeAccountId}</li>
						<li>time linked: ${t.timeLinked}</li>
					</ul>
				`}switch(e){case xe.Unlinked:return pt`
					<p>status: unlinked</p>
					<xio-button @press=${r}>
						Onboard Stripe Account
					</xio-button>
				`;case xe.Incomplete:return pt`
					<p>status: incomplete</p>
					${n()}
					${o()}
				`;case xe.Paused:return pt`
					<p>status: paused</p>
					${n()}
					${o()}
				`;case xe.Ready:return t?pt`
							<p>status: ready</p>
							${n()}
							${o()}
						`:pt`
							<p>status: loading</p>
						`}}))}render(){const{allowance:e}=nl(this,il,"a",ol);return pt`
			<h3>Connect Stripe Account</h3>
			${e.connectStripeAccount?this.renderStripeConnectControls():pt`<p>your account is not allowed to control the linked stripe account</p>`}
		`}}il=new WeakSet,ol=function(){return this.share.storeModel};var al,sl,ll,cl=$o`
:host {
	display: block;
	width: max-content;
	border-radius: 5px;
}

.billing_area {
	display: flex;
	gap: 1em;
	align-items: center;
}
`,dl=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},pl=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let ul=class extends(Xt()(ei)){constructor(){super(...arguments),al.add(this)}render(){var e;const{paymentMethodOp:t}=pl(this,al,"a",sl).billing,{connectStatusOp:i}=pl(this,al,"a",sl).stripeConnect,o=M.value(i),n=null===(e=pl(this,al,"a",ll))||void 0===e?void 0:e.cardClues;return nn(M.combine(t,i),(()=>o!==xe.Ready?null:pt`
					<div class="billing_area">
						<xiome-store-customer-portal>
							<slot>billing settings</slot>
						</xiome-store-customer-portal>
						${n?pt`
								<div>
									<p>Payment Method</p>
									${n.brand} ${n.last4}
								</div>
							`:null}
					</div>
				`))}};al=new WeakSet,sl=function(){return this.share.storeModel.snap.readable},ll=function(){return M.value(pl(this,al,"a",sl).billing.paymentMethodOp)},ul=dl([zt(cl)],ul);var hl,fl,ml,bl,vl,gl,wl=$o``,yl=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},xl=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let $l=class extends(Xt()(ei)){constructor(){super(...arguments),hl.add(this),this.op=M.ready(void 0),ml.set(this,(async()=>{const{customerPortal:e}=xl(this,hl,"a",fl).billing;await M.operation({promise:e(),setOp:e=>this.op=e})}))}async init(){await xl(this,hl,"a",fl).initialize()}render(){const{accessOp:e}=xl(this,hl,"a",fl).state.user,{connectStatusOp:t}=xl(this,hl,"a",fl).state.stripeConnect,i=M.combine(e,t,this.op);return pt`
			${nn(i,(()=>{const{userLoggedIn:e,storeActive:t}=xl(this,hl,"a",fl).get.is;return e?t?xl(this,hl,"m",bl).call(this):xl(this,hl,"m",vl).call(this):xl(this,hl,"m",gl).call(this)}))}
		`}};ml=new WeakMap,hl=new WeakSet,fl=function(){return this.share.storeModel},bl=function(){return pt`
			<xio-button @press=${xl(this,ml,"f")}>
				<slot>
					billing panel
				</slot>
			</xio-button>
		`},vl=function(){return pt`
			<slot name="not-ready"></slot>
		`},gl=function(){return pt`
			<slot name="logged-out"></slot>
		`},yl([jt()],$l.prototype,"op",void 0),$l=yl([zt(wl)],$l);const kl={currency:"usd",interval:"month",price:0,stripePriceId:"FAKE_STRIPE_PRICE_ID"},Ol={basics:{tier:{active:!0,label:"Example Tier",pricing:[kl],roleId:"FAKE_ROLE_ID",tierId:"FAKE_TIER_ID",time:Date.now()},pricing:kl},context:{isSubscribedToThisTier:!0,status:$e.Active}};var Sl,Al=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},Pl=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};function Cl(e,t){var i,o,n,r,a,s;return s=class extends Rt{constructor(){var e;super(...arguments),i.set(this,0),o.set(this,0),n.set(this,new Map),r.set(this,new Set),a.set(this,{element:this,...(e=this,{attr:{string:new Proxy({},{get:(t,i)=>e.getAttribute(i),set:(t,i,o)=>(e.setAttribute(i,o.toString()),!0)}),boolean:new Proxy({},{get:(t,i)=>e.hasAttribute(i),set:(t,i,o)=>(o?e.setAttribute(i,""):e.removeAttribute(i),!0)})}}),setup:e=>{if(0===Al(this,i,"f")){const t=e(this);t&&Al(this,r,"f").add(t)}},state:e=>{const t=Al(this,o,"f");let i;Pl(this,o,Al(this,o,"f")+1,"f");return Al(this,n,"f").has(t)?i=Al(this,n,"f").get(t):(i="function"==typeof e?e(this):e,Al(this,n,"f").set(t,i)),[i,e=>{Al(this,n,"f").set(t,e),this.requestUpdate()}]}})}disconnectedCallback(){for(const e of Al(this,r,"f"))e();Al(this,r,"f").clear(),Pl(this,i,0,"f"),super.disconnectedCallback()}createRenderRoot(){var t;if(null===(t=e.shadow)||void 0===t||t)return super.createRenderRoot();{const t=document.createElement("style");t.textContent=e.styles.cssText;const i=document.createElement("div");return this.appendChild(t),this.appendChild(i),i}}render(){Pl(this,o,0,"f");const e=t(Al(this,a,"f"));return Pl(this,i,Al(this,i,"f")+1,"f"),e}},i=new WeakMap,o=new WeakMap,n=new WeakMap,r=new WeakMap,a=new WeakMap,s.styles=e.styles,s.properties=e.properties,s}function Il(e){return e?Math.round(100*parseFloat(e)):void 0}function Ml(e){return(e/100).toFixed(2)}!function(e){e[e.Buy=0]="Buy",e[e.Upgrade=1]="Upgrade",e[e.Downgrade=2]="Downgrade",e[e.Pay=3]="Pay",e[e.Cancel=4]="Cancel",e[e.Renew=5]="Renew"}(Sl||(Sl={}));const El=Cl({styles:$o`

:host {
	max-width: max-content;

	display: flex;
	flex-direction: column;
	justify-content: space-between;

	font: inherit;
	color: inherit;

	border: 1px solid;
	border-radius: 3px;
}

:host > div {
	padding: 0.5em;
}

[part~="tier_details"] {
	position: relative;

	text-align: center;
	flex-basis: 50%;

	[part~="tier_label"] {
		font-size: 1.5em;
	}

	[part~="tier_icon"] {
		position: absolute;
		top: -0.75em;
		right: -0.75em;
		width: 1.5em;
		height: 1.5em;
		padding: 0.2em;
		border-radius: 1em;
		background: currentColor;
		svg, [part~="tier_icon_content"] {
			width: 100%;
			height: 100%;
		}
		[part~="tier_icon_content"] { color: blue; }
		^[data-icon="check"] [part~="tier_icon_content"] { color: green; }
		^[data-icon="x"] [part~="tier_icon_content"] { color: red; }
		^[data-icon="warning"] [part~="tier_icon_content"] { color: orange; }
	}
}

[part~="tier_info"] {
	display: flex;
	flex-basis: 50%;
	align-items: center;
	flex-direction: column;
	justify-content: flex-end;
	gap: 0.2rem;
	background: #fff2;

	[part~="tier_button"] {
		padding: 0.3rem;
		border: 1px solid;
		border-radius: 5px;
		cursor: pointer;
		color: inherit;
		background: transparent;
		opacity: 0.7;

		^:is(:hover, :focus) {
			opacity: 1;
		}
	}
}

`,shadow:!0,properties:{basics:{type:Object},context:{type:Object},interactivity:{type:Object}}},(e=>{const{basics:{tier:t,pricing:i}=Ol.basics,context:{status:o,isSubscribedToThisTier:n}=Ol.context,interactivity:r}=e.element,a="month"===(null==i?void 0:i.interval)?"monthly":"yearly",s=function(e){switch(e){case $e.Unsubscribed:return;case $e.Active:return{name:"check",svg:Qi};case $e.Unpaid:return{name:"warning",svg:si};case $e.Cancelled:return{name:"x",svg:Zr}}}(o),l=function(e){switch(e){case $e.Unsubscribed:return"unsubscribed";case $e.Active:return"active";case $e.Unpaid:return"unpaid";case $e.Cancelled:return"cancelled"}}(o);return e.attr.string["data-tier"]=t.tierId,e.attr.string["data-status"]=l,e.attr.boolean["data-subscribed"]=n,pt`
		<div part=tier_details>
			${s?pt`
						<div part=tier_icon data-icon="${s.name}">
							<div part=tier_icon_content>
								${s.svg}
							</div>
						</div>
					`:null}
			<h4 part=tier_label>${t.label}</h4>
			<slot></slot>
			${i?pt`
					<xio-price-display
						unit-superscript
						value="${Ml(i.price)}">
							${t.label}
					</xio-price-display>
					<p>${a}</p>
				`:pt`
					<p style="color: red">price not set</p>
				`}
		</div>

		<div part=tier_info>
			${o!==$e.Unsubscribed?pt`<span part=tier_status>${l}</span>`:void 0}
			${r?function(){const e=function(e){switch(e){case Sl.Buy:return"buy";case Sl.Downgrade:return"downgrade";case Sl.Upgrade:return"upgrade";case Sl.Pay:return"pay";case Sl.Cancel:return"cancel";case Sl.Renew:return"renew"}}(r.button);return pt`
			<button part="${t="tier_button",`${t} ${t}_${e}`}" @click=${r.action}>
				${e}
			</button>
		`;var t}():void 0}
		</div>
	`}));var Rl,Tl,_l,jl,Dl,ql,Ul,Nl=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},zl=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};class Ll{constructor(e,t=(()=>{})){Rl.add(this),Tl.set(this,void 0),_l.set(this,new Map),jl.set(this,void 0),Dl.set(this,new Set),ql.set(this,(()=>{})),zl(this,Tl,e,"f"),zl(this,ql,t,"f"),zl(this,jl,new MutationObserver((()=>Nl(this,Rl,"m",Ul).call(this))),"f"),Nl(this,jl,"f").observe(e,Ll.parentObservationOptions),Nl(this,Rl,"m",Ul).call(this)}get(e){const t=e?`:scope > template[slot="${e}"]`:":scope > template:not([slot])",i=Nl(this,Tl,"f").querySelector(t);return null==i?void 0:i.content.cloneNode(!0)}}function Bl({tier:e,plan:t,subscription:i}){var o;const{tierId:n}=e,r=t.tiers.findIndex((e=>e.tierId===n)),a=i&&t.tiers.findIndex((e=>e.tierId===i.tierId)),s=!!i&&r===a,l=s&&null!==(o=null==i?void 0:i.status)&&void 0!==o?o:$e.Unsubscribed,c=i&&!s&&i.status===$e.Unpaid;return{subscription:i,status:l,tierIndex:r,subscribedTierIndex:a,isSubscribedToThisTier:s,isAnotherTierInPlanUnpaid:c}}Tl=new WeakMap,_l=new WeakMap,jl=new WeakMap,Dl=new WeakMap,ql=new WeakMap,Rl=new WeakSet,Ul=function e(){var t;for(const e of Nl(this,Dl,"f"))e.disconnect();Nl(this,_l,"f").clear(),Nl(this,Dl,"f").clear();const i=Array.from(Nl(this,Tl,"f").querySelectorAll(":scope > template"));for(const o of i){const i=null!==(t=o.getAttribute("slot"))&&void 0!==t?t:void 0;Nl(this,_l,"f").set(i,o);const n=new MutationObserver(Nl(this,ql,"f")),r=new MutationObserver((()=>{Nl(this,Rl,"m",e).call(this),Nl(this,ql,"f").call(this)}));n.observe(o.content,Ll.templateDeepObserverationOptions),r.observe(o,Ll.templateAttributeObserverationOptions),Nl(this,Dl,"f").add(n)}},Ll.parentObservationOptions={childList:!0},Ll.templateDeepObserverationOptions={childList:!0,attributes:!0,characterData:!0,subtree:!0},Ll.templateAttributeObserverationOptions={attributes:!0};var Vl=$o`

[data-card-list] {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
	gap: 1em;
}

[data-card] {
	display: flex;
	flex-direction: column;
	gap: 0.5em;
}

`;function Wl(e,t){e.setup((()=>t.subscribe((()=>e.element.requestUpdate()))))}const Hl=({storeModel:e})=>Cl({styles:Vl,shadow:!1,properties:{}},(t=>{Wl(t,e.snap);const[i]=t.state((()=>new Ll(t.element,(()=>t.element.requestUpdate())))),{stripeConnect:{connectStatusOp:o},subscriptions:{subscriptionPlansOp:n,mySubscriptionDetailsOp:r}}=e.state;return nn(M.combine(n,r,o),(()=>pt`
		<div data-card-list>
			${function(e){var t;return(null!==(t=e.get.subscriptions.mySubscriptionDetails)&&void 0!==t?t:[]).map((t=>{const i=e.get.subscriptions.plans.find((e=>e.planId===t.planId)),o=i.tiers.find((e=>e.tierId===t.tierId));return{plan:i,tier:o,subscription:t,pricing:t.pricing}}))}(e).map((e=>pt`
				<div data-card>
					<strong data-plan-label>${e.plan.label}</strong>
					<xiome-store-subscription-tier
						.basics=${e}
						.context=${Bl(e)}>
							${i.get(e.tier.tierId)}
					</xiome-store-subscription-tier>
				</div>
			`))}
		</div>
	`))}));function Fl({basics:{tier:e},context:{subscription:t,status:i,tierIndex:o,subscribedTierIndex:n,isAnotherTierInPlanUnpaid:r},modals:a,storeModel:s,setOp:l}){const{tierId:c}=e,{paymentMethod:d}=s.get.billing;switch(i){case $e.Unsubscribed:{const i=t?n>o?Sl.Downgrade:Sl.Upgrade:Sl.Buy;if(r)return;return{button:i,async action(){const o=function({modals:e,button:t,tier:i,storeModel:o}){const{subscriptions:n}=o,{stripePriceId:r}=i.pricing[0];return{upgradeOrDowngrade:async()=>{const o=t===Sl.Upgrade?"upgrade":"downgrade";await e.confirmAction({title:t===Sl.Upgrade?"upgrade subscription":"downgrade subscription",message:`are you sure you want to ${o} your subscription to ${i.label} for $${Ml(i.pricing[0].price)}/month?`,loadingMessage:`switching to ${i.label}`,actionWhenConfirmed:()=>n.purchase({stripePriceId:r,showLoadingSpinner:!0})})},buySubscriptionWithCheckoutPopup:async()=>{await n.purchase({stripePriceId:r})},buySubscriptionWithExistingPaymentMethod:async()=>{await e.confirmAction({title:"buy subscription",message:`are you sure you want to buy ${i.label} for $${Ml(i.pricing[0].price)}/month?`,actionWhenConfirmed:()=>n.purchase({stripePriceId:r}),loadingMessage:"purchasing subscription"})}}}({button:i,modals:a,storeModel:s,tier:e});switch(function({hasDefaultPaymentMethod:e,hasExistingSubscription:t}){return t?ke.Update:e?ke.UsePaymentMethod:ke.CheckoutPopup}({hasDefaultPaymentMethod:!!d,hasExistingSubscription:!!t})){case ke.Update:return o.upgradeOrDowngrade();case ke.UsePaymentMethod:return o.buySubscriptionWithExistingPaymentMethod();case ke.CheckoutPopup:return M.operation({setOp:l,promise:o.buySubscriptionWithCheckoutPopup()});default:throw new Error("unknown purchase scenario")}}}}case $e.Active:return{button:Sl.Cancel,action:async()=>a.confirmAction({title:"Cancel subscription",message:`are you sure you want to cancel your ${e.label} subscription`,loadingMessage:"cancelling subscription",actionWhenConfirmed:()=>s.subscriptions.cancel(c)})};case $e.Unpaid:return{button:Sl.Pay,action:async()=>M.operation({promise:s.billing.customerPortal(),setOp:l})};case $e.Cancelled:return{button:Sl.Renew,action:async()=>await a.confirmAction({title:"Renew subscription",message:`are you sure you want to renew your ${e.label} subscription for $${Ml(e.pricing[0].price)}/month?`,loadingMessage:"renewing subscription",actionWhenConfirmed:()=>s.subscriptions.uncancel(c)})};default:throw new Error("unknown subscription status")}}function Xl(e){return t=>pt`
		<li data-plan=${t.planId} data-plan>
			<h3 data-plan-label>${t.label}</h3>
			<div data-tiers>
				${t.tiers.filter((e=>e.active)).map((i=>function(e,t,i){const{slots:o,modals:n,storeModel:r,setOp:a}=e,{mySubscriptionDetails:s}=r.get.subscriptions,l=s.find((e=>e.planId===t.planId)),c={plan:t,tier:i,subscription:l,pricing:i.pricing&&i.pricing[0]},d=Bl(c),p=Fl({basics:c,context:d,modals:n,storeModel:r,setOp:a});return c.pricing?pt`
			<xiome-store-subscription-tier
				.basics=${c}
				.context=${d}
				.interactivity=${p}>
					${o.get(i.tierId)}
			</xiome-store-subscription-tier>
		`:null}(e,t,i)))}
			</div>
		</li>
	`}var Ql=$o`xiome-store-subscription-catalog {

:is(ol, ul) {
	list-style: none;
}

[data-plans] > li {
	margin-top: 1em;
}

[data-tiers] {
	display: flex;
	flex-direction: row;
	flex-wrap: wrap;
	gap: 0.5em;
	align-items: stretch;
	> span {
		display: block;
	}
	> * {
		max-width: 100%;
	}
}

[data-plan-label] {
	font-size: 1em;
	padding-bottom: 0.2em;
}

}`;const Jl=({modals:e,storeModel:t})=>Cl({styles:Ql,shadow:!1,properties:{plans:{type:String}}},(i=>{var o;t.initialize(),Wl(i,t.snap);const n=function(e){const[t]=e.state((()=>new Ll(e.element,(()=>e.element.requestUpdate()))));return t}(i),[r,a]=i.state(M.ready(void 0)),s=function(e){var t,i;return[...null!==(i=null===(t=null!=e?e:"")||void 0===t?void 0:t.match(/(\w+)/g))&&void 0!==i?i:[]]}(i.element.plans),l=(null!==(o=t.get.subscriptions.plans)&&void 0!==o?o:[]).filter(function(e){return t=>!(e.length>0)||e.includes(t.planId)}(s)).filter((e=>!e.archived)).filter((e=>e.tiers.length>0)).filter((e=>e.tiers.some((e=>e.active)))).filter((e=>e.tiers.some((e=>!!e.pricing))));return nn(M.combine(r,t.state.subscriptions.subscriptionPlansOp,t.state.subscriptions.mySubscriptionDetailsOp),(()=>pt`
			<ol data-plans>
				${l.map(Xl({modals:e,storeModel:t,slots:n,setOp:a}))}
			</ol>
		`))}));function Kl(e,t=document){return t.querySelector(e)}const Yl=rn((e=>"number"!=typeof e?["must be a number"]:[]),(Zl=.01,e=>e<Zl?["too small"]:[]));var Zl;const Gl=rn((e=>"string"!=typeof e?["must be a string"]:[]),dn(1),pn(32)),ec=rn((e=>"string"!=typeof e?["must be a string"]:[]),sn(cn("usd"))),tc=rn((e=>"string"!=typeof e?["must be a string"]:[]),sn(cn("month"),cn("year"))),ic=rn((e=>"boolean"!=typeof e?["must be a boolean"]:[])),oc=an({currency:ec,interval:tc,price:Yl}),nc=an({label:Gl,pricing:oc}),rc=an({planLabel:Gl,tier:nc}),ac=an({planId:kr,label:Gl,archived:ic}),sc=an({tierId:kr,label:Gl,active:ic,pricing:oc});function lc(e){return{currency:"usd",interval:"month",price:Il(e)}}function cc({storeModel:e,componentSnap:t,getShadowRoot:i}){const o={store:e.snap.readable,component:t.state},n={newPlan(){const e=i(),t={planlabel:Kl('.plandraft xio-text-input[data-field="planlabel"]',e),tierlabel:Kl('.plandraft xio-text-input[data-field="tierlabel"]',e),tierprice:Kl('.plandraft xio-price-input[data-field="tierprice"]',e)},n={planLabel:t.planlabel.value,tier:{label:t.tierlabel.value,pricing:lc(t.tierprice.value)}},r=rc(n);return o.component.draftNewPlan.problems=r,{draft:n,problems:r}},newTier(){const e=i(),t={label:Kl('.tierdraft xio-text-input[data-field="tierlabel"]',e),price:Kl('.tierdraft xio-price-input[data-field="tierprice"]',e)},n={label:t.label.value,pricing:lc(t.price.value)},r=nc(n);return o.component.draftNewTier.problems=r,{draft:n,problems:r}},editedPlan(e){const t=i(),n={label:Kl('.planediting [data-field="label"]',t),archived:Kl('.planediting [data-field="archived"]',t)},r={planId:e.planId,label:n.label.value,archived:n.archived.checked},a=ac(r),s=r.label!==e.label||r.archived!==e.archived;return o.component.editingPlanDraft.isChanged=s,o.component.editingPlanDraft.problems=a,{draft:r,problems:a,isChanged:s}},editedTier(e){const t=e.pricing?e.pricing[0]:{stripePriceId:"",currency:"usd",interval:"month",price:Il("")},n=i(),r={label:Kl('.tierediting [data-field="label"]',n),active:Kl('.tierediting [data-field="active"]',n),price:Kl('.tierediting [data-field="price"]',n)},a={tierId:e.tierId,label:r.label.value,active:r.active.checked,pricing:lc(r.price.value)},s=sc(a),l=a.label!==e.label||a.active!==e.active||function(e,t){for(const i of[t.price!==e.price,t.currency!==e.currency,t.interval!==e.interval])if(i)return!0;return!1}(t,a.pricing);return o.component.editingTierDraft.isChanged=l,o.component.editingTierDraft.problems=s,{draft:a,problems:s,isChanged:l}}},r={newPlan:{toggleDraftPanel(){o.component.draftNewPlan=o.component.draftNewPlan?void 0:{loading:!1,problems:["cannot be empty"]}},async submit(){const{draft:t,problems:i}=n.newPlan();if(0===i.length)try{o.component.draftNewPlan.loading=!0,await e.subscriptions.addPlan(t)}finally{o.component.draftNewPlan=void 0}}},newTier:{toggleDraftPanel(e){o.component.draftNewTier=o.component.draftNewTier?void 0:{planId:e,loading:!1,problems:[]}},async submit(t){const{draft:i,problems:r}=n.newTier();if(0===r.length)try{o.component.draftNewTier.loading=!0,await e.subscriptions.addTier({...i,planId:t})}finally{o.component.draftNewTier=void 0}}},planEditing:{handleEditButtonPress(e){var t;const i=(null===(t=o.component.editingPlanDraft)||void 0===t?void 0:t.planId)===e.planId;o.component.editingPlanDraft=i?void 0:{isChanged:!1,loading:!1,planId:e.planId,problems:[]}},async submit(t){const{draft:i,problems:r}=n.editedPlan(t);if(0===r.length)try{o.component.editingPlanDraft.loading=!0,await e.subscriptions.editPlan(i)}finally{o.component.editingPlanDraft=void 0}}},tierEditing:{handleEditButtonPress(e,t){var i;const n=(null===(i=o.component.editingTierDraft)||void 0===i?void 0:i.tierId)===t.tierId;o.component.editingTierDraft=n?void 0:{isChanged:!1,loading:!1,planId:e.planId,tierId:t.tierId,problems:[]}},async submit(t,i){const{draft:r,problems:a}=n.editedTier(i);if(0===a.length)try{o.component.editingTierDraft.loading=!0,await e.subscriptions.editTier({planId:t.planId,tierId:i.tierId,label:r.label,active:r.active,pricing:r.pricing})}finally{o.component.editingTierDraft=void 0}}}},a={valuechange:n.newPlan},s={valuechange:n.newTier};function l(e,t){var i,a;const s=(null===(i=o.component.editingTierDraft)||void 0===i?void 0:i.tierId)===t.tierId,l=null===(a=o.component.editingTierDraft)||void 0===a?void 0:a.loading,c=!!t.pricing,d=c?Ml(t.pricing[0].price):"";return pt`
			<li data-tier="${t.tierId}">
				<xio-button
					@press=${()=>r.tierEditing.handleEditButtonPress(e,t)}>
						edit tier
				</xio-button>
				<div class=tierdetails>
					${s?pt`
						<div
							class=tierediting
							@valuechange=${()=>n.editedTier(t)}
							@change=${()=>n.editedTier(t)}>
							<xio-text-input
								data-field="label"
								?disabled=${l}
								.text="${t.label}"
								.validator=${Gl}>
									tier label
							</xio-text-input>
							<xio-price-input
								data-field="price"
								.validator=${Yl}
								initial-value=${d}>
									Price</xio-price-input>
							<label>
								active:
								<input
									type=checkbox
									data-field="active"
									?disabled=${l}
									?checked=${t.active} />
							</label>
							${o.component.editingTierDraft.isChanged?pt`
									<xio-button
										?disabled=${l||!!o.component.editingTierDraft.problems.length}
										@press=${()=>r.tierEditing.submit(e,t)}>
										save tier
									</xio-button>
								`:null}
						</div>
					`:pt`
						<p class=label>tier label: ${t.label}</p>
						${c?pt`<p>price: $${Ml(t.pricing[0].price)}</p>`:pt`<p style="color: red">price not set</p>`}
						<p>active: ${t.active?"true":"false"}</p>
					`}
				</div>
				<p>tier id: <xio-id id="${t.tierId}"></xio-id></p>
				<p>role id: <xio-id id="${t.roleId}"></xio-id></p>
				<p>created: ${en(t.time).full}</p>
			</li>
		`}function c(e,t){var i,a,c;const d=(null===(i=o.component.editingPlanDraft)||void 0===i?void 0:i.planId)===e.planId,p=null===(a=o.component.editingPlanDraft)||void 0===a?void 0:a.loading,u=[],h=[];for(const t of e.tiers)t.active?u.push(t):h.push(t);return pt`
			<li data-plan="${e.planId}">
				<xio-button
					class=editplan
					@press=${()=>r.planEditing.handleEditButtonPress(e)}>
						edit plan
				</xio-button>
				<div class=plandetails>
					${d?pt`
						<div class=planediting
							@change=${()=>n.editedPlan(e)}
							@valuechange=${()=>n.editedPlan(e)}>
								<xio-text-input
									data-field="label"
									?disabled=${p}
									.text="${e.label}"
									.validator=${Gl}>
										plan label
								</xio-text-input>
								<label>
									archived:
									<input
										type=checkbox
										data-field="archived"
										?disabled=${p}
										?checked=${e.archived} />
								</label>
								${o.component.editingPlanDraft.isChanged?pt`
										<xio-button
											?disabled=${p||!!o.component.editingPlanDraft.problems.length}
											@press=${()=>r.planEditing.submit(e)}>
												save plan
										</xio-button>
									`:null}
						</div>
					`:pt`
						<p class=label>plan label: ${e.label}</p>
						<p>archived: ${e.archived?"true":"false"}</p>
					`}
				</div>
				<p>plan id: <xio-id id="${e.planId}"></xio-id></p>
				<p>created: ${en(e.time).full}</p>
				<h3 class=tiersheading>tiers</h3>
				<xio-button class=addtier @click=${()=>r.newTier.toggleDraftPanel(e.planId)}>
					+ add tier
				</xio-button>
				${(null===(c=o.component.draftNewTier)||void 0===c?void 0:c.planId)===e.planId?function(e){const{loading:t,problems:i}=o.component.draftNewTier;return pt`
			<div class=tierdraft @valuechange=${s.valuechange}>
				<xio-text-input
					data-field=tierlabel
					?disabled=${t}
					.validator=${Gl}>
						tier label</xio-text-input>
				<xio-price-input
					data-field=tierprice
					.validator=${Yl}>
						tier price</xio-price-input>
				<xio-button
					?disabled=${t||i.length}
					@click=${()=>r.newTier.submit(e)}>
						submit new tier</xio-button>
			</div>
		`}(e.planId):null}
				<ol>
					${u.map((t=>l(e,t)))}
				</ol>
				${h.length?pt`
						<details>
							<summary>inactive tiers</summary>
							<ol>
								${h.map((t=>l(e,t)))}
							</ol>
						</details>
					`:null}
			</li>
		`}return{renderPlanning:function(){const{subscriptionPlansOp:e}=o.store.subscriptions;return nn(e,(e=>{const t=[],i=[];for(const o of e)o.archived?i.push(o):t.push(o);return pt`
				<xio-button class=addplan @click=${r.newPlan.toggleDraftPanel}>
					+ add plan
				</xio-button>
				${o.component.draftNewPlan?function(){const{loading:e,problems:t}=o.component.draftNewPlan;return pt`
			<div class=plandraft @valuechange=${a.valuechange}>
				<xio-text-input
					data-field=planlabel
					?disabled=${e}
					.validator=${Gl}>
						plan label</xio-text-input>
				<xio-text-input
					data-field=tierlabel
					?disabled=${e}
					.validator=${Gl}>
						tier label</xio-text-input>
				<xio-price-input
					data-field=tierprice
					.validator=${Yl}>
						tier price</xio-price-input>
				<xio-button
					?disabled=${e||t.length}
					@click=${r.newPlan.submit}>
						Submit new plan</xio-button>
			</div>
		`}():null}
				<ol>
					${t.map(c)}
				</ol>
				${i.length?pt`
						<details>
							<summary>archived plans</summary>
							<ol>
								${i.map(c)}
							</ol>
						</details>
					`:null}
			`}))}}}var dc,pc,uc,hc,fc=$o`

ul, ol {
	list-style: none;
}

.plandraft {
	> * {
		display: block;
		margin-top: 0.5em;
	}
}

[data-plan] {
	border: 1px solid;
	padding: 1em;
	margin-top: 1em;

	.editplan {
		margin-bottom: 1em;
	}

	.plandetails {
		margin-bottom: 1em;
	}

	.planediting > * + * {
		display: block;
		margin-top: 0.5em;
	}

	details {
		border: 1px dashed;
		padding: 0.5em;
		margin-top: 0.5em;
	}
	
	summary {
		font-size: 1.2em;
	}
	
	.tiersheading {
		margin-top: 1em;
	}
	
	.addtier {
		margin-top: 1em;
	}
	
	.tierdraft > * {
		display: block;
		margin-top: 0.5em;
	}
}

[data-tier] {
	border: 1px solid;
	padding: 1em;
	margin-top: 1em;

	.tierdetails {
		margin: 1em 0;
	}

	.tierediting > * {
		display: block;
		margin-top: 0.5em;
	}
}

[data-field="label"], .label {
	font-weight: bold;
}

`,mc=function(e,t,i,o){var n,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},bc=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let vc=class extends(Xt()(ei)){constructor(){super(...arguments),dc.add(this),pc.set(this,W({draftNewPlan:void 0,draftNewTier:void 0,editingPlanDraft:void 0,editingTierDraft:void 0})),hc.set(this,cc({storeModel:bc(this,dc,"a",uc),componentSnap:bc(this,pc,"f"),getShadowRoot:()=>this.shadowRoot}))}async init(){this.addSubscription((()=>bc(this,pc,"f").subscribe((()=>this.requestUpdate())))),await bc(this,dc,"a",uc).initialize()}render(){const{snap:e,allowance:t}=bc(this,dc,"a",uc),i=e.readable,o=M.value(i.stripeConnect.connectStatusOp);return pt`
			${o===xe.Ready?t.manageStore?bc(this,hc,"f").renderPlanning():pt`<p>your account does not have permissions to manage the store</p>`:pt`<p>store is not active</p>`}
		`}};function gc({models:e,modals:t}){const{storeModel:i}=e;return{XiomeStoreConnect:Ht(i.snap.subscribe)(Ft({modals:t,storeModel:i})(rl)),XiomeStoreSubscriptionPlanning:Ht(i.snap.subscribe)(Ft({modals:t,storeModel:i})(vc)),XiomeStoreSubscriptionTier:El,XiomeStoreSubscriptionCatalog:Jl({modals:t,storeModel:i}),XiomeStoreCustomerPortal:Ht(i.snap.subscribe)(Ft({storeModel:i})($l)),XiomeStoreSubscriptionStatus:Hl({storeModel:i}),XiomeStoreBillingArea:Ht(i.snap.subscribe)(Ft({storeModel:i})(ul))}}function wc(e){return async({title:t,input:i,body:o=null,yes:n={label:"okay",vibe:"positive"},no:r={label:"nevermind",vibe:"neutral"},focusNthElement:a=1,blanketClickMeansCancel:s=!0})=>new Promise((l=>{var c;const d=document.createElement("xio-text-input");function p(){return d.value,0!==d.problems.length}function u(e){return{yes:()=>{const t=p()?void 0:{value:d.value};p()||(e.close(),l(t))},no:()=>{e.close(),l(void 0)}}}d.textarea=null!==(c=i.textarea)&&void 0!==c&&c,d.parser=i.parser,d.validator=i.validator,d.textContent=i.label;const{controls:h,modal:f}=e({focusNthElement:a,onBlanketClick:s?e=>{e.close(),l(void 0)}:()=>{},renderContent:e=>{const i=u(e);return pt`
					<div data-confirm>
						${"string"==typeof t?pt`<h2>${t}</h2>`:t}
						${"string"==typeof o?pt`<p>${o}</p>`:o}
						${d}
						<div data-buttons>
							<xio-button
								data-button=yes
								data-vibe=${n.vibe}
								?disabled=${p()}
								@press=${i.yes}>
									${n.label}
							</xio-button>
							<xio-button
								data-button=no
								data-vibe=${r.vibe}
								@press=${i.no}>
									${r.label}
							</xio-button>
						</div>
					</div>
				`}}),m=u(h);d.onvaluechange=()=>h.rerender(),d.onenterpress=()=>m.yes(),f.addEventListener("keyup",(({key:e})=>{"Escape"===e&&m.no()}))}))}pc=new WeakMap,hc=new WeakMap,dc=new WeakSet,uc=function(){return this.share.storeModel},vc=mc([zt(fc)],vc);var yc=je`

*:focus {
	outline: var(--focus-outline);
}

[data-modal-system] {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	display: block;
}

[data-modal-system] [data-blanket] {
	z-index: 101;
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	display: block;
	background: #0008;
	backdrop-filter: blur(10px);
}

[data-modal-system] [data-plate] {
	z-index: 102;
	position: absolute;
	top: 0;
	left: 0;
	right: 0;

	width: 96%;
	max-width: 32em;
	min-height: 1em;
	margin: 2em auto;

	background: linear-gradient(to bottom right, #fff, #ccc);
	color: #444;
}

[data-modal-system] [data-plate] h2 {
	padding: 0 1rem;
	margin: 1rem auto;
}

[data-modal-system] [data-content]:focus {
	outline: unset;
}

[data-modal-system] [data-confirm] {
	padding: 0 1rem;
	margin: 1rem auto;
}

[data-modal-system] [data-buttons] {
	margin-top: 1rem;
	text-align: right;
}

[data-modal-system] [data-button] {
	--xio-button-hover-color: white;
	--xio-button-hover-background: #666;
}

[data-modal-system] [data-vibe=positive] {
	color: green;
	--xio-button-hover-color: white;
	--xio-button-hover-background: green;
}

[data-modal-system] [data-vibe=negative] {
	color: #a00;
	--xio-button-hover-color: white;
	--xio-button-hover-background: #a00;
}

`;function xc(e){return async({title:t,body:i=null,button:o={label:"ok",vibe:"neutral"},focusNthElement:n=1,blanketClickMeansNo:r=!0})=>{await e({title:t,body:i,blanketClickMeansNo:r,yes:o,no:null})}}function $c(){let e=0;const t=new Map,{rerender:i,element:o}=function(e){const t=document.createElement("style");It(yc,t);const i=document.createElement("div");return i.setAttribute("data-modal-system",""),{element:i,rerender:function(){It(pt`
			${t}
			${e().map((e=>e.render()))}
		`,i)}}}((()=>Array.from(t.values())));function n({focusNthElement:n,renderContent:r,onBlanketClick:a}){var s,l,c;const d=e++,p={rerender:i,close:()=>{t.delete(d),i()}},u=null!==(c=null!==(l=null!==(s=window.pageYOffset)&&void 0!==s?s:document.documentElement.scrollTop)&&void 0!==l?l:document.body.scrollTop)&&void 0!==c?c:0,h=()=>a(p);t.set(d,{render:()=>pt`
					<div data-modal="${d}">
						<div data-blanket @click=${h}></div>
						<div data-plate style="top: ${u}px">
							${r(p)}
						</div>
					</div>
				`}),i();const f=o.querySelector(`[data-modal="${d}"]`);return function(e,t){const i='\n\t\t[focusable]:not([disabled])\n\t\t[tabindex]:not([disabled])\n\t\ta[href]:not([disabled])\n\t\tbutton:not([disabled])\n\t\ttextarea:not([disabled])\n\t\tinput[type="text"]:not([disabled])\n\t\tinput[type="radio"]:not([disabled])\n\t\tinput[type="checkbox"]:not([disabled])\n\t\tselect:not([disabled])\n\t'.split("\n").map((e=>e.trim())).filter((e=>e.length)).join(", "),o=Array.from(e.querySelectorAll(i));if(0===o.length)throw new Error("cannot trap focus: no focusable element");const n=o[0],r=o[o.length-1],a=o[t-1];setTimeout((()=>a.focus()),0),e.onkeydown=e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===n&&(r.focus(),e.preventDefault()):document.activeElement===r&&(n.focus(),e.preventDefault()))}}(f,n),{controls:p,modal:f}}const r=function(e){return async({title:t,body:i=null,yes:o={label:"yes",vibe:"positive"},no:n={label:"no",vibe:"neutral"},focusNthElement:r=1,blanketClickMeansNo:a=!0})=>new Promise((s=>{e({focusNthElement:r,onBlanketClick:a?e=>{e.close(),s(!1)}:()=>{},renderContent:e=>pt`
					<div data-confirm>
						${"string"==typeof t?pt`<h2>${t}</h2>`:t}
						${"string"==typeof i?pt`<p>${i}</p>`:i}
						<div data-buttons>
							<xio-button
								focusable
								data-button=yes
								data-vibe="${o.vibe}"
								@press=${()=>{e.close(),s(!0)}}>
									${o.label}
							</xio-button>
							${n?pt`
								<xio-button
									focusable
									data-button=no
									data-vibe="${n.vibe}"
									@press=${()=>{e.close(),s(!1)}}>
										${n.label}
								</xio-button>
							`:null}
						</div>
					</div>
				`})}))}(n),a=function(e){return async({title:t,message:i,loadingMessage:o,cancelButtonLabel:n="no",confirmButtonLabel:r="yes",actionWhenConfirmed:a})=>{let s=M.ready(void 0);function l(e){s=e,c.controls.rerender()}const c=e({focusNthElement:1,renderContent:e=>{const c=M.isError(s);return pt`
					<h2>${t}</h2>
					${nn(s,(()=>pt`
							<div data-confirm>
								${i}
								<div data-buttons>
									<xio-button
										focusable
										data-button=yes
										data-vibe="positive"
										@press=${async()=>{await M.operation({promise:a(),setOp:l}),e.close()}}>
											${r}
									</xio-button>
									<xio-button
										focusable
										data-button=no
										data-vibe="neutral"
										@press=${e.close}>
											${n}
									</xio-button>
								</div>
							</div>
						`),null,{loadingMessage:o})}
					${c?pt`
						<div data-buttons>
							<xio-button
								focusable
								data-button=no
								data-vibe="neutral"
								@press=${e.close}>
									ok
							</xio-button>
						</div>
						`:null}
				`},onBlanketClick:e=>{M.isLoading(s)||e.close()}})}}(n);return{modalsElement:o,modals:{popup:n,confirm:r,confirmAction:a,alert:xc(r),prompt:wc(n)}}}async function kc({link:e,accessModel:t,onDone:i,onError:o}){const{hash:n}=new URL(e),{login:r}=function(e=location.search){const t={},i=(e=(e=e.startsWith("?")?e.slice(1):e).startsWith("#")?e.slice(1):e).split("&");for(const e of i){const[i,...o]=e.split("="),n=o.join("=");t[decodeURIComponent(i)]=decodeURIComponent(n)}return t}(n);if(r){try{await t.login(r)}catch(e){o(e)}i()}else try{await t.useExistingLogin()}catch(e){console.error("error with xiome login:",e)}}async function Oc({appId:e,storage:t,authMediator:i,remote:o,stripePopups:n,chatConnect:r}){const{modals:a,modalsElement:s}=$c(),l=await Ce({appId:e,remote:o,storage:t,authMediator:i,stripePopups:n,chatConnect:r}),c=Lt(ti,{XioId:ri,XioOp:di,XioMenu:Ri,XioAvatar:Ui,XioButton:Bi,XioExample:Hi,XioCheckbox:Ki,XioMenuItem:wi,XioTextInput:oo,XioPriceInput:Do,XioNightlight:Jo,XioProfileCard:gn,XioPriceDisplay:Pn,...hs(d={models:l,modals:a}),...mr(d),...Vs(d),...tl(d),...cs(d),...Xr(d),...ga(d),...gc(d)});var d;return await kc({accessModel:l.accessModel,link:window.location.toString(),onError:e=>{e instanceof we?a.alert({title:"expired login link",body:"this login link has expired, please try again"}):a.alert({title:"invalid login link",body:"something is wrong with this login link, please try again"})},onDone:()=>{window.location.hash=""}}),{appId:e,components:c,models:l,modals:a,modalsElement:s}}function Sc(){const{attr:e}=function(e){const t=document.querySelector(e);if(!t)throw new Error(`${e} is required`);return{attr(e){var i;return null!==(i=t.getAttribute(e))&&void 0!==i?i:void 0}}}("xiome-config");return{appId:e("app"),apiServer:e("api-server"),chatServer:e("chat-server"),platformOrigin:e("platform")}}!async function(e=Sc()){const t=await async function(e){const t=await A(e),i=await Oc(t);return{...t,...i}}(e);document.body.prepend(t.modalsElement),function(e){for(const[t,i]of Object.entries(e))customElements.define(t.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase(),i)}(t.components),window.xiome=t}()}();