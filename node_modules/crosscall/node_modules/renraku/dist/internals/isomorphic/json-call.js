import { err } from "../../errors.js";
export async function jsonCall({ url, data, fetch, headers, }) {
    const response = await fetch(url, {
        body: JSON.stringify(data),
        method: "POST",
        headers: {
            "Accept": "application/json",
            "Content-Type": "application/json",
            ...headers,
        },
    });
    if (response.ok) {
        let text;
        try {
            text = await response.text();
        }
        catch (error) {
            text = undefined;
        }
        const json = text
            ? JSON.parse(text)
            : undefined;
        return json;
    }
    else {
        throw err(response.status, `fetch response not ok`);
    }
}
//# sourceMappingURL=json-call.js.map