import { signatureVerify } from "redcrypto/dist/signature-verify.js";
import { err } from "../../errors.js";
export async function verifyWhitelist({ id, body, whitelist, signature }) {
    if (!id)
        throw err(401, `request is missing 'id' header`);
    const publicKey = whitelist[id];
    if (!publicKey)
        throw err(401, `no public certificate for "${id}"`);
    return signatureVerify({ body, signature, publicKey });
}
//# sourceMappingURL=verify-whitelist.js.map